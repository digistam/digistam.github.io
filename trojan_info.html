<html>
    <meta name=”robots” content=”noindex,nofollow”/>
  <a href=index.html>Back to home</a>
<hr/>
source: CEH v. 12

<h1>Trojans</h1>

<p>Computer Trojans are closely related to <a href=APT.html>APT</a>. A Trojan refers to the Trojan War in ancient Greek mythology. A computer Trojan is a program in which malicious or harmful code is contained inside an apparently harmless program or data, which can later gain control 
  and cause damage, such as ruining the FAT. Computer trojans are used to trick a victim into performing a predefined action.</p>
  <p>A Trojan is wrapped within or attached to a legitimate program. Victims are used as unwitting intermediaries to attack others. A victim's computer can be used to commit illegal DoS attacks.</p>
  <p>Trojans work at the same level of privileges as the victims and can attempt to exploit vulnerabilities to increase the level of access. If succesful, the Trojan can use such increased privileges to install other malicious 
  code on the victim's machine.</p>
  <p>A Trojan, depending on the actions it performs, may falsely implicate a remote system as the source of an attack by spoofing, thereby causing the remote system to incur a liability. Trojans enter the system by email attachments, 
  downloads and instant messages.</p>
  <h2>Common Ports used by Trojans</h2>
  <p>Trojans use client and server. Various Trojans use specific ports to infect target systems. Among the various states, the "listening" state is the important one in this context. The system generates this state when it listens for a port number while waiting 
  to connect to another system. Whenever a system reboots, Trojens move to the listening state; some use more than one port: one for "listening" and the other(s) for data transfer.</p>
  <h1>Types of Trojans</h1>
  <p><ol>
    <ul>Remote Access Trojans (RAT)</ul>
    <ul>Backdoor Trojans</ul>
    <ul>Botnet Trojans</ul>
    <ul>Rootkit Trojans</ul>
    <ul>E-Banking Trojans</ul>
    <ul>Point-of-Sale Trojans</ul>
    <ul>Defacement Trojans</ul>
    <ul>Service Protocol Trojans</ul>
    <ul>Mobile Trojans</ul>
    <ul>IoT Trojans</ul>
    <ul>Security Software Disable Trojans</ul>
    <ul>Destructive Trojans</ul>
    <ul>DDoS Attack Trojans</ul>
    <ul>Command Shell Trojans</ul>
  </ol></p>
<h2>Remote Access Trojans (RAT)</h2>
<p>RATs provide attackers with full control over the victim's system, thereby enabling them to remotely access files, private conversations, accounting data etc. The RAT acts as a server and listens on a port that is not supposed 
to be available to Internet attackers. If the user is behind a firewall, it is less likely that a remote attacker will connect to the Trojans. Attackers in the same network located behind the firewall can easily access Trojans.
 RATs are used to infect the target machine to gain administrative access. RATs help to access and control the computer. Infection by phishing attacks and drive-by downloads, via infected USB keys or networked drives. RATs can
download and execute additional malware, execute shell commands, read and write registry keys, capture screenshots, log keystrokes, spy on webcams.</p>
<p>Example: <a target=_blank href=https://github.com/simalei/njRAT>njRAT</a> (<a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.njrat>more</a> >>) is a RAT with powerful data-stealing capabilities. It can be used to control botnets. It can:
<ol>
  <ul>Remotely access the victim's computer</ul>
  <ul>Collect victim's information such as IP, hostname and OS</ul>
  <ul>Manipulate files and system files</ul>
  <ul>Open active remote session providing the attacker access to the command line of the victim's machine</ul>
  <ul>Log keystrokes and steal credentials from browsers</ul>
</ol></p>
  <p>Other RATs:
  <ol>
    <ul><a target=_blank href=https://suleyman-celik8.medium.com/what-is-prorat-b32b2e387d76>ProRat</a></ul>
    <ul><a target=_blank href=https://github.com/Samsar4/Ethical-Hacking-Labs/blob/master/6-Malware/5-Windows-Tools.md>Theef</a></ul>
    <ul><a target=_blank href=https://blog.morphisec.com/new-jssloader-trojan-delivered-through-xll-files>JSSLoader</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.crimson>CrimsonRAT</a></ul>
    <ul><a target=_blank href=https://www.zscaler.com/blogs/security-research/return-minebridge-rat-new-ttps-and-social-engineering-lures>MINEBRIDGE</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/jar.strrat>StrRAT</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.fatal_rat#:~:text=FatalRat%20Propose%20Change&text=According%20to%20PCrisk%2C%20FatalRAT%20is,use%20it%20for%20various%20purposes.>FatalRAT</a></ul>
    <ul><a target=_blank href=https://www.pcrisk.nl/verwijderingsrichtlijnen/11352-teabot-malware-android>TeaBot</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.flawedammyy>FlawedAmmyy</a></ul>
    <ul><a target=_blank href=https://blog.lumen.com/ismdoor-malware-continues-to-make-use-of-dns-tunneling/>Ismdoor</a></ul>
    <ul><a target=_blank href=https://news.sophos.com/en-us/2017/09/12/beware-the-kedi-rat-pretending-to-be-a-citrix-file-that-gmails-home/>Kedi RAT</a></ul>
    <ul><a target=_blank href=https://unit42.paloaltonetworks.com/babyshark-malware-part-two-attacks-continue-using-kimjongrat-and-pcrat/>PCRat / Gh0st RAT</a> (<a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.ghost_rat>more information</a>)</ul>
  </ol></p>
<h2>Backdoor Trojans</h2>
<p>A backdoor is a program that can bypass the standard system authentication or conventional system mechanisms like IDS and firewalls, without being detected. In these types of breaches, hackers leverage backdoor programs to access the victim's computer or network.
The difference with other types of malware is that the installation of the backdoor is performed without the user's knowledge.</p>
    <p>Backdoor Trojans are often used to group victim computers to form a botnet or zombie network that can be used to perform criminal activities. Often,
     Backdoor Trojans are initially used in the second (point of entry) or third (command and control C&C) stage of the targeted attack process. </p>
    <p>The Backdoor Trojan has a user interface, client component, which can be used by the attacker to issue command to the server component residing in the compromised machine.
     A traditional backdoor does NOT have a GUI!</p>
    <h2>Example: <a target=_blank href=https://www.f-secure.com/v-descs/backdoor-w32-poisonivy.shtml>PoisonIvy</a></h2>
    <p>PoisonIvy gives the attacker almost complete control over the infected computer. The PoisonIvy remote administration tool is
     created and controlled by a <a target=_blank href=https://www.securityweek.com/poison-ivy-kit-enables-easy-malware-customization-attackers/>PoisonIvy management program or kit</a>. The PoisonIvy kit consists 
    of a graphical user interface and the backdoors are small (< 10kb). Once the backdoor is executed, it copies itself to either the
     Windows folder or the Windows\system32 folder. The filename and locations of the backdoor are defined by the creator of the backdoor 
    when using the PoisonIvy kit to create the server program. Some variants of PoisonIvy can copy themselves into an alternative 
    data stream. </p>
    <p>Everytime the computer is booted up, the backdoor is started because of a <b>registry entry</b>. The server automatically connects 
    to a client using an address defined when the server part was created. The communication between the server and client programs is 
    <b>encrypted</b> and <b>compressed</b>. PoisonIvy can be configured to inject itself into a <b>browser process</b> before making an 
    outgoing connection to bypass firewalls.</p>
    <p><ol>
        <ul>File modification, deletion and transfer to and from the infected system</ul>
        <ul>Windows registry can be viewed and edited</ul>
        <ul>Currently running processes can be viewed, suspended and killed</ul>
        <ul>Current network connections can be viewed and shut down</ul>
        <ul>Services can be viewed and controlled (stopped/started)</ul>
        <ul>Installed devices can be viewed, entries can be deleted or programs can be uninstalled</ul>
        <ul>The list of installed applications can be viewed, entries can be deleted or programs can be uninstalled</ul>
        <ul>Accesses Windows command shell on the infected computer</ul>
        <ul>Steals information by taking screenshots of the desktop and recording audio / webcam</ul>
        <ul>Accesses saved passwords and password hashes</ul>
    </ol></p>
<p>Other Backdoor Trojans:
  <ol>
    <ul><a target=_blank href=https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/kovter-an-evolving-malware-gone-fileless>Kovter</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/ps1.powerstats>POWERSTATS v3</a></ul>
    <ul><a target=_blank href=https://news.sophos.com/en-us/2019/04/25/extrapulsar-backdoor-based-on-leaked-nsa-code-what-you-need-to-know/>ExtraPulsar</a></ul>
    <ul><a target=_blank href=https://guillaumeorlando.github.io/RogueRobin-malware-analysis-eng>RogueRobin</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.servhelper>ServHelper</a></ul>
    <ul><a target=_blank href=https://research.checkpoint.com/2019/speakup-a-new-undetected-backdoor-linux-trojan/>SpeakUp linux backdoor</a></ul>
    <ul><a target=_blank href=https://interaktiv.br.de/winnti/english/>Winnti backdoor</a></ul>
    <ul><a target=_blank href=https://symantec-enterprise-blogs.security.com/threat-intelligence/daxin-backdoor-espionage>Daxin</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.sysjoker>SysJoker</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.portdoor>PortDoor</a></ul>
    <ul><a target=_blank href=https://www.enigmasoftware.com/nl/tomirisbackdoortrojan-verwijdering/>Tomiris</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.goldenspy>GoldenSpy</a> (<a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.ghost_rat>more information</a>)</ul>
  </ol></p>
<h2>Botnet Trojans</h2>
    <p>Most major information security attacks these days involve botnets. Bot herders use botnet Trojans to infect a large number
     of computers throughout a large geographical area to create a network of bots (bot herd) that can achieve control via a command-and-control (C&C) center.
     They trick regular computer users into downloading Trojan-infected files through phishing, <a target=_blank href=https://seo.co/seo-hacks/>SEO hacking</a>, <a target=_blank href=https://en.wikipedia.org/wiki/URL_redirection>URL redirection</a> etc.</p>
    <p>Once the user downloads and executes the botnet Trojan in the system, it connects back to the attacker using <a target=_blank href=https://en.wikipedia.org/wiki/IRC>IRC channels</a> and waits for further instructions. 
    Some botnet trojans also have worm features and automatically spread to other systems in the network. </p>
<p><h2>Example: Necurs</h2></p>
    <p>The Necurs botnet is a distributor of many pieces of malware, most notably Dridex and Locky. It delivers banking trojans and ransomwear threats in batches of millions of emails at a time, and it keeps reinventing itself.
     Necurs is distributed by spam e-mails and downloadable content from questionable / illegal sites. It is indirectly responsible for a significant 
    portion of cybercrime.</p>
    <p><ol>
    <ul>destruction of the system</ul>
        <ul>turning pc in spying tool</ul>
        <ul>electronic money theft</ul>
        <ul>botnet and mining</ul>
        <ul>serving as a gateway for other viruses</ul>
</ol></p>
    <p>Other Botnet Trojans:
  <ol>
    <ul><a target=_blank href=https://bitcoinist.com/electrum-botnet-steals-4-6-million-bitcoin-cryptocurrencies/>Electrum</a></ul>
    <ul><a target=_blank href=https://krebsonsecurity.com/2019/09/satori-iot-botnet-operator-pleads-guilty/>Satori</a></ul>
    <ul><a target=_blank href=https://securityaffairs.com/76659/malware/torii-iot-botnet.html>Torii botnet</a></ul>
    <ul><a target=_blank href=https://www.om.nl/actueel/nieuws/2023/08/29/grootste-wereldwijde-botnet-qakbot-onschadelijk-gemaakt>Qakbot</a></ul>
    <ul><a target=_blank href=https://www.trendmicro.com/vinfo/us/security/news/internet-of-things/-hide-n-seek-botnet-uses-peer-to-peer-infrastructure-to-compromise-iot-devices>Hide n Seek</a></ul>
    <ul><a target=_blank href=https://www.bsi.bund.de/EN/Themen/Verbraucherinnen-und-Verbraucher/Cyber-Sicherheitslage/Methoden-der-Cyber-Kriminalitaet/Botnetze/Steckbriefe-aktueller-Botnetze/Steckbriefe/Ramnit/Ramnit.html>Ramnit</a></ul>
    <ul><a target=_blank href=https://www.bsi.bund.de/EN/Themen/Verbraucherinnen-und-Verbraucher/Cyber-Sicherheitslage/Methoden-der-Cyber-Kriminalitaet/Botnetze/Botnetz-Avalanche/Malware/Pandabanker/Pandabanker.html>Panda</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.betabot>BetaBot</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/elf.fritzfrog>FritzFrog</a></ul>
    <ul><a target=_blank href=https://blog.netlab.360.com/b1txor20-use-of-dns-tunneling_en/>B1txor20 botnet</a></ul>
    <ul><a target=_blank href=https://thehackernews.com/2024/02/dirtymoe-malware-infects-2000-ukrainian.html>DirtyMoe</a></ul>
    <ul><a target=_blank href=https://blog.cloudflare.com/meris-botnet>Meris Botnet</a> (<a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.ghost_rat>more information</a>)</ul>
    <ul><a target=_blank href=https://nordvpn.com/blog/cyclops-blink/>Cyclops Blink</a></ul>
  </ol></p>
<h2>Rootkit Trojans</h2>
<p>Rootkit consists of two terms: root and kit. Root is a Linux / Unix term like administrator in Windows. The word kit denotes programs 
that allow someone to obtain root-/admin-level access to the computer by executing the programs in the kit. Rootkits can't be detected 
by services and provide full control of the victim OS. Rootkits are one component of a blended threat: dropper, loader and rootkit. 
Activating the dropper program usually entails human intervention, such as clicking on a malicious e-mail link. Once initiated, the dropper 
launches the loader and then deletes itself. Once active, the loader typically causes a buffer overflow which loads the rootkit into memory.</p>
<h2>Example: EquationDrug Rootkit</h2>
<p>EquationDrug is a dangerous computer rootkit that attacks Windows. It performs targeted attacks against various organizations and 
lands on the infected system by being downloaded and executed by the Trickler dubbed "DoubleFantasy" (Trojan.Win32.Micstus.A). It allows 
a remote attacker to execute shell commands on the infected system.</p>
    <p>Other rootkit Trojans:
  <ol>
    <ul><a target=_blank href=https://research.checkpoint.com/2018/ceidpagelock-a-chinese-rootkit/>CEIDPageLock</a></ul>
    <ul><a target=_blank href=https://attack.mitre.org/software/S0176/>Wingbird</a></ul>
    <ul><a target=_blank href=https://artemonsecurity.blogspot.com/2017/05/grayfish-rootkit-analysis.html>GrayFish</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.finfisher>FinFisher</a></ul>
    <ul><a target=_blank href=https://digital.nhs.uk/cyber-alerts/2017/cc-1513>ZeroAccess</a></ul>
    <ul><a target=_blank href=https://www.f-secure.com/v-descs/rootkit-w32-whistler-a.shtml>Whistler</a></ul>
    <ul><a target=_blank href=https://www.bleepingcomputer.com/news/security/chinese-hacking-group-uses-new-fire-chili-windows-rootkit/>Fire Chili rootkit</a></ul>
    <ul><a target=_blank href=https://www.akamai.com/blog/security/purple-fox-rootkit-now-propagates-as-a-worm>Purple Fox Rootkit</a></ul>
    <ul><a target=_blank href=https://heimdalsecurity.com/blog/ghostemperor-campaign-targets-asian-countries-abusing-microsoft-vulnerabilities/>Dubbed Demodex Rootkit</a></ul>
    <ul><a target=_blank href=https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/>Moonbounce</a></ul>
    <ul><a target=_blank href=https://www.bleepingcomputer.com/news/security/new-moriya-rootkit-used-in-the-wild-to-backdoor-windows-systems/>Moriya</a></ul>
    <ul><a target=_blank href=https://securityaffairs.com/126157/malware/ilobleed-wiper-hp-servers.html>iLOBleed</a>)</ul>
  </ol></p>
<h2>E-banking Trojans</h2>
<p>Extremely dangerous and emerged as significant threat to online banking. They intercept the victim's account information before the system can encrypt it and send it to the attacker's command and control center.
 Installation of these Trojans take place on the victim's computer when a malicious email attachment or a malicious advertisement is clicked.</p>
 <p>Attackers program these Trojans to steal minimum and maximum monetary amounts, so that they don't withdraw all the money in the account, avoiding suspicion. These Trojans also create screenshots of the bank account 
 statement, so that the victim thinks that there is no variation in the bank balance and is not aware of the fraud unless the balance is checked from another system or ATM. These Trojans may also steal credit card numbers 
 and billing details.</p>
 <p>Working: <ol>
     <ul><b>TAN Grabber</b> (<i>Transaction Authentication Number</i>) -> single use password for authenticating online banking accounts. Banking Trojans intercept valid TANs entered by users and replace them with random numbers. The 
     bank will reject such invalid random numbers. Subsequently, the attacker misuses the intercepted TAN with the target's login details</ul>
     <ul><b>HTML injections</b> -> the Trojan creates fake form fields on e-banking pages, enabling the attacker to collect the target's account details, credit card number, date of birth etc. The attacker can use this information 
     to impersonate the target and compromise the account</ul>
     <ul><b>Form Grabber</b> -> type of malware that captures a target's sensitive data such as IDs and passwords, from a web browser form or pages. It analyses POST requests and responses to the victim's browser</ul>
 </ol></p>
    <p>A <b>covert credential grabber</b> remains dormant until the user performs an online financial transaction. It works covertly to replicate itself on the computer and edits the registry entries each time the 
    computer is started. The Trojan also searches the cookie files that had been stored on the computer while browsing financial websites. Once the user attempts to make an online transaction, the Trojan covertly steals 
    the login credentials and transmits them to the hacker.</p>
     <p>Some methods: <ol>
         <ul>Keylogging</ul>
         <ul>Form data capture</ul>
         <ul>Insertign fraudulent form fields</ul>
         <ul>Screen captures and video recording</ul>
         <ul>Mimicking financial websites</ul>
         <ul>Redirecting to banking websites</ul>
         <ul>Man-in-the-middle attack</ul>
 </ol></p>
    <h2>Example: Dreambot</h2>
    <p>Dreambot banking Trojans are updated versions of Ursnif or Gozi. Can be delivered through the Emotet dropper or RIG exploit kit. This Trojan can also be embedded as a macro in an MS word document and sent to victims 
    via spam emails. If this Trojan gets into the victim's machine, it will covertly creates registry keys and processes and attempt to connect to multiple malicious C2C servers. After connecting to the C2C server, 
    it will perform keylogging and send the keylog data to the attacker. This keylog data can include passwords of banking websites, OTP messages, secure transaction passwords, pins etc.</p>
    <p>Other e-banking Trojans:
  <ol>
    <ul><a target=_blank href=https://www.kaspersky.nl/resource-center/threats/emotet>Emotet</a></ul>
    <ul><a target=_blank href=https://en.wikipedia.org/wiki/ZeuS_Panda>Panda Banker</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.ramnit>Ramnit</a></ul>
    <ul><a target=_blank href=https://en.wikipedia.org/wiki/ZeuS_Panda>ZeuS</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.dridex>Dridex</a></ul>
    <ul><a target=_blank href=https://cyware.com/news/nasty-urlzone-banking-trojan-resurfaces-in-fresh-campaigns-targeting-japan-2e38f84a>UrlZone Banker</a></ul>
    <ul><a target=_blank href=https://www.malwarebytes.com/blog/news/2022/03/escobar-is-the-new-android-banking-trojan-weve-met-before>Escobar</a></ul>
    <ul><a target=_blank href=https://thehackernews.com/2023/09/xenomorph-banking-trojan-new-variant.html>Xenomorp</a></ul>
    <ul><a target=_blank href=https://research.nccgroup.com/2022/03/03/sharkbot-a-new-generation-android-banking-trojan-being-distributed-on-google-play-store/>SharkBot</a></ul>
    <ul><a target=_blank href=https://securelist.com/bizarro-banking-trojan-expands-its-attacks-to-europe/102258/>Bizarro</a></ul>
    <ul><a target=_blank href=https://securityintelligence.com/posts/new-ze-loader-targets-online-banking/>ZE Loader</a></ul>
    <ul><a target=_blank href=https://www.cybereason.com/blog/research/eventbot-a-new-mobile-banking-trojan-is-born>EventBot</a>)</ul>
  </ol></p>
