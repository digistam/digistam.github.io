<html>
    <meta name=”robots” content=”noindex,nofollow”/>
  <a href=index.html>Back to home</a>
<hr/>
source: CEH v. 12

<h1>Trojans</h1>

<p>Computer Trojans are closely related to <a href=APT.html>APT</a>. A Trojan refers to the Trojan War in ancient Greek mythology. A computer Trojan is a program in which malicious or harmful code is contained inside an apparently harmless program or data, which can later gain control 
  and cause damage, such as ruining the FAT. Computer trojans are used to trick a victim into performing a predefined action.</p>
  <p>A Trojan is wrapped within or attached to a legitimate program. Victims are used as unwitting intermediaries to attack others. A victim's computer can be used to commit illegal DoS attacks.</p>
  <p>Trojans work at the same level of privileges as the victims and can attempt to exploit vulnerabilities to increase the level of access. If succesful, the Trojan can use such increased privileges to install other malicious 
  code on the victim's machine.</p>
  <p>A Trojan, depending on the actions it performs, may falsely implicate a remote system as the source of an attack by spoofing, thereby causing the remote system to incur a liability. Trojans enter the system by email attachments, 
  downloads and instant messages.</p>
  <h2>Common Ports used by Trojans</h2>
  <p>Trojans use client and server. Various Trojans use specific ports to infect target systems. Among the various states, the "listening" state is the important one in this context. The system generates this state when it listens for a port number while waiting 
  to connect to another system. Whenever a system reboots, Trojens move to the listening state; some use more than one port: one for "listening" and the other(s) for data transfer.</p>
  <h1>Types of Trojans</h1>
  <p><ol>
    <ul>Remote Access Trojans (RAT)</ul>
    <ul>Backdoor Trojans</ul>
    <ul>Botnet Trojans</ul>
    <ul>Rootkit Trojans</ul>
    <ul>E-Banking Trojans</ul>
    <ul>Point-of-Sale Trojans</ul>
    <ul>Defacement Trojans</ul>
    <ul>Service Protocol Trojans</ul>
    <ul>Mobile Trojans</ul>
    <ul>IoT Trojans</ul>
    <ul>Security Software Disable Trojans</ul>
    <ul>Destructive Trojans</ul>
    <ul>DDoS Attack Trojans</ul>
    <ul>Command Shell Trojans</ul>
  </ol></p>
<h2>Remote Access Trojans (RAT)</h2>
<p>RATs provide attackers with full control over the victim's system, thereby enabling them to remotely access files, private conversations, accounting data etc. The RAT acts as a server and listens on a port that is not supposed 
to be available to Internet attackers. If the user is behind a firewall, it is less likely that a remote attacker will connect to the Trojans. Attackers in the same network located behind the firewall can easily access Trojans.
 RATs are used to infect the target machine to gain administrative access. RATs help to access and control the computer. Infection by phishing attacks and drive-by downloads, via infected USB keys or networked drives. RATs can
download and execute additional malware, execute shell commands, read and write registry keys, capture screenshots, log keystrokes, spy on webcams.</p>
<p>Example: <a target=_blank href=https://github.com/simalei/njRAT>njRAT</a> (<a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.njrat>more</a> >>) is a RAT with powerful data-stealing capabilities. It can be used to control botnets. It can:
<ol>
  <ul>Remotely access the victim's computer</ul>
  <ul>Collect victim's information such as IP, hostname and OS</ul>
  <ul>Manipulate files and system files</ul>
  <ul>Open active remote session providing the attacker access to the command line of the victim's machine</ul>
  <ul>Log keystrokes and steal credentials from browsers</ul>
</ol></p>
  <p>Other RATs:
  <ol>
    <ul><a target=_blank href=https://suleyman-celik8.medium.com/what-is-prorat-b32b2e387d76>ProRat</a></ul>
    <ul><a target=_blank href=https://github.com/Samsar4/Ethical-Hacking-Labs/blob/master/6-Malware/5-Windows-Tools.md>Theef</a></ul>
    <ul><a target=_blank href=https://blog.morphisec.com/new-jssloader-trojan-delivered-through-xll-files>JSSLoader</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.crimson>CrimsonRAT</a></ul>
    <ul><a target=_blank href=https://www.zscaler.com/blogs/security-research/return-minebridge-rat-new-ttps-and-social-engineering-lures>MINEBRIDGE</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/jar.strrat>StrRAT</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.fatal_rat#:~:text=FatalRat%20Propose%20Change&text=According%20to%20PCrisk%2C%20FatalRAT%20is,use%20it%20for%20various%20purposes.>FatalRAT</a></ul>
    <ul><a target=_blank href=https://www.pcrisk.nl/verwijderingsrichtlijnen/11352-teabot-malware-android>TeaBot</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.flawedammyy>FlawedAmmyy</a></ul>
    <ul><a target=_blank href=https://blog.lumen.com/ismdoor-malware-continues-to-make-use-of-dns-tunneling/>Ismdoor</a></ul>
    <ul><a target=_blank href=https://news.sophos.com/en-us/2017/09/12/beware-the-kedi-rat-pretending-to-be-a-citrix-file-that-gmails-home/>Kedi RAT</a></ul>
    <ul><a target=_blank href=https://unit42.paloaltonetworks.com/babyshark-malware-part-two-attacks-continue-using-kimjongrat-and-pcrat/>PCRat / Gh0st RAT</a> (<a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.ghost_rat>more information</a>)</ul>
  </ol></p>
<h2>Backdoor Trojans</h2>
<p>A backdoor is a program that can bypass the standard system authentication or conventional system mechanisms like IDS and firewalls, without being detected. In these types of breaches, hackers leverage backdoor programs to access the victim's computer or network.
The difference with other types of malware is that the installation of the backdoor is performed without the user's knowledge.</p>
    <p>Backdoor Trojans are often used to group victim computers to form a botnet or zombie network that can be used to perform criminal activities. Often,
     Backdoor Trojans are initially used in the second (point of entry) or third (command and control C&C) stage of the targeted attack process. </p>
    <p>The Backdoor Trojan has a user interface, client component, which can be used by the attacker to issue command to the server component residing in the compromised machine.
     A traditional backdoor does NOT have a GUI!</p>
    <h2>Example: <a target=_blank href=https://www.f-secure.com/v-descs/backdoor-w32-poisonivy.shtml>PoisonIvy</a></h2>
    <p>PoisonIvy gives the attacker almost complete control over the infected computer. The PoisonIvy remote administration tool is
     created and controlled by a <a target=_blank href=https://www.securityweek.com/poison-ivy-kit-enables-easy-malware-customization-attackers/>PoisonIvy management program or kit</a>. The PoisonIvy kit consists 
    of a graphical user interface and the backdoors are small (< 10kb). Once the backdoor is executed, it copies itself to either the
     Windows folder or the Windows\system32 folder. The filename and locations of the backdoor are defined by the creator of the backdoor 
    when using the PoisonIvy kit to create the server program. Some variants of PoisonIvy can copy themselves into an alternative 
    data stream. </p>
    <p>Everytime the computer is booted up, the backdoor is started because of a <b>registry entry</b>. The server automatically connects 
    to a client using an address defined when the server part was created. The communication between the server and client programs is 
    <b>encrypted</b> and <b>compressed</b>. PoisonIvy can be configured to inject itself into a <b>browser process</b> before making an 
    outgoing connection to bypass firewalls.</p>
    <p><ol>
        <ul>File modification, deletion and transfer to and from the infected system</ul>
        <ul>Windows registry can be viewed and edited</ul>
        <ul>Currently running processes can be viewed, suspended and killed</ul>
        <ul>Current network connections can be viewed and shut down</ul>
        <ul>Services can be viewed and controlled (stopped/started)</ul>
        <ul>Installed devices can be viewed, entries can be deleted or programs can be uninstalled</ul>
        <ul>The list of installed applications can be viewed, entries can be deleted or programs can be uninstalled</ul>
        <ul>Accesses Windows command shell on the infected computer</ul>
        <ul>Steals information by taking screenshots of the desktop and recording audio / webcam</ul>
        <ul>Accesses saved passwords and password hashes</ul>
    </ol></p>
<p>Other Backdoor Trojans:
  <ol>
    <ul><a target=_blank href=https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/kovter-an-evolving-malware-gone-fileless>Kovter</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/ps1.powerstats>POWERSTATS v3</a></ul>
    <ul><a target=_blank href=https://news.sophos.com/en-us/2019/04/25/extrapulsar-backdoor-based-on-leaked-nsa-code-what-you-need-to-know/>ExtraPulsar</a></ul>
    <ul><a target=_blank href=https://guillaumeorlando.github.io/RogueRobin-malware-analysis-eng>RogueRobin</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.servhelper>ServHelper</a></ul>
    <ul><a target=_blank href=https://research.checkpoint.com/2019/speakup-a-new-undetected-backdoor-linux-trojan/>SpeakUp linux backdoor</a></ul>
    <ul><a target=_blank href=https://interaktiv.br.de/winnti/english/>Winnti backdoor</a></ul>
    <ul><a target=_blank href=https://symantec-enterprise-blogs.security.com/threat-intelligence/daxin-backdoor-espionage>Daxin</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.sysjoker>SysJoker</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.portdoor>PortDoor</a></ul>
    <ul><a target=_blank href=https://www.enigmasoftware.com/nl/tomirisbackdoortrojan-verwijdering/>Tomiris</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.goldenspy>GoldenSpy</a> (<a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.ghost_rat>more information</a>)</ul>
  </ol></p>
<h2>Botnet Trojans</h2>
    <p>Most major information security attacks these days involve botnets. Bot herders use botnet Trojans to infect a large number
     of computers throughout a large geographical area to create a network of bots (bot herd) that can achieve control via a command-and-control (C&C) center.
     They trick regular computer users into downloading Trojan-infected files through phishing, <a target=_blank href=https://seo.co/seo-hacks/>SEO hacking</a>, <a target=_blank href=https://en.wikipedia.org/wiki/URL_redirection>URL redirection</a> etc.</p>
    <p>Once the user downloads and executes the botnet Trojan in the system, it connects back to the attacker using <a target=_blank href=https://en.wikipedia.org/wiki/IRC>IRC channels</a> and waits for further instructions. 
    Some botnet trojans also have worm features and automatically spread to other systems in the network. </p>
<p><h2>Example: Necurs</h2></p>
    <p>The Necurs botnet is a distributor of many pieces of malware, most notably Dridex and Locky. It delivers banking trojans and ransomwear threats in batches of millions of emails at a time, and it keeps reinventing itself.
     Necurs is distributed by spam e-mails and downloadable content from questionable / illegal sites. It is indirectly responsible for a significant 
    portion of cybercrime.</p>
    <p><ol>
    <ul>destruction of the system</ul>
        <ul>turning pc in spying tool</ul>
        <ul>electronic money theft</ul>
        <ul>botnet and mining</ul>
        <ul>serving as a gateway for other viruses</ul>
</ol></p>
    <p>Other Botnet Trojans:
  <ol>
    <ul><a target=_blank href=https://bitcoinist.com/electrum-botnet-steals-4-6-million-bitcoin-cryptocurrencies/>Electrum</a></ul>
    <ul><a target=_blank href=https://krebsonsecurity.com/2019/09/satori-iot-botnet-operator-pleads-guilty/>Satori</a></ul>
    <ul><a target=_blank href=https://securityaffairs.com/76659/malware/torii-iot-botnet.html>Torii botnet</a></ul>
    <ul><a target=_blank href=https://www.om.nl/actueel/nieuws/2023/08/29/grootste-wereldwijde-botnet-qakbot-onschadelijk-gemaakt>Qakbot</a></ul>
    <ul><a target=_blank href=https://www.trendmicro.com/vinfo/us/security/news/internet-of-things/-hide-n-seek-botnet-uses-peer-to-peer-infrastructure-to-compromise-iot-devices>Hide n Seek</a></ul>
    <ul><a target=_blank href=https://www.bsi.bund.de/EN/Themen/Verbraucherinnen-und-Verbraucher/Cyber-Sicherheitslage/Methoden-der-Cyber-Kriminalitaet/Botnetze/Steckbriefe-aktueller-Botnetze/Steckbriefe/Ramnit/Ramnit.html>Ramnit</a></ul>
    <ul><a target=_blank href=https://www.bsi.bund.de/EN/Themen/Verbraucherinnen-und-Verbraucher/Cyber-Sicherheitslage/Methoden-der-Cyber-Kriminalitaet/Botnetze/Botnetz-Avalanche/Malware/Pandabanker/Pandabanker.html>Panda</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.betabot>BetaBot</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/elf.fritzfrog>FritzFrog</a></ul>
    <ul><a target=_blank href=https://blog.netlab.360.com/b1txor20-use-of-dns-tunneling_en/>B1txor20 botnet</a></ul>
    <ul><a target=_blank href=https://thehackernews.com/2024/02/dirtymoe-malware-infects-2000-ukrainian.html>DirtyMoe</a></ul>
    <ul><a target=_blank href=https://blog.cloudflare.com/meris-botnet>Meris Botnet</a> (<a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.ghost_rat>more information</a>)</ul>
    <ul><a target=_blank href=https://nordvpn.com/blog/cyclops-blink/>Cyclops Blink</a></ul>
  </ol></p>
<h2>Rootkit Trojans</h2>
<p>Rootkit consists of two terms: root and kit. Root is a Linux / Unix term like administrator in Windows. The word kit denotes programs 
that allow someone to obtain root-/admin-level access to the computer by executing the programs in the kit. Rootkits can't be detected 
by services and provide full control of the victim OS. Rootkits are one component of a blended threat: dropper, loader and rootkit. 
Activating the dropper program usually entails human intervention, such as clicking on a malicious e-mail link. Once initiated, the dropper 
launches the loader and then deletes itself. Once active, the loader typically causes a buffer overflow which loads the rootkit into memory.</p>
<h2>Example: EquationDrug Rootkit</h2>
<p>EquationDrug is a dangerous computer rootkit that attacks Windows. It performs targeted attacks against various organizations and 
lands on the infected system by being downloaded and executed by the Trickler dubbed "DoubleFantasy" (Trojan.Win32.Micstus.A). It allows 
a remote attacker to execute shell commands on the infected system.</p>
    <p>Other rootkit Trojans:
  <ol>
    <ul><a target=_blank href=https://research.checkpoint.com/2018/ceidpagelock-a-chinese-rootkit/>CEIDPageLock</a></ul>
    <ul><a target=_blank href=https://attack.mitre.org/software/S0176/>Wingbird</a></ul>
    <ul><a target=_blank href=https://artemonsecurity.blogspot.com/2017/05/grayfish-rootkit-analysis.html>GrayFish</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.finfisher>FinFisher</a></ul>
    <ul><a target=_blank href=https://digital.nhs.uk/cyber-alerts/2017/cc-1513>ZeroAccess</a></ul>
    <ul><a target=_blank href=https://www.f-secure.com/v-descs/rootkit-w32-whistler-a.shtml>Whistler</a></ul>
    <ul><a target=_blank href=https://www.bleepingcomputer.com/news/security/chinese-hacking-group-uses-new-fire-chili-windows-rootkit/>Fire Chili rootkit</a></ul>
    <ul><a target=_blank href=https://www.akamai.com/blog/security/purple-fox-rootkit-now-propagates-as-a-worm>Purple Fox Rootkit</a></ul>
    <ul><a target=_blank href=https://heimdalsecurity.com/blog/ghostemperor-campaign-targets-asian-countries-abusing-microsoft-vulnerabilities/>Dubbed Demodex Rootkit</a></ul>
    <ul><a target=_blank href=https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/>Moonbounce</a></ul>
    <ul><a target=_blank href=https://www.bleepingcomputer.com/news/security/new-moriya-rootkit-used-in-the-wild-to-backdoor-windows-systems/>Moriya</a></ul>
    <ul><a target=_blank href=https://securityaffairs.com/126157/malware/ilobleed-wiper-hp-servers.html>iLOBleed</a>)</ul>
  </ol></p>
<h2>E-banking Trojans</h2>
<p>Extremely dangerous and emerged as significant threat to online banking. They intercept the victim's account information before the system can encrypt it and send it to the attacker's command and control center.
 Installation of these Trojans take place on the victim's computer when a malicious email attachment or a malicious advertisement is clicked.</p>
 <p>Attackers program these Trojans to steal minimum and maximum monetary amounts, so that they don't withdraw all the money in the account, avoiding suspicion. These Trojans also create screenshots of the bank account 
 statement, so that the victim thinks that there is no variation in the bank balance and is not aware of the fraud unless the balance is checked from another system or ATM. These Trojans may also steal credit card numbers 
 and billing details.</p>
 <p>Working: <ol>
     <ul><b>TAN Grabber</b> (<i>Transaction Authentication Number</i>) -> single use password for authenticating online banking accounts. Banking Trojans intercept valid TANs entered by users and replace them with random numbers. The 
     bank will reject such invalid random numbers. Subsequently, the attacker misuses the intercepted TAN with the target's login details</ul>
     <ul><b>HTML injections</b> -> the Trojan creates fake form fields on e-banking pages, enabling the attacker to collect the target's account details, credit card number, date of birth etc. The attacker can use this information 
     to impersonate the target and compromise the account</ul>
     <ul><b>Form Grabber</b> -> type of malware that captures a target's sensitive data such as IDs and passwords, from a web browser form or pages. It analyses POST requests and responses to the victim's browser</ul>
 </ol></p>
    <p>A <b>covert credential grabber</b> remains dormant until the user performs an online financial transaction. It works covertly to replicate itself on the computer and edits the registry entries each time the 
    computer is started. The Trojan also searches the cookie files that had been stored on the computer while browsing financial websites. Once the user attempts to make an online transaction, the Trojan covertly steals 
    the login credentials and transmits them to the hacker.</p>
     <p>Some methods: <ol>
         <ul>Keylogging</ul>
         <ul>Form data capture</ul>
         <ul>Insertign fraudulent form fields</ul>
         <ul>Screen captures and video recording</ul>
         <ul>Mimicking financial websites</ul>
         <ul>Redirecting to banking websites</ul>
         <ul>Man-in-the-middle attack</ul>
 </ol></p>
    <h2>Example: Dreambot</h2>
    <p>Dreambot banking Trojans are updated versions of Ursnif or Gozi. Can be delivered through the Emotet dropper or RIG exploit kit. This Trojan can also be embedded as a macro in an MS word document and sent to victims 
    via spam emails. If this Trojan gets into the victim's machine, it will covertly creates registry keys and processes and attempt to connect to multiple malicious C2C servers. After connecting to the C2C server, 
    it will perform keylogging and send the keylog data to the attacker. This keylog data can include passwords of banking websites, OTP messages, secure transaction passwords, pins etc.</p>
    <p>Other e-banking Trojans:
  <ol>
    <ul><a target=_blank href=https://www.kaspersky.nl/resource-center/threats/emotet>Emotet</a></ul>
    <ul><a target=_blank href=https://en.wikipedia.org/wiki/ZeuS_Panda>Panda Banker</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.ramnit>Ramnit</a></ul>
    <ul><a target=_blank href=https://en.wikipedia.org/wiki/ZeuS_Panda>ZeuS</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.dridex>Dridex</a></ul>
    <ul><a target=_blank href=https://cyware.com/news/nasty-urlzone-banking-trojan-resurfaces-in-fresh-campaigns-targeting-japan-2e38f84a>UrlZone Banker</a></ul>
    <ul><a target=_blank href=https://www.malwarebytes.com/blog/news/2022/03/escobar-is-the-new-android-banking-trojan-weve-met-before>Escobar</a></ul>
    <ul><a target=_blank href=https://thehackernews.com/2023/09/xenomorph-banking-trojan-new-variant.html>Xenomorp</a></ul>
    <ul><a target=_blank href=https://research.nccgroup.com/2022/03/03/sharkbot-a-new-generation-android-banking-trojan-being-distributed-on-google-play-store/>SharkBot</a></ul>
    <ul><a target=_blank href=https://securelist.com/bizarro-banking-trojan-expands-its-attacks-to-europe/102258/>Bizarro</a></ul>
    <ul><a target=_blank href=https://securityintelligence.com/posts/new-ze-loader-targets-online-banking/>ZE Loader</a></ul>
    <ul><a target=_blank href=https://www.cybereason.com/blog/research/eventbot-a-new-mobile-banking-trojan-is-born>EventBot</a>)</ul>
  </ol></p>
<h2>Point-of-Sale Trojans</h2>
<p>POS Trojans are a type of financial fraudulent malware that target POS and payment equipment such as <b>credit card / debit card readers</b>. These Trojans have a greater impact on retail businesses and 
retail customers. The <b>magnetic stripe</b> on a card consists of two tracks, TRACK1 and TRACK2. These are critical for completing the transaction using a POS  device. Track1 and Track2 comprise critical 
information related to the credit card. Once a POS Trojan affects and compromises a POS device, it attempts to grab the Track1 and Track2 information of the card that is inserted in the device. Once that 
attacker has this information he gets full control of the card and can easily perform financial fraud.</p>
<h2>Example: GlitchPOS</h2>
<p>Aka GlitchPOS.A is a fake cat game embedded in malware and not displayed at the time of execution. When victims install the cat game, the Trojan will be executed in the background and grabs the credit card 
information. GlitchPOS has become the most notorious financial Trojan, spread across the world. </p>
<p>Other POS Trojans:
  <ol>
    <ul><a target=_blank href=https://www.cyberbit.com/endpoint-security/new-lockpos-malware-injection-technique/>LockPOS</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.blackpos>BlackPOS</a></ul>
    <ul><a target=_blank href=https://www.security.nl/posting/666390/Ontwikkelaar+FastPOS-malware+bekent+schuld+in+Verenigde+Staten>FastPOS</a></ul>
    <ul><a target=_blank href=https://www.darkreading.com/vulnerabilities-threats/-punkypos-malware-dissected>PunkeyPOS</a></ul>
    <ul><a target=_blank href=https://en.wikipedia.org/wiki/CenterPOS_Malware>CenterPOS</a></ul>
    <ul><a target=_blank href=https://en.wikipedia.org/wiki/Malumpos_Malware>MalumPOS</a></ul>
    <ul><a target=_blank href=https://threatpost.com/new-pos-malware-pinkkite-takes-flight/130428/>PinkKite</a></ul>
    <ul><a target=_blank href=https://securelist.com/neutrino-modification-for-pos-terminals/78839/>NeutrinoPOS</a></ul>
  </ol></p>
<h2>Defacement Trojans</h2>
<p>Once spread over the system, defacement trojans can destroy or change the entire content of a database. Most dangerous when targetting websites, as they physically change the underlying HTML format. </p>
<p><b>Resource editors</b> allow to view, edit, extract and replace strings, bitmaps, logos, icons etc. from any Windows program. They allow viewing and editing or nearly any aspect of a compiled Windows program, from 
menus to dialog boxes and icons etc. They employ user-styled applications (UCAs) to deface Windows applications</p>
    <p><b>Restorator</b></p>
    <p><a target=_blank href=https://www.bome.com>Restorator</a> is a utility for editing Windows resources in applications 
    and their components (.exe, .dll, .res, .rc, .dcr). It can change, add or remove rersources such as text, images, 
    icons, sounds, videos, versions, dialogs and menus in nearly all Windows programs.</p>
    <p><ol>
        <ul>Translate (localization)</ul>
        <ul>Customize look and feel</ul>
        <ul>Replace logos and icons (branding)</ul>
        <ul>Enhance control over resource files in the software development process</ul>
        <ul>Hack into the inner workings of applications on the computer</ul>
    </ol></p>
<h2>Service Protocol Trojans</h2>
<p>These Trojans can take advantage of vulnerable service protocols such as VNC, HTTP/HTTPS and ICMP to attack a victim's machine</p>
<h2>VNC Trojan</h2>
<p>A VNC Trojan starts a VNC server daemon in the infected system (victim) and attacks using a VNC viewer. VNC is a utility and 
hard te detect by antivirus software.</p>
<p>Trojans with VNC capacibility:
  <ol>
    <ul><a target=_blank href=https://thehackernews.com/2024/04/vultur-android-banking-trojan-returns.html>Vultur</a></ul>
    <ul><a target=_blank href=https://www.techtarget.com/searchsecurity/definition/Dridex-malware>Dridex</a></ul>
    <ul><a target=_blank href=https://threats.kaspersky.com/en/threat/Trojan-Banker.Win32.Neverquest/>Neverquest</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.gozi>Gozi</a></ul>
  </ol></p>
    <h2>HTTP/HTTPS Trojans</h2>
    <p>HTTP/HTTPS Trojans can bypass any firewall and work in reverse as opposed to a straight HTTP tunnel. They use 
    web based interfaces and port 80. The execution of these Trojans take place on the internal host and spawns a child 
    program at a predetermined time. The child program is <b>a user to the firewall</b> so the firewall allows the program 
    to access the internet. However, this child program executes a local shell, connects to the webserver that the attacker 
    owns on the internet through an apparently legitimate HTTP request and sends it a ready signal. The attacker 
    converts all the traffic into a Base64 like structure and gives it as a value for a cgi string to avoid detection.</p>
    <h2>Example CGI string</h2>
    <p>(Slave) GET/cgi-bin/order?M5mAejTqZdgY0dgIO4Gh7eeeM HTTP/1.0</p>
    <p>(Master) g5mA1fbknz</p>
    <p>The GET of the internal host (Slave) is the command prompt of the shell; the answer is an encoded "ls" command from the attacker 
    on the external server (Master(.</p>
    <p>The Slave tries to connect to the Master daily at a specified time. If the administrator sees connections to the attacker's 
    server and connects it to his server, he just sees a broken web server because there is a token (password) in the 
    encoded cgi GET request.</p>
    <p>Usage is easy: edit <a target=_blank href=https://github.com/DtxdF/rwwwshell>rwwwshell.pl</a> for the correct values, execute "rwwwshell.pl slave" on the slave and run rwwwshell.pl on the Master just before the slave
    tries to connect. </p>
<p><b>SHTTPD</b> is a small HTTP server that can be embedded inside any program. It can be wrapped with a genuine program (like the game chess.exe). 
When executed, it will turn a computer into an unvisible web server.</p>
    <p>Example: an attacker connects to the victim using web browser http://10.0.0.5:443 and infects the victim's computer 
    with chess.exe, with Shhtpd running in the background and listening on port 443 (SSL). </p>
    <h2>HTTP RAT</h2>
    <p><ol>
        <ul>Uses web interfaces and port 80</ul>
        <ul>Reverse http tunneling</ul>
        <ul>More dangerous as they work nearly ubiquitously where the internet can be accessed</ul>
        <ul>Displays ads and records personal data/keystrokes</ul>
        <ul>Downloads unsolicited files and disables programs/system</ul>
        <ul>Floods internet connection and distributes threats</ul>
        <ul>Tracks browsing activities and hijacks internet browser</ul>
        <ul>Makes fraudulent claims about spyware detection and removel</ul>
    </ol></p>
    <h2>ICMP Trojans</h2>
    <p>ICMP is connectionless and provides error messages to unicast addresses. An attacker can hide the data using covert 
    channel methods in a protocol that is undetectable. The concept of ICMP tunneling allows <b>one protocol to be carried 
    over another protocol</b>. ICMP tunneling uses ICMP echo request and reply to carry a payload and stealthily access or 
    control the victim's machine.</p>
    <h1>Mobile Trojans</h1>
    <p>Mobile Trojans target mobile phones, which amount is rapidly increasing. The attacker tricks the victim into installing a malicious application.</p>
    <h2>BasBanke</h2>
    <p><a target=_blank href=https://securelist.com/basbanke-trend-setting-brazilian-banking-trojan/90365/>BasBanke</a> runs on Android and 
    was first detected during the Brazilian elections in 2018. It's a banking trojan and when it infects a device, it will perform 
    keystroke logging, screen recording, SMS interception and theft of credit card and financial information. To trick users into 
    downloading this Trojan, the Trojan creators advertise it with <b>WhatsApp</b> and <b>Facebook messages</b>. The most 
    widely spread and downloaded malicious version of BasBanke is the fake CleanDroid Android app. Cleandroid projects itself 
    as a mobile junk cleaning and memory boosting app, however it is actually a banking Trojan.</p>
    <p>Other Mobile Trojans:
  <ol>
    <ul><a target=_blank href=https://blog.checkpoint.com/security/agent-smith-android-malware-mobile-phone-hack-virus-google/>Agent Smith</a></ul>
    <ul><a target=_blank href=https://threats.kaspersky.com/en/threat/Trojan.AndroidOS.Hiddad/>Hiddad</a></ul>
    <ul><a target=_blank href=https://gbhackers.com/androrat-remote-access-trojan/>AndroRat</a></ul>
    <ul><a target=_blank href=https://securelist.com/the-rotexy-mobile-trojan-banker-and-ransomware/88893/>Rotexy</a></ul>
    <ul><a target=_blank href=https://securityintelligence.com/news/gplayed-android-trojan-imitates-google-apps-to-spy-on-and-steal-data-from-victims/>GPlayed</a></ul>
    <ul><a target=_blank href=https://securelist.com/the-rise-of-mobile-banker-asacub/87591/>Asacub</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/apk.gustuff>Gustuff</a></ul>
    <ul><a target=_blank href=https://www.zimperium.com/blog/grifthorse-android-trojan-steals-millions-from-over-10-million-victims-globally/>GriftHorse</a></ul>
      <ul><a target=_blank href=https://thehackernews.com/2024/04/vultur-android-banking-trojan-returns.html>Vultur</a></ul>
  </ol></p>
    <h2>Security Software Disabler Trojans</h2>
    <p>These Trojans stop the working of security programs such as firewalls and IDs by disabling them or killing the processes. 
    These are entry Trojans, which allow an attacker to perform the next level of attack on the target system.</p>
       <p>
  <ol>
    <ul><a target=_blank href=https://digital.nhs.uk/cyber-alerts/2017/cc-1465>CertLock</a></ul>
    <ul><a target=_blank href=https://www.cyberark.com/resources/threat-research-blog/ghosthook-bypassing-patchguard-with-processor-trace-based-hooking>GhostHook</a></ul>
    <ul><a target=_blank href=https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:BAT/Disabler&threatId=-2147225256>Trojan.Disabler</a></ul>
  </ol></p>
    <h2>Destructive Trojans</h2>
    <p>Sole purpose: delete files on a target system. Antivirus software may not detect destructive Trojans. Written as 
    simple batch files with commands like "DEL", "DELTREE" or "FORMAT". This destructive Trojan code is usually compiled as .ini, .exe, .dll or .com files. 
    The attacker can activate these Trojans or they can be set to initiate at a fixed time and date. <a target=_blank 
                                                                                                         href=https://www.techzine.nl/nieuws/security/415820/zeer-destructieve-malware-shamoon-is-het-werk-van-iraanse-hackers/>Shamoon</a> is considered the most 
    destructive Trojan.</p>
    <p>
  <ol>
    <ul><a target=_blank href=https://digital.nhs.uk/cyber-alerts/2017/cc-1316>Dimnie</a></ul>
    <ul><a target=_blank href=https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/>GreyEnergy</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/win.killdisk>Killdisk</a></ul>
  <ul><a target=_blank href=https://www.threatdown.com/blog/hermeticwiper-a-detailed-analysis-of-the-destructive-malware-that-targeted-ukraine/>HermeticWiper</a></ul>
      <ul><a target=_blank href=https://www.infosecinstitute.com/resources/malware-analysis/whispergate-a-destructive-malware-to-destroy-ukraine-computer-systems/>WhisperGate</a></ul>
    <ul><a target=_blank href=https://www.bitdefender.com/blog/hotforsecurity/new-foxblade-malware-hit-ukraine-hours-before-invasion-microsoft-says/>FoxBlade</a></ul>     
  </ol></p>
    <h2>DDoS Trojans</h2>
    <p>These Trojans make the victim a zombie that listens for commands sent from a DDoS Server on the Internet. 
    <a target=_blank href=https://www.cloudflare.com/learning/ddos/glossary/mirai-botnet/>Mirai</a> IoT botnet Trojan is considered as one of the most notorious DDoS attack Trojans.</p>

<p>
  <ol>
    <ul><a target=_blank href=https://www.bleepingcomputer.com/news/security/botnet-of-over-100k-devices-used-to-ddos-electrum-servers/>Electrum DDoS botnet</a></ul>
    <ul><a target=_blank href=https://digital.nhs.uk/cyber-alerts/2018/cc-2337>Bushido Botnet</a></ul>
    </ol></p>

<h2>Command Shell Trojans</h2>
    <p>Provides remote control of a command shell on a victim's machine. A Trojan server is installed on the victim's machine, 
    which opens a port, allowing the attacker to connect. The client is installed on the victim's machine.</p>
<p>
  <ol>
    <ul><a target=_blank href=https://certifiedethicalhackerceh.blogspot.com/2012/02/how-netcat-trojan-works.html>Netcat</a></ul>
    <ul><a target=_blank href=https://ophtek.com/dnsmessenger-is-a-new-method-of-cyber-attack/>DNS Messenger</a></ul>
          <ul><a target=_blank href=https://github.com/byt3bl33d3r/gcat>GCat</a></ul>
    </ol></p>


    
<h1>IoT Trojans</h1>
<p>Internet of things (IoT) refers to the internetworking of physical devices, buildings, cars, refridgerators and other items 
embedded with electronics. These IoT Trojans leverage a botnet to attack other machines outside the IoT network</p>
<h2>Mirai</h2>
<p>Self propagating IoT that infects poorly protected Internet devices. <a target=_blank href=https://www.cloudflare.com/learning/ddos/glossary/mirai-botnet/>Mirai</a> uses telnet port 23 or 2323 to find those devices that 
are still using their factory default username and password. Most IoT devices do. Mirai can infect such insecure devices (bots) 
and co-ordinate them to mount a DDoS attack against a chosen victim.</p>
<p><ol>
    <ul>Login attempts with 60 different factory default usernames and passwords</ul>
    <ul>built for multiple CPU architectures (x86, ARM, Sparc, PowerPC, Motorola)</ul>
    <ul>Connects to C2 to allow the attacker to specify an attack vector</ul>
    <ul>Increases bandwidth usage for infected bots</ul>
    <ul>Identifies and removes competing malware</ul>
    <ul>Blocks remote administration ports</ul>
</ol></p>
    <p>Other IoT Trojans:
  <ol>
    <ul><a target=_blank href=https://www.bitdefender.com/blog/hotforsecurity/silex-malware-wrecks-2000-iot-devices-four-hours/>Silex BrickerBot</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/elf.satori>Satori</a></ul>
    <ul><a target=_blank href=https://blog.avast.com/new-torii-botnet-threat-research>Torii botnet</a></ul>
    <ul><a target=_blank href=https://www.bleepingcomputer.com/news/security/updated-miori-botnet-c2-server-tells-researchers-to-f-off/>Miori IoT Botnet</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/elf.bashlite>Bashlite IoT Malware</a></ul>
    <ul><a target=_blank href=https://nsfocusglobal.com/gafgy-botnet-practitioner-of-the-baas-mode/>Gafgy Botnet</a></ul>
    <ul><a target=_blank href=https://www.avira.com/en/blog/katana-a-new-variant-of-the-mirai-botnet>Katana</a></ul>
    <ul><a target=_blank href=https://malpedia.caad.fkie.fraunhofer.de/details/elf.botenago>BotenaGo</a></ul>
      <ul><a target=_blank href=https://blog.netlab.360.com/ttint-an-iot-remote-control-trojan-spread-through-2-0-day-vulnerabilities/>Ttint</a></ul>
            <ul><a target=_blank href=https://www.nozominetworks.com/blog/dark-nexus-iot-botnet-analyzing-and-detecting-its-network-activity>Dark Nexus</a></ul>
  </ol></p>
<h1>Construction of a Trojan</h1>
<p><ol>
    <li>A new Trojan packet is created with tools like Trojan Horse Construction Kit, <a target=_blank href=https://github.com/trustedsec/social-engineer-toolkit>Social Engineering Toolkit (SET)</a> and Beast. 
New Trojans have a higher chance of succeeding in compromising the target system, as the security mechanisms might fail to detect them.
These Trojans can be transferred to a victim's machine using a <b>dropper</b> or <b>downloader</b>.</li>
<li>Employ a dropper or downloader to install the malicious code on the target system. The dropper appears to users as a legitimate 
application or a well-known or trusted file. Downloaders are malware transporters that do not contain the actual malware file but they contain a link 
from where the Trojan can be downloaded. When a downloader is executed, it connects back to the attacker's server and downloads the Trojan. Droppers can 
easily evade firewalls, but a downloader can be detected with the help of network analyzer tools.</li>
    <li>Employ a <b>wrapper</b> such as <a target=_blank href=https://www.un4seen.com/petite/>petite.exe</a>, <a target=_blank href=https://null-byte.wonderhowto.com/how-to/bypass-antivirus-software-by-obfuscating-your-payloads-with-graffiti-0215787/>Graffiti.exe</a>, <a target=_blank href=https://learn.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-it-pro/internet-explorer-11/ie11-ieak/iexpress-wizard-for-win-server>IExpress Wizard</a> or 
        <a target=_blank href=https://packetstormsecurity.com/files/14593/elitewrap.zip.html>eLiTeWrap</a> to help bind 
    the Trojan executable to legitimate files to install it on the target system</li>
    <li>Employ a crypter such as <a target=_blank href=https://www.bitcrypter.com/>BitCrypter</a> to encrypt the Trojan to evade detection by firewalls/IDS</li>
<li>Propagate the Trojan by implementing various methods such as sending it over (c)overt channels, exploit kits, emails, instant messenges, 
trying to trick victim's into downloading and executing it</li>
    <li>Deploy the Trojan on the victim's machine by executing the dropper of downloader</li>
    <li>Execute the damage routine. Most malware contains a damage routine that delivers payloads.</li>
</ol></p>
    <h2>Creating a Trojan</h2>
    <p><ol>
        <ul>DarkHorse Trojan Virus Maker (<a target=_blank href=https://any.run/report/d506a4b38dc7a62934d56d0bdb8825e4d64f887a285cd6964ced25ca7f1a7ced/d31e76f7-9dea-4f16-b639-f786ecd9f9d3>background info</a>)</ul>
        <ul>Senna Spy Trojan Generator</ul>
        <ul>Batch Trojan Generator</ul>
        <ul>Umbra Loader - Botnet Trojan Maker</ul>
    </ol></p>
    <h2>Employing a Dropper or Downloader</h2>
    <p><ol>
        <ul>Droppers are programs that are used to camouflage malware payloads and consist of one or more types of malware features that can make it undetectable by antivirus software. 
        The dropper is executed by simply loading its own code into the memory, and the malware payload is then extracted and written into the file system. 
        Emotet, Dridex, Gymdrop and Anatsa are well-known droppers.</ul>
        <ul>A downloader is a program that can download and install harmful programs such as malware. Downloaders are
        spread as camouflaged files attached in emails. When the victim opens the attached infected file, the downloader 
        tries to contact the remote server for directly fetching other malicious programs. <a target=_blank href=https://cyware.com/news/godzilla-loader-one-of-the-newest-kids-on-the-malware-downloader-block-0d0df53d>Godzilla downloader</a>, Trojan.downloader, <a target=_blank href=https://www.broadcom.com/support/security-center/attacksignatures/detail?asid=29217>W97M.Downloader</a> and 
        ISB.Downloader!gen309 are some well-known downloaders.</ul>
    </ol></p>
<h2>Employing a Wrapper</h2>
<p><ol>
    <ul>Wrappers bind the executable with .exe applications that appear genuine such as games or office applications</ul>
    <ul>When the user runs the wrapped .exe it first installs the Trojan in the background and then runs the wrapping application in the foreground</ul>
    <ul>Wrappers are a type of glueware</ul>
</ol></p>
    <h2>Employing a Crypter</h2>
    <p>A crypter is software that encrypts the original binary code of the .exe file. Attackers use crypters to hide viruses, spyware, 
    keyloggers, RATs etc. to maken them invisible by antivirus software.</p>
    <h2>Propagating and deploying a Trojan</h2>
    <p>After creating a Trojan and employing dropper/downloader, wrapper and crypter, the attacker must transfer the package and
    deploy it on the target machine.</p>
    <p><ol>
        <ul><b>E-mail</b> -> as soon as the victim clicks the malicious link in an email the client connects directly to the Trojan server</ul>
        <ul><b>Covert channels</b> -> illegal hidden path used to transfer data from a network, relying on a tunnel created with protocols as DNS, SSH, ICMP and HTTP/S, evading anti-virus software </ul>
        <ul><b>proxy servers</b> -> a Trojan proxy is usually a standalone application that allow to use the victim's computer as a proxy to connect to the target machine. Thousands of machines on the internet are infected with proxy servers.</ul>
        <ul><b>USB/flash drives</b> -> sometime, attackers drop a USB drive and wait for a random victim to pick it up. Once the USB drive is picked up and inserted in a machine, the Trojan is propagated on the system by drop or download method.</ul>
    </ol></p>
    <h2>Evading anti-virus software</h2>
    <p><ol>
        <ul>break the Trojan apart into multiple pieces and zip them as a single file</ul>
        <ul>write a new Trojan and embed it into an application (antivirus will not recognize new Trojans)</ul>
        <ul>change the Trojan's syntax: convert an .exe to VB script, change .exe extension to ".doc, .exe", ".ppt, .exe" or ".pdf.exe" (Windows will hide known extensions by default, hence it shows it as .doc, .ppt, .pdf etc.)</ul>
        <ul>Change the content of the Trojan using a hex editor</ul>
        <ul>Change the checksum and encrypt the file</ul>
        <ul>never use Trojans downloaded from the web (easily detected by antivirus)</ul>
        <ul>use binder and splitter tools that can change the first few bytes of the Trojan</ul>
        <ul>perform code obfuscation or morphing to prevent the antivirus from differentiating between malicious and harmless programs</ul>
    </ol></p>
    <h1>Exploit kits</h1>
    <p>Exploit kits or crimeware toolkits are used to exploit security loopholes found in software applications such as Adobe Reader and Adobe 
    Flash Player, by distributing malware such as spyware, viruses, Trojans, worms, bots, backdoors, buffer overflow scripts etc.</p>
    <p>Exploit kits come with pre-written exploit code and are easy to use for an attacker how is not an IT or security expert. 
    An user-friendly interface helps to target browsers, programs that are accessible using browsers, zero-day vulnerabilities and 
    exploits updated with new patches instantly. Exploit kits are used against users running insecure or outdated software applications on their systems.</p>
    <h2>Flow</h2>
    <p><ol>
        <ul>The victim visits a legitimate website that is hosted on the compromised web server</ul>
        <ul>The victim is redirected through various intermediary servers</ul>
        <ul>The victim unknowingly lands on an exploit kit server hosting the exploit pack landing page</ul>
        <ul>The exploit kit gathers information on the victim, based on which it determines the exploit and delivers it to the victim's system</ul>
        <ul>If the exploit succeeds, a malware program is downloaded and executed on the victim's system</ul>
    </ol></p>
    <h2>Example: BotenaGo Exploit Kit</h2>
    <p>Written in the Go scripting language, contains over 30 variants of exploits and is capable of attaking millions of IoT and 
    routing devices worldwide. <a target=_blank href=https://duo.com/decipher/botenago-malware-source-code-appears-on-github>BotenaGo</a> was first discovered in 2021 and observed as Mirai botnet malware by antivirus software. 
    Attackers initiate the exploitation process by placing a backdoor in the victim device through port 31412 by sending a GET request 
    and listens for the victim's IP as the response through port 19412. BotenaGo is succesfully being used by attackers in distributing 
    DDoS functionalities by spreading payloads to victim devices.</p>

        <p>Other exploit kits:
  <ol>
    <ul><a target=_blank href=https://www.malwarebytes.com/blog/news/2019/08/say-hello-to-lord-exploit-kit>Lord</a></ul>
    <ul><a target=_blank href=https://www.malwarebytes.com/blog/news/2018/12/underminer-exploit-kit-improves-latest-iteration>Underminer Exploit Kit</a></ul>
    <ul><a target=_blank href=https://resources.prodaft.com/rig-exploit-kit-report>RIG Exploit Kit</a></ul>
    <ul><a target=_blank href=https://decoded.avast.io/janvojtesek/magnitude-exploit-kit-still-alive-and-kicking/>Magnitude</a></ul>
    <ul><a target=_blank href=https://unit42.paloaltonetworks.com/unit42-understanding-angler-exploit-kit-part-1-exploit-kit-fundamentals/>Angler</a></ul>
    <ul><a target=_blank href=https://cyware.com/news/neutrino-exploit-kit-a-walk-through-into-the-exploit-kits-campaigns-distributing-various-ransomware-cb14cdb8>Neutrino</a></ul>
    <ul><a target=_blank href=https://www.malwarebytes.com/blog/news/2017/11/terror-exploit-kit-goes-https-all-the-way>Terror</a></ul>
    <ul><a target=_blank href=https://blog.talosintelligence.com/sundown-ek/>Sundown</a></ul>
  </ol></p>
