 <meta name=”robots” content=”noindex,nofollow”/>
  <a href=index.html>Back to home</a>
<hr/>
<h1>Hacking web servers</h1>
<p>Web servers are a critical component of web infrastructure. A single vulnerability in web server configuration may lead to a security breach on websites. 
Web server security is critical to the normal functioning of an organization.</p>
<h2>Web server</h2>
<p>A web server is a computer system that stores, processes and delivers web pages to global clients via Hypertext Transfer Protocol (HTTP). Depending on the HTTP request, 
the web server collects the requested information / content from the data storage or application servers and responds to the client's request with an appropriate HTTP response. If the 
web server can't find the requested information, it will generate an error message.</p>
<p>Components:</p>
<p><ol>
 <ul>Document Root -> root file directory that stores critical HTML files related to web pages of a domain name, which will be sent in response to requests</ul>
 <ul>example: /var/www/html</ul>
 <ul>Server Root -> top-level root directory under the directory tree in which the server's configuration, error and log files are stored</ul>
 <ul>Virtual Document Tree -> provides storage on a different machine or disk after the original disk becomes full, case sensitive and can be used to provide object-level security</ul>
 <ul>Virtual Hosting -> technique of hosting multiple domains or websites on the same server, sharing of resources (name-based hosting, IP - based hosting, Port-based hosting)</ul>
 <ul>Web Proxy -> a proxy server is located between web client and web server, all requests from clients are passed on to the web server through the proxies; used to prevent IP blocking and maintain anonymity</ul>
</ol></p>
<h2>Open Source Web Server Architecture</h2>
<p>Open source web server architecture typically uses Linux, Apache, MySQL and PHP, often called the LAMP software bundle, as the principal components.</p>
<p><ol>
 <ul>Linux is the operating system (OS) of the web server and provides a secure platform</ul>
 <ul>Apache is the component of the web server that handles each HTTP request and response</ul>
 <ul>MySQL is a relational database used to store the content and configuration information of the web server</ul>
 <ul>PHP is the application layer technology used to generate dynamic web content</ul>
</ol></p>
<h2>IIS Web Server Architecture</h2>
<p>The Internet Information Service (IIS) is a web server application developed by Microsoft for Windows. IIS for Windows Server is a flexible, secure and easy-to-manage web server for hosting anything on the web.
It supports HTTP, HTTPS, FTP, FTPS, SMTP and NNTP (Network News Transfer Protocol).</p>
<ul>IIS has several components, including a protocol listener such as HTTP.sys and services such as the World Wide Web Publishing Service (WWW Service) and Windows Process Activation Service (WAS). Each 
component functions in application and web server roles. These functions may include listening to requests, managing processes and reading configuration files.</ul>

<h2>Web Server Security Issues</h2>
<p>A web server is a hardware / software application that hosts websites and makes them accessible over the internet. A web server, along with a browser, successfully implements client-server model architecture. 
The server plays the role of server and the browser acts as client. To host websites, a web server stores the web pages of websites and delivers a particular web page upon request. Each web server has a domain 
name and an IP address associated with that domain name. A web server can host more than one website. Any computer can act as a web server if it has specific server software (web server program) installed and 
is connected to the internet.</p>
<p>Apache, Microsoft IIS, Nginx, Google and Tomcat are some of the most widely used web server software. An attacker usually targets vulnerabilities in the software component and configuration errors to compromise 
web servers.</p>
<p>Organizations can defend most network-level and OS-level attacks by adopting network security measures such as firewalls, intrusion detections systems (IDSs) and intrusion prevention systems (IPSs) and by 
following security standards and guidelines. This forces attackers to turn their attention to web server and web application level attacks because a web server that hosts web applications is accessible from 
anywhere over the internet. This makes web servers an attractive target. Poorly configured web servers can create vulnerabilities in even the most carefully designed firewall systems. Attackers can exploit 
poorly configured web servers with known vulnerabilities to compromise the security of web applications. Furthermore, web servers with known vulnerabilities can harm the security of an organization.</p>

<h2>Levels of organizational security</h2>
<p>Stack 7: custom web applications (business logic flaws)</p>
<p>Stack 6: third-party components (open source / commercial)</p>
<p>Stack 5: web server (apache / nginx / microsoft IIS)</p>
<p>Stack 4: database (oracle / mysql / mssql)</p>
<p>Stack 3: operating system (windows / linux / macOS)</p>
<p>Stack 2: network (router / switch)</p>
<p>Stack 1: security (IPS / IDS)</p>

<h2>Common goals behind web server hacking</h2>
<p>Attackers perform web server attacks with certain goals in mind:</p>
<p><ol>
 <ul>Stealing credit card details or other sensitive credentials using phishing</ul>
 <ul>Integrating the server into a botnet to perform DoS or DDoS</ul>
 <ul>Compromising a database</ul>
 <ul>Obtaining closed source applications</ul>
 <ul>Hiding and redirecting traffic</ul>
 <ul>Escalating privileges</ul>
 <ul>Pure curiosity</ul>
 <ul>Completing a self-set intellectual challenge</ul>
 <ul>Damaging target organization's reputation</ul>
</ol></p>
<h2>Dangerous Security Flaws Affecting Web Server Security</h2>
<p>A web server configured by poorly trained system administrators may have security vulnerabilities. Inadequate knowledge, negligence, laziness and inattentiveness toward security can pose the
greates threats to web server security.</p>
<p><ol>
 <ul>Failing to update the web server with the latest patches</ul>
 <ul>Using the same system administrator credentials everywhere</ul>
 <ul>Allowing unrestricted internal and outbound traffic</ul>
 <ul>Running unhardened applications and servers</ul>
</ol></p>
<h2>Impact of Web Server Attacks</h2>
<p><ol>
 <ul>Compromise of user accounts</ul>
 <ul>Website defacement</ul>
 <ul>Secondary attacks from the website</ul>
 <ul>Root access to other applications or server</ul>
 <ul>Data tampering</ul>
 <ul>Data theft</ul>
 <ul>Damage reputation of the company</ul>
</ol></p>
<h2>Why are Web Servers Compromised</h2>
<p><ol>
 <ul>Webmaster's perspective -> LAN can be exposed, threats in the form of viruses, Trojans, attackers or compromise of data</ul>
 <ul>Network administrator's perspective -> poorly configured web sever causes potential holes in LAN security</ul>
 <ul>End user's perspective -> active content like ActiveX and Java make it possible for harmful applications, such as viruses, to invade a system</ul>
</ol></p>
<h2>Causes of compromise</h2>
<p><ol>
 <ul>Improper file and directory permissions</ul>
 <ul>Installing the server with default settings</ul>
 <ul>Unnecessary services enabled, incl. content management and remote administration</ul>
 <ul>Security conflicts with business' ease of use requirements</ul>
 <ul>Lack of proper security policy, procedures and maintenance</ul>
 <ul>Improper authentication with external systems</ul>
 <ul>Default accounts with default or no passwords</ul>
 <ul>Unnecessary default, backup or sample files</ul>
 <ul>Misconfigurations in web server, OS and web applications</ul>
 <ul>Bugs in server software, OS and web applications</ul>
 <ul>Misconfigures Secure Socket Layers (SSL) certificates and encryption settings</ul>
 <ul>Administrative or debugging functions that are enabled or accessible on web servers</ul>
 <ul>Use of self-signed certificates and default certificates</ul>
 <ul>Not using dedicated server for web services</ul>
</ol></p>

<h1>Web Server Attacks</h1>
<h2>DNS Server Hijacking</h2>
<p>The Domain Name System (DNS) resolves a domain name to its corresponding IP address. A user queries the DNS server with a domain name, and the DNS server responds with the corresponding IP address. 
In DNS server hijacking, an attacker compromises a DNS server and changes its mapping settings to redirect toward a rogue DNS server.</p>
<h2>DNS Amplification Attack</h2>
<p>Recursive DNS query is a method of requesting DNS mapping. The query goes through DNS servers recursively until it fails to find the specified domain name to IP address mapping.</p>
<p><ol>
 <ul>1) users who desire to resolve a domain name to its corresponding IP address send a DNS query to the primary DNS server specified in its Transmission Control Protocol (TCP)/IP properties</ul>
 <ul>2-7) if the requested DNS mapping does not exist on the user's primary DNS server, the server forwards the request to the root server; The root server forwards the request to the .com namespace, where
 the user can find DNS mappings; This process repeats recursively until the DNS mapping is resolved</ul>
 <ul>8) ultimately, when the system finds the primary DNS server for the requested DNS mapping, it generates a cache for the IP address in the user's primary DNS server</ul>
</ol></p>
<p>Attackers exploit recursive DNS queries to perform a DNS amplification attack that results in DDoS attacks on the victim's DNS server</p>
<p><ol>
 <ul>1) the attacker instructs compromised hosts (bots) to make DNS queries in the network</ul>
 <ul>2) all the compromised hosts spoof the victim's IP address and send DNS query requests to the primary DNS server configured in the victim's TCP/IP settings</ul>
 <ul>3-8) if the required DNS mapping does not exist on the victim's primary DNS server, the server forwards the requests to the root server; The root server forwards the request to the .com or 
 respective top-level domain (TLD) namespaces; This process repeats recursively until the victim's primary DNS server resolves the DNS mapping request</ul>
 <ul>9) after the primary DNS server finds the DNS mapping for the victim's request, it sends a DNS mapping response to the victim's IP address; This response goes to the victim because bots use the 
 victim's IP address; The replies to copious DNS mapping requests from the bots result in DDoS on the victim's DNS server</ul>
</ol></p>
<h2>Directory Traversal Attacks</h2>
<p>An attacker may be able to perform a directory traversal attack owing to a vulnerability in the code of a web application. In addition, poorly patched or configured web server software can make the 
web server vulnerable to a directory traversal attack. Directory traversal is the exploitation of HTTP through which attackers can access restricted directories and execute commands outside the web
server's root directory by manipulating a Uniform Resource Locator (URL). In directory traversal attacks, attackers use the dot-dot-slash (../) sequence to access restricted directories outside the 
web server's root directory. Attacker can use the trial-and-error method to navigate outside the web server's root directory and access sensitive information in the system. The attacker usually 
performs this attack with the help of a browser. A web server is vulnerable to this attack if it accepts input data from a browser without proper validation.</p>
<h2>Website Defacement</h2>
<p>Website defacement refers to unauthorized changes made to the content of a single web page or an entire website, resulting in changes to the visual appearance of the web page or website. Hackers break 
into web servers and alter the hosted website by injecting code to add images, popups, or text to a page in such a manner that the visual appearance of the page changes. In some cases, the attacker may 
replace the entire website instead of just changing a single page. Defaced pages expose visitors to propaganda or misleading information until the unauthorized changes are discovered and corrected. 
Attackers use a variety of methods, such as MySQL injection, to access a website to deface it. In addition to changing the visual appearance of the target website, attackers deface websites for infecting 
the computers of visitors by making the website vulnerable to virus attacks. Thus, website defacement not only embarrasses the target organization by changing the appearance of its website but is also 
intended to harm its visitors.</p>
<h2>Web Server Misconfiguration</h2>
<p><ol>
 <ul>Verbose debug/error messages</ul>
 <ul>Anonymous or default users/passwords</ul>
 <ul>Sample configuration and script files</ul>
 <ul>Remote administration functions</ul>
 <ul>Unncessary services enabled</ul>
 <ul>Misconfigured/default SSL certificates</ul>
</ol></p>
<p>Administrators who configure web servers improperly may leave serious loopholes in the web server, thereby providing an attacker the chance to exploit the misconfigured web server to compromise its 
security and obtain sensitive information. The vulnerabilities of improperly configured web servers may be related to configuration, applications, files, scripts or web pages. An attacker searches for 
such vulnerable web servers to launch attacks. The misconfiguration of a web server provides the attacker a path to enter the target network of an organization. These loopholes in the server can also help 
an attacker bypass user authentication. Once detected, these problems can be easily exploited and may result in the total compromise of a website hosted on the target web server.</p>

<h2>HTTP Response-Splitting Attack</h2>
<p>An HTTP response-splitting attack is a web-based attack in which the attacker tricks the server by injecting new lines into response headers, along with arbitrary code. It involves adding header response 
data into the input field so that the server splits the response into two responses. This type of attack exploits vulnerabilities in input validation. Cross-site scripting (XSS), cross-site 
request forgery (CSRF) and Structured Query Language (SQL) injection are examples of this type of attack. In this attack, the attacker controls the input parameter and cleverly constructs a request 
header that elicits two responses from the server. The attacker alters a single request to appear as two requests by adding header response data into the input field. The web server, in turn, responds to 
each request. The attacker can pass malicious data to a vulnerable application, and the application includes the data in an HTTP response header. The attacker can control the first response to redirect 
the user to a malicious website, whereas the web browser will discard other responses.</p>

<h2>Web Cache Poisoning Attack</h2>
<p>Web cache poisoning damages the reliability of an intermediate web cache source. In this attack, an attacker swaps cached content for a random URL with infected content. Users of the web cache source 
may unknowingly use the poisoned content instead of the true and secured content when requesting the required URL through the web cache. An attacker forces the web server's cache to flush its actual cache content 
and sends a specially crafted request to store in the cache. In this case, all the users of that web server cache will receive malicious content until the servers flush the web cache. Web cache poisoning 
attacks are possible if the web server and application have HTTP response-splitting flaws.</p>

<h2>SSH Brute Force Attack</h2>
<p>Attackers use SSH protocols to create an encrypted SSH tunnel between two hosts to transfer unencrypted data over an insecure network. Usually, SSH runs on TPC port 22. To perform an attack on SSH, 
an attacker scans the entire SSH server using bots (port scan op port 22) to identify possible vulnerabilities. With the help of a brute-force attack, the attacker obtains login credentials to gain 
unauthorized access to an SSH tunnel. An attacker who obtains the login credentials of SSH can use the same SSH tunnels to transmit malware and other means of exploitation to victims without being detected. 
Attackers use tools such as nmap and ncrack on a Linux platform to perform an SSH brute-force attack. </p>

<h2>Web Server Password Cracking</h2>
<p>An attacker attempts to exploit weaknesses to hack well-chosen passwords. The most common passwords found are <i>password, root, administrator, admin, demo, test, guest, qwerty, pet names</i> and so on. Main targets:</p>
<p><ol>
 <ul>SMTP and FTP servers</ul>
 <ul>Web shares</ul>
 <ul>SSH tunnels</ul>
 <ul>Web form authentication</ul>
 </ol></p>
 <p>Attackers use different methods such as social engineering, spoofing, phishing, Trojan horse, virus, wiretapping, keystroke logging to perform web server password cracking. In many hacking attempts, the 
 attacker starts with password cracking to prove to the web server that they are a valid user.</p>

 <h2>Web Server Password Cracking Techniques</h2>
 <p>Password cracking is the most common method of gaining unauthorized access to a web server by exploiting flawed and weak authentication mechanisms. Once the password is cracked, an attacker can use the 
 password to launch further attacks.</p>
 <p><ol>
  <ul>Guessing (human behavior)</ul>
  <ul>Dictionary attack</ul>
  <ul>Brute force attack</ul>
  <ul>Hybrid attack -> both dictionary attack and brute force attack, using symbols and numbers</ul>
 </ol></p>

 <h2>Other Web Server Attacks</h2>
 <h2>DoS / DDoS Attacks</h2>
 <p>Flooding targets with copious fake requests so that the target stops functioning and becomes unavailable to legit users. DoS / DDoS often targets high-profile web servers such as bank servers, credit card payment 
 gateways and even root name servers. Targets:</p>
 <p><ol>
  <ul>Network bandwidth</ul>
  <ul>Server memory</ul>
  <ul>Application exception handling mechanism</ul>
  <ul>CPU usage</ul>
  <ul>Hard disk space</ul>
  <ul>Database space</ul>
 </ol></p>
 <h2>MITM Attack</h2>
 <p>An attacker intercepts or modifies the messages exchanged between user and web server by eavesdropping or intruding into a connection. This allows an attacker to steal sensitive user information, such as 
 online banking detals, transferred over the internet to the web server. </p>
 <h2>Phishing attacks</h2>
 <p>Attackers send emails containing malicious links and trick users into clicking it. Clicking the link will redirect the user to a fake website that appears similar to the legit website. The website 
 prompts the user to enter sensitive information, such as usernames and passwords.</p>

 <h2>Web Application Attacks</h2>
 <p>Even if web servers are configured securely or are secured with network security measures such as firewalls, a poorly coded application deployed on the web server may provide a path for an attacker to 
 compromise the web server's security. If web developers do not adpot secure coding practices, attackers may be able to exploit vulnerabilities and compromise web applications and web server security.</p>
 <p><ol>
  <ul>Server-Side Request Forgery (SSRF) Attack: unsafe use of functions in an application in public web servers send crafted requests to the internal or backend servers; the backend server believes that the request 
  is made by the web server because they are on the same network and responds with the data stored in it</ul>
  <ul>Parameter/Form Tampering: manipulating paramters exchanged between client and server to modify application data such as user credentials and permissions as well as price and quantity of products (web shop form)</ul>
  <ul>Cookie Tampering: tampering of cookies sent from client to server</ul>
  <ul>Unvalidated Input and File Injection Attacks</ul>
  <ul>Session Hijacking</ul>
  <ul>SQL Injection Attacks: injecting malicious code into the strings, which are later on passed to the SQL server</ul>
  <ul>Directory Traversal</ul>
  <ul>DoS Attack</ul>
  <ul>Cross-Site Scripting (XSS) Attacks: injecting HTML tags or scripts into a target website</ul>
  <ul>Buffer Overflow Attacks</ul>
  <ul>Cross-Site Request Forgery (CSFR) Attack: exploiting trust of authenticated user</ul>
  <ul>Command Injection Attacks: altering content of the web page by using HTML code and by identifying form field that lack valid constraints</ul>
  <ul>Source Code Disclosure: result of typographical errors in scripts or misconfiguration, such as failure to grant executable permissions to a script or directory; source-code disclosure can allow attackers to 
  access sensitive information about database credentials and secret keys to compromise the web server</ul>
 </ol></p>
