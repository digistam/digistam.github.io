<a href=index.html>Back to home</a>
<hr/>
source: CEH v. 12

<h1>Hiding Files</h1>

<p>After an attacker has performed operations on the target system to gain escalated privileges, the malicious programs have to be hidden. A <b>rootkit</b> can be used. Protective applications such as antivirus, antimalware and antispyware will not be able to detect it. A rootkit allows the 
attacker to maintain direct access to the system, even in the future, without the victim knowing about it. <br/>

A <b>rootkit</b> is a software program designed to gain access to a computer without being detected. The goal is to gain root privileges to a system. It works by exploiting the vulnerabilities in the OS and it's applications. It builds a backdoor login process in the OS via which the attacker
can evade the standard login process. <br/>

With root access a rootkit may attempt to hide the traces of unauthorized access by modifying drivers or kernel modules and discarding active processes. A typical rootkit comprises backdoor programs, DDoS programs, packet sniffers, log-wiping utilities, IRC bots etc.<br/>

The attacker places a rootkit by:
  <ol>
<ul>Scanning for vulnerable computers and servers on the web</ul>
<ul>Wrapping the rootkit in a special package like a game</ul>
<ul>Installing it on public or corporate computers through social engineering</ul>
<ul>Launching a zero-day attack</ul>
  </ol>

Objectives of a rootkit:
<ol>
<ul>To root the host system and gain backdoor access</ul>
<ul>To mask attacker tracks and presence of malicious applications or processes</ul>
<ul>To gather personal information, sensitive data, network traffic etc. from the system</ul>
<ul>To store other malicious programs and act as a server resource for bot updates</ul>
</ol>
</p>
<h1>Six types of rootkits</h1>
<p><ol>
  <ul>Hypervisor-level rootkit</ul>
  <ul>Hardware/Firmware rootkit</ul>
  <ul>Kernel-level rootkit</ul>
  <ul>Boot-loader-level rootkit</ul>
  <ul>Application-level / User-mode rootkit</ul>
  <ul>Library-level rootkit</ul>
</ol></p>
<p>A <b>Hypervisor-level</b> rootkit is created by exploiting hardware features such as IntelVT and AMD-V. These rootkits run in Ring-1 and host the OS of the target machine as a virtual machine, intercepting all hardware calls made by the 
target OS. This kind of rootkits work by modifying the system's boot sequence so that it is loaded instead of the original virtual machine monitor.</p>
<p>A <b>hardware/firmware</b> rootkit use devices or platform firmware to create a persistent malware image in hardware, such as a hard drive, system BIOS or network card. The rootkit hides in firmware as the users do not inspect it for code integrity.</p>
<p>A <b>kernel-level</b> rootkit uses the core of the OS: the kernel. A kernel-level rootkit runs in Ring-0 with the highest OS privileges. These cover backdoors on the computer and are created by writing additional code, or by 
  substituting portions of kernel code with modified code via device drivers in Windows or loadable kernel modules in Linux. If the kit's code contains mistakes or bugs, kernel-level rootkits affect the stability of the system. These have the same 
  privileges as the OS; they are difficult to detect and can intercept or subvert the operation of an OS.</p>
<p>A <b>boot-loader-level</b> rootkit functions either by modifying the legitimate boot loader or replacing it with another one. The bootkit can activite even before the OS starts. Bootkits are serious threats to security because they facilitate
  the hacking of encryption keys and passwords</p>
  <p>An <b>application-level / user-mode</b> rootkit runs in Ring-3 as a user along with other applications in the system. It exploits the standard behavior of API's. It operates inside the victim's computer by replacing the standard
  application files (binaries) with rootkits or by modifying the behavior of present applications with patches, inject malicious code etc.</p>
  <p>A <b>library-level</b> rootkit works high up in the OS and usually patch, hook or supplant system calls with backdoor versions to keep the attacker unknown. They replace original system calls with fake ones to hide information about the hacker.</p>
