<html>
    <meta name=”robots” content=”noindex,nofollow”/>
  <a href=index.html>Back to home</a>
<hr/>
<h1>Sniffing</h1>
<h2>Network Sniffing</h2>
    <p>Packet sniffing is the process of monitoring and capturing all data packets passing through a given network using a software application or hardware device.
    Sniffing is straightforward in hub-based networks. However, most networks today work on switches. Difference between hub and switch is that a hub transmits line 
    data to each port of the machine and has no line mapping, whereas a switch looks at the MAC address associated with each frame passing through it and sends the
    data to the required port. An attacker needs to manipulate the functionality of the switch to see all the traffic passing through it.</p> 
    <p>A packet sniffing program (sniffer) can capture data packets only from within a given subnet and cannot sniff packets from another network. Many enterprises' switches 
    are open and a packet sniffer placed on a network in <b>promiscuos mode</b> can therefore capture and analyze all the network traffic. Sniffing programs turn off the
    filter employed by Ethernet network interface cards (NICs) to prevent the host machine from seeing other stations' traffic. Thus, sniffing programs can monitor
    all traffic (passwords in cleartext, email traffic etc.).</p>

    <h2>How a sniffer works</h2>
    <p>Most common is networking through an Ethernet connection. A computer connected to a LAN has two addresses: MAC and IP. A MAC address uniquely identifies each node in a network 
    and is stored on the NIC. The Ethernet protocol uses the MAC address to transfer data. The <b>data link layer</b> of the OSI model uses an Ethernet header with the MAC address of the 
    destination machine instead of the IP address. The <b>network layer</b> is responsible for mapping IP network addresses to the MAC addresses as required by the data link protocol. It 
    initially looks for the MAC address of the destination machine in a table (<b>Address Resolution Protocol - ARP - cache). If there is no entry for the IP address, an ARP broadcast 
    of a requested packet goes out to all machines on the local sub-network. The machine with the particular address responds to the source machine with its MAC address. The source
    machine's ARP cache adds this MAC address to the table. The source machine, in all its communications with the destination machine, then uses this MAC address.</b></p>

    <p>Two basic types of Ethernet environments:</p>
    <p><ol>
        <ul>Shared Ethernet -> all other machines receive packets meant for one machine, passive and difficult to detect</ul>
        <ul>Switched Ethernet -> the host connects to a switch instead of a hub, the switch maintains a table that tracks each computer's MAC address, a switch does not broadcast to all computers</ul>
    </ol></p>
    <p>Although a switch is more secure than a hub, sniffing the network is possible using the following methods:</p>
    <p><ol>
        <ul>ARP Spoofing</ul>
        <ul>MAC Flooding</ul>
    </ol></p>
    <h2>ARP Spoofing</h2>
    <p>ARP is stateless. A machine can send an ARP reply even without asking for it; it can also accept such a reply. When a machine wants to sniff the traffic originating from another system, 
    it can ARP spoof the gateway of the network. The ARP cache of the target machine will have an incorrect entry for the gateway. Thus, all the traffic destined to pass through the gateway 
    will now pass through the machine that spoofed the gateway MAC address.</p>
    <h2>MAC Flooding</h2>
    <p>Switches maintain a translation table that maps various MAC addresses to physical ports on the switch. As a result, they can intelligently route packets from one host to another. 
    However, switches have a limited memory. MAC flooding makes use of this limitation to bombard switches with fake MAC addresses until the switches can no longer keep up. Once this happens to a switch, 
    it will enter fail-open mode, wherein it starts acting as a hub by broadcasting packets to all the ports on the switch. Macof is a utility that comes with the dsniff suit and helps the attacker to 
    perform MAC flooding.</p>
<p>Once a switch turns into a hub, it starts <b>broadcasting</b> all packets it receives to all the computers in the network. By default, promiscuous mode is turned off in network machines; therefore 
the NICs accept only those packets that are addressed to a user's machine and discard the packets sent to the other machines. A sniffer turns the NIC of a system to promiscuous mode so that it 
listens to all the data transmitted on its segment. A sniffer can constantly monitor all the network traffic to a computer through the NIC by decoding the information encapsulated in the data packets.
Attackers configure the NIC in their machines to run in <b>promiscuous mode</b> so that the card starts accepting all the packets. Thus, the attacker can view all the packets that are being transmitted 
in the network.</p>
<h2>Types of Sniffing</h2>
<p><ol>
    <ul>Passive sniffing</ul>
    <ul>Active sniffing</ul>
</ol></p>
    <h2>Passive sniffing</h2>
    <p>Passive sniffing involves sending no packets. It simply captures and monitors the packets flowing in the network. A packet sniffer alone is not preferred for an attack because it works only in a 
    common collision domain (sector of the network that's not bridged or switched -> connected through a hub). A network that uses hubs to connect systems uses passive sniffing.</p>
    <p>Attackers use the following passive sniffing methods to gain control over a target network:</p>
    <p><ol>
        <ul>Compromising physical security -> walk into the organization and plug the laptop into the network to capture sensitive information</ul>
        <ul>Using a Trojan horse -> most Trojans have in-built sniffing capability</ul>
    </ol></p>
    <p>A switch eliminates the risk of <b>passive sniffing</b>, but is still vulnerable for <b>active sniffing</b>!</p>

    <h2>Active sniffing</h2>
    <p>Active sniffing searches for traffic on a switched LAN by actively injecting traffic into it. Active sniffing refers to sniffing through a switch. In active sniffing the switched Ethernet does not transmit 
    information to all the systems connected through LAN as it does in a hub-based network. Active sniffing involves sending out multiple network probes to identify access points. It is easy to detect these sniffer programs and highly difficult to perform this type of sniffing. However, attackers can 
    actively inject ARP traffic into a LAN to sniff around and capture the traffic. Switches maintain their own ARP cache in <b>Content Addressable Memory (CAM)</b>. CAM is a special type of memory that maintains 
    a record of which host is connected to which port. Different active sniffing techniques:</p>

    <p><ol>
        <ul>MAC flooding</ul>
        <ul>DNS poisoning</ul>
        <ul>ARP poisoning</ul>
        <ul>DHCP attacks</ul>
        <ul>Switch port stealing</ul>
        <ul>Spoofing attack</ul>
    </ol></p>

    <h2>Procedure hacking the network using sniffers</h2>

    <p><b>Step 1</b>: an attacker who decides to hack a network first discovers the appropriate switch to access the network and connects a system or laptop to one of the ports on the switch</p>
    <p><b>Step 2</b>: an attacker who succeeds in connecting to the network tries to determine network information such as the topology of the network by using network discovery tools</p>
    <p><b>Step 3</b>: by analyzing the network topology, the attacker identifies the victim's machine to target his attacks</p>
    <p><b>Step 4</b>: an attacker who identifies a target machine uses ARP spoofing techniques to send fake (spoofed) Address Resolution Protocol (ARP) messages</p>
    <p><b>Step 5</b>: the previous step helps the attacker to divert all the traffic from the victim's computer to the attacker's computer (typical <b>Man-in-the-Middle (MITM)</b> type of attack)</p>
    <p><b>Step 6</b>: now, the attacker can see all the data packets sent and received by the victim, the attacker can now extract sensitive information from the packets, such as passwords, usernames, 
    credit card details, PINs etc.</p>

    <h2>Protocols vulnerable to sniffing</h2>
    <p><ol>
        <ul>Telnet and Rlogin</ul>
        <ul>HTTP</ul>
        <ul>SNMP</ul>
        <ul>SMTP</ul>
        <ul>NNTP</ul>
        <ul>POP</ul>
        <ul>FTP</ul>
        <ul>IMAP</ul>
    </ol></p>

    <h2>Sniffing in the Data Link Layer of the OSI Model</h2>
    <p>The data link layer is the second layer of the OSI model. In this layer, data packets are encoded and decoded into bits. Sniffers operate at the data link layer and can capture packets from this layer.
    Networking layers in the OSI model are designed to work independently of each other; thus if a sniffer sniffs data in the data link layer, the upper OSI layers will not be aware of the sniffing.</p>

    <h2>SPAN Port</h2>
    <p>CISCO has a feature named Switched Port Analyzer (SPAN), also known as "port mirroring", that monitors network traffic on one or more ports on the switch. A SPAN port is a port that is configured 
    to receive a copy of every packet that passes through a switch. The user can simultaneously monitor the traffic of multiple ports, such as the traffic on all the ports of a specific virtual local area 
    network (VLAN).</p>

    <h2>Wiretapping</h2>
    <p>Wiretapping or telephone tapping refers to monitoring by a third party with covert intentions. Typically the attacker uses a small amount of the electrical signals generated by the telephone wires to 
    tap the conversation. The following are ways to perform wiretapping:</p>

    <p><ol>
        <ul>Official tapping of telephone lines</ul>
        <ul>Unofficial tapping of telephone lines</ul>
        <ul>Recording of the conversation</ul>
        <ul>Direct line wiretap</ul>
        <ul>Radio wiretap</ul>
    </ol></p>

    <h2>Types of wiretapping</h2>
    <p>There are two types of wiretapping that an attacker can use to monitor, record and even alter the data flow in the communication system:</p>
    <p><ol>
        <ul>Active Wiretapping -> MITM attack, allowing an attacker to monitor and record the traffic or data flow in a communication system</ul>
        <ul>Passive Wiretapping -> snooping or eavesdropping, allowing an attacker to monitor and record traffic</ul>
    </ol></p>
    <p>Wiretapping without a warrant or the consent of the people conducting the conversation is a criminal offense in most countries</p>

    <h2>Lawful Interception</h2>
    <p>Legally intercepting data communication between two endpoints for surveillance on traditional 
    telecommunications, VoiP, data and multiservice networks. LI obtains data from a communication network
    for analysis or evidence. Law enforcement agencies (LEA) legally sanctions network operators or 
    service providers to get access to private network data for monitoring private communications like 
    telephone calls and email messages.</p>

    <h1>Sniffing Techniques</h1>
    <h2>MAC Attacks</h2>
    <p>Attackers use techniques to steal and manipulate sensitive data, in order to gain control 
    over a target network by reading captured data packets and then using that information to break 
    into the network. </p>
    <p>Attackers use MAC attacks or MAC flooding to force a switch to act as a hub.</p>
    <h2>MAC address</h2>
    <p>A MAC address uniquely identifies each node of a network (Layer 2). A MAC address comprises
    48 bits, split into two sections of 24 bits. The first section contains the ID number of the 
    manufacturer (organizationally unique identifier - OUI) and the next six digits (24 bits) indicate 
    the adapter's serial number. </p>
    <h2>CAM table</h2>
    <p>A CAM table is a dynamic table of fixed size. It stores information such as MAC addresses available 
    on physical ports along with VLAN parameters associated. When a machine sends data to another machine in a 
    network, the data passes through the switch. The switch searches for the destination MAC address (in 
    Ethernet frame) in its CAM table, and one the MAC address is found, it forwards data to the machine 
    through the port with which the MAC address is bound. A CAM table refers to the dynamic form of content 
    and works with an Ethernet switch. The Ethernet switch maintains connections between ports and the CAM 
    table keeps track of MAC address locations on the switch. But the table is limited in size. 
    If the CAM table is flooded with more MAC addresses than it can hold, the switch will turn into
    a hub. The CAM table does this intentionally to ensure the delivery of data to the intended host.</p>

    <h2>How does it work</h2>
    <p>Three machines:</p>
    <p><ol>
        <ul>Machine A with MAC address A</ul>
        <ul>Machine B with MAC address B</ul>
        <ul>Machine C with MAC address C</ul>
    </ol></p>
    <p>Machine A wants to interact with Machine B</p>
    <p>Machine A broadcasts an ARP request to the switch, containing:</p>
    <p><ol>
        <ul>IP address of Machine B</ul>
        <ul>IP address of Machine A</ul>
        <ul>MAC address of Machine A</ul>
    </ol></p>
    <p>The switch broadcasts the ARP request to all hosts in the network and waits for the reply</p>
    <p>Machine B recognizes it's IP address and sends back an ARP reply along with its MAC address</p>
    <p>The CAM table in the switch stores the MAC address along with the port on which Machine B is connected</p>
    <p>The connection is now successfully established and Machine A forwards the traffic to Machine B</p>
    <p>Machine C did receive the broadcast, but didn't respond because it didn't recognize the IP address</p>
    <p>Machine C is unable to see the traffic flowing between Machine A and Machine B</p>

    <h2>What happens if a CAM table is full </h2>
    <p>When a CAM table is full, the switch broadcasts all incoming traffic to all ports, 
    similar to a hub. The MAC flooding attack also fills the CAM table of adjacent switches.</p>

    <h2>MAC Flooding</h2>
    <p>In a MAC flooding attack the attacker sends numerous fake MAC addresses to the switch.
    When the CAM table is full, any further requests may force the switch to enter fail-open mode.
    The attacker then changes the machine's NIC to promiscuous mode to enable the machine to 
    accept all the traffic entering it.</p>

    <h2>MAC flooding with macof</h2>
    <p><a target=_blank href=https://medium.com/@S3Curiosity/unleash-macof-an-essential-ethical-hacking-tool-for-network-security-a12445bc0501>macof</a>
    is a Unix/Linux tool that is part of the <a target=_blank href=https://nl.wikipedia.org/wiki/Dsniff>dsniff</a> collection. 
    It floods the local network with random MAC and IP addresses, causing some switches to fail and open in 
    repeating mode, thereby facilitating sniffing. This tool floods the switch's CAM tables (131.000 per minute) 
    by sending forged MAC entries. When the MAC table fills up and the switch converts to hub-like 
    operation, an attacker can monitor the data being broadcast.</p>

    <h2>Switch port stealing</h2>
    <p>This technique uses MAC flooding to sniff the packets. The attacker floods the switch with 
    forged gratuitous ARP packets with the target MAC address as the source and his own MAC 
    address as the destination. A race condition of the attacker's flooded packets and target host
    packets will occur and thus, the switch has to change its MAC address to bind constantly 
    between two different ports. In this case, if the attacker is fast enough, he will be able
    to direct the packets intended for the target host towards his switch port. Here, the attacker
    manages to steal the target host switch port and sends an ARP request to the switch port to
    discover the target host's IP address. When the attacker gets an ARP reply, this indicates 
    that the target host's switch port binding has been restored and the attacker can now sniff
    the packets sent towards the targeted host.</p>

     <h2>How does it work</h2>
    <p>Three machines:</p>
    <p><ol>
        <ul>Machine A with MAC address A</ul>
        <ul>Machine B with MAC address B</ul>
        <ul>Machine C with MAC address C</ul>
    </ol></p>
    <p>Machine C is the attacker</p>
    <p>Machine C spoofs both the IP address and the MAC address of Machine B</p>
    <p>Machine C runs a sniffer in promiscuous mode</p>
    <p>Machine A wants to communicate with Machine B and sends an ARP request to the switch, containing:</p>
    <p><ol>
        <ul>IP address of Machine B</ul>
        <ul>IP address of Machine A</ul>
        <ul>MAC address of Machine A</ul>
    </ol></p>
    <p>The switch broadcasts the ARP request to all machines in the network</p?
    <p>Before Machine B can respond to the ARP request, Machine C responds to the ARP request 
        by sending an ARP reply containing the spoofed MAC and IP addresses</p>
    <p>Machine C can achieve this by launching an attack such as DoS on Machine B, which slows 
        down its response</p>
    <p>Now the ARP cache in the switch records the spoofed MAC and IP addresses</p>
    <p>The spoofed MAC address of Machine B and the port connect to Machine C and update 
        the switch's CAM table</p>
    <p>Now, a connection is established between Machine A and Machine C</p>
    <p>The system will forward all the packets directed towards Machine B to Machine C (the attacker)</p>

    <h2>Sniffing Technique: DHCP Attacks</h2>
    <p>A DHCP attack is an active sniffing techique used by the attacker to steal and manipulate 
    sensitive data. DHCP is a client - server protocol that provides an IP address to an IP host. 
    The DHCP server also provides configuration-related information such as the default gateway and 
    subnet mask. When a DHCP client boots up, it participates in traffic broadcasting. DHCP servers 
    maintain IP configuration in a database such as valid TCP/IP configuration parameters, valid IP 
    addresses and duration of the lease offered by the server. It provides a lease offer to the client.</p>

    <h2>How does it work</h2>
    <p><ol>
        <ul>The clients boots up and broadcasts a DHCPDISCOVER / SOLICIT request asking for DHCP configuration information</ul>
        <ul>A DHCP-relay agent captures the request and unicasts it to the DHCP servers in the network</ul>
        <ul>A DHCP server unicasts DHCPOFFER / ADVERTISE which contains MAC addresses of both client and server</ul>
        <ul>The relay agent broadcasts DHCPOFFER / ADVERTISE in the client's subnet</ul>
        <ul>The client broadcasts DHCPREQUEST / REQUEST asking the DHCP server to provide the DHCP configuration information</ul>
        <ul>The DHCP server sends a unicast DHCPACK / REPLY message to the client with IP configuration and information</ul>
    </ol></p>

    <h2>DHCP Request / Reply messages</h2>
    <p>A device that already has an IP address can use the simple request / reply exchange to obtain 
    other configuration parameters from a DHCP server. When a client receives an offer from the server, it 
    immediately responds with sending back a DHCP request packet. Devices that are not using DHCP to acquire 
    IP addresses can still utilize DHCP's other configuration capabilities.</p>
    <p>DHCP has two functionalities: delivering host-specific configuration parameters and allocating 
    network addresses to hosts. DHCP messages have the same format as that of Bootstrap Protocol (BOOTP) 
    and maintain its compatibility with BOOTP relay agents, eliminating the need to change the BOOTP 
    client's initialization software to interoperate with DHCP servers.</p>

    <h2>DHCP Starvation Attack</h2>
    <p>In a DHCP Starvation Attack an attacker floods the DHCP server by sending numerous DHCP 
    requests and uses all of the available IP addresses that the DHCP server an issue. As a result, 
    the server cannot issue any more IP addresses, leading to a DoS attack. An attacker broadcasts 
    DHCP requests with spoofed MAC addresses with the help of tools as <a target=_blank href=https://github.com/tomac/yersinia>Yersinia</a>, 
        <a target=_blank href=https://github.com/r-richter/hyenae>Hyenae</a> and <a target=_blank href=https://gobbler.sourceforge.net/>Gobbler</a>.</p>

    <h2>Rogue DHCP Server Attack</h2>
    <p>In addition to DHCP starvation attacks, an attacker can perform MITM attacks such as sniffing.
    An attacker who succeeds in exhausting the DHCP server's IP address space can set up a rogue 
    DHCP server on the network, which is not under control of the network admin. The rogue server 
    impersonates a legitimate server and offers IP addresses and other network information. Although 
    both rogue and actual DHCP servers respond to requests, the client accepts the response that comes 
    first (rogue server). The response from the attacker's rogue DHCP server may assign the IP 
    address of the client's default gateway. The attacker then captures all the traffic and forwards 
    it to the default gateway. The rogue server can also direct the client to visit fake websites in an 
    attempt to gain the credentials. </p>
    <p>DHCP attack tools:</p>
    <p><ol>
        <ul><a target=_blank href=https://github.com/dirkjanm/mitm6>mitm6</a></ul>
        <ul><a target=_blank href=https://github.com/mschwager/dhcpwn>DHCPwn</a></ul>
        <ul><a target=_blank href=https://github.com/kamorin/DHCPig>DHCPig</a></ul>
    </ol></p>

    <h2>Sniffing Technique: ARP Poisoning</h2>
    <p>The ARP is a stateless TCP/IP protocol that maps IP network addresses to the 
    hardware address used by a data link protocol. Using this protocol a user can easily 
    obtain the MAC address of any device on a network. </p>
    <h2>How does it work</h2>
    <p><ol>
        <ul>The source machine generates an ARP request packet containing the MAC address, source IP address and destination IP address and sends it to the server</ul>
        <ul>On receiving the packet, the switch reads the MAC address of the source and searches for this in the CAM table</ul>
        <ul>The switch updates all the new entries; if the entry is not found in the table, the switch adds the MAC address and its incoming port to its CAM table and 
        broadcasts the ARP request packet into the network</ul>
        <ul>Each device in the network receives the broadcast ARP request and compares the destination IP address in the packet with its own IP address</ul>
        <ul>Only the system with an IP address that matches replies with an ARP reply packet</ul>
        <ul>The ARP reply message is then read by the switch, which adds the entry to its MAC table and 
        forwards the message to the destination machine, that sent the ARP request</ul>
        <ul>This machine updates the destination machine's IP and MAC address entries into its ARP table and 
        communication can now take place</ul>
    </ol></p>
    <h2>ARP Spoofing Attack</h2>
    <p>ARP packets can be forged to send data to the attacker's machine. ARP spoofing involves constructing a large 
    number of forged ARP requests and reply packets to overload a switch. ARP provides no means of verifying the authenticity
    of the responding device. Attackers use this flaw in ARP to create malformed ARP replies containing 
    spoofed IP and MAC addresses. Assuming it to be the legitimate ARP reply, the victim's computer blindly 
    accepts the ARP entry into its ARP table. Once the ARP table is flooded with spoofed ARP replies, the switch 
    is set in forwarding mode and the attacker intercepts all the data that flows from the victim's machine without the 
    victim being aware of the attack. This is also known as poisoning. ARP spoofing is an intermediary for 
    performing attacks such as DoS, MITM and session hijacking.</p>
    <h2>How does it work</h2>
    <p>When a legitimate user initiates a session with another user in the same layer 2 broadcast domain, 
    the switch broadcasts an ARP request using the recipient's IP address, while the sender waits for the recipient 
    to respond with a MAC address. An attacker eavesdropping on this unprotected layer 2 broadcast domain can respond 
    to the broadcast ARP request and replies to the sender by spoofing the intended recipient's IP address. The attacker 
    runs a sniffer and turns the machine's NIC adapter to promiscuous mode.</p>

    <h2>ARP poisoning tools</h2>
    <p><ol>
        <ul><a target=_blank href=https://linux.die.net/man/8/arpspoof>arpspoof</a></ul>
        <ul><i>arpspoof -i [Interface] -t [Target Host]</i></ul>
        <ul><a target=_blank href=https://github.com/fportantier/habu>Habu</a></ul>
        <ul><a target=_blank href=https://www.bettercap.org/>BetterCAP</a></ul>
        <ul><a target=_blank href=https://www.ettercap-project.org/>Ettercap</a></ul>
        <ul><a target=_blank href=https://www.monkey.org/~dugsong/dsniff/>dsniff</a></ul>
        <ul><a target=_blank href=https://github.com/byt3bl33d3r/MITMf>MITMf</a></ul>
        <ul><a target=_blank href=https://arpoison.sourceforge.net/>Arpoison</a></ul>
    </ol></p>

    <h2>Sniffing Technique: Spoofing Attacks</h2>
    <p>Besides ARP spoofing, an attacker can also use MAC spoofing, IRDP spoofing, VLAN 
    hopping and STP attacks to sniff the traffic of a target network. </p>

    <h2>MAC spoofing / duplicating</h2>
    <p>MAC duplicating refers to spoofing a MAC address with the MAC address of a legitimate 
    user on the network. If the spoofing is successful the attacker can receive all the 
    traffic designed for the client. This technique can be used to bypass wireless access points'
    MAC filtering.</p>

    <h2>MAC spoofing on Windows</h2>
    <p><ol>
        <ul>Start > Control Panel > Network and Internet > Network and Sharing Center</ul>
        <ul>Click Ethernet > Properties </ul>
        <ul>Click Configure > Advanced</ul>
        <ul>Under "Property" > Network Address</ul>
        <ul>Under "Value" >  Type new MAC address > OK</ul>
        <ul>Enter the MAC address without ":" in between</ul>
        <ul>Type ipconfig/all or net config rdr in the command prompt to verify the changes</ul>
        <ul>If the changes are visible, reboot the system</ul>
        <ul>If changes are not visible, try to change MAC address in the registry</ul>
    </ol></p>
    <p><ol>
        <ul>Press Win + R > regedit</ul>
        <ul>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Class\{4d36e972-e325-11ce-bfc1-08002be10318}</ul>
        <ul>Four digits sub keys representing network adapters will be found (starting with 0000, 0001)</ul>
        <ul>Search for the proper DriverDesc key to find the desired interface</ul>
        <ul>Right-click on the appropriate sub key and add the new string value "NetworkAddress" (REG_SZ) to contain the new MAC address</ul>
        <ul>Right-click on the NetworkAddress string value on the right side and select Modify</ul>
        <ul>In the Edit String dialog box, enter the new MAC address in the "Value data" field and click OK</ul>
        <ul>Disable and re-enable the network interface that was changed or reboot the system</ul>
    </ol></p>

    <h2>MAC Spoofing Tools</h2>
    <p><ol>
        <ul><a target=_blank href=https://technitium.com/tmac/>Technitium MAC Address Changer</a></ul>
        <ul><a target=_blank href=https://klcconsulting.net>SMAC</a></ul>
        <ul><a target=_blank href=https://sourceforge.net/projects/spoof-me-now/>Spoof-Me-Now</a></ul>
    </ol></p>

    <h2>IRDP Spoofing</h2>
    <p>ICMP Router Discovery Protocol (IRDP) is a routing protocol that allows a host to discover the IP 
    addresses of active routers on its subnet by listening to router advertisements and solicitation messages
    on its network. The attacker can add default route entries on a system remotely by spoofing router advertisement 
    messages. IRDP does not require any authentication. The target host will prefer the default route defined by the
    attacker over the default route provided by the DHCP server. The attacker accomplishes this by setting 
    the preference level and lifetime of the route at high values to ensure that the target host will choose it as 
    the preferred route. The attack succeeds if the attacker launching the attack is on the same network as the victim. 
    In the case of a Windows system configured as DHCP client, Windows checks the received router advertisements 
    for entries. If there is only one, then it checks whether the IP source address is within the subnet. If so, 
    it adds the default route entry; otherwise it ignores the advertisement. An attacker can use this to send spoofed 
    router advertisement messages so that all the data packets travel through the attacker's system. Thus, the attacker 
    can sniff the traffic and collect valuable information from the data packets. Attackers can use IRDP spoofing to 
    launch MITM, DoS and passive sniffing attacks.</p>
    <p><ol>
        <ul>Passive Sniffing: in a switched environment, the attacker spoofs IRDP traffic to re-route the outbound traffic 
        of target hosts through the attacker's machine</ul>
        <ul>MITM: once sniffing starts, the attacker acts as a proxy between the victim and the destination. The attacker 
        plays an MITM role and tries to modify the traffic</ul>
        <ul>DoS: IRDP spoofing allows remote attackers to add wrong route entries into the victim's routing table. The wrong 
        address causes DoS</ul>
    </ol></p>

    <h2>VLAN Hopping</h2>
    <p>Virtual local area network (VLAN) hopping is a technique used to target network resources 
    present on a VLAN. The main purpose behind a VLAN hopping attack is to gain access to the traffic 
    flowing in other VLANs present in the same network, which is otherwise inaccessible. Networks usually 
    have poor VLAN implementation or have misconfigurations that allow attackers to perform this type of attack.
    Attackers perform VLAN hopping attacks to steal sensitive information such as passwords; modify, corrupt or delete 
    data; install malicious codes or programs or spread viruses, Trojans and worms throughout the network.</p>
    <p><ol>
        <ul>Switch Spoofing -> a rogue switch is connected to the network by tricking a legitimate switch and 
        thereby creating a trunk link between them</ul>
        <ul>Double Tagging -> the attacker adds and modifies tags in the Ethernet frame, thereby allowing the flow of 
        traffic through any VLAN in the network</ul>
    </ol></p>

    <h2>STP Attack</h2>
    <p>In a Spanning Tree Protocol (SPT) attack, attackers connect a rogue switch into the network to 
    change the operation of the SPT protocol and sniff all the network traffic. </p>

    <h2>Sniffing Technique: DNS Poisoning</h2>
    <p>DNS is the protocol that translates a domain name into an IP address. The protocol uses DNS tables 
    that contain the domain name and its equivalent IP address stored in a distributed large database. In DNS 
    poisoning, also known as DNS spoofing, the attacker tricks a DNS server into believing that it has received 
    authentic information when, in reality, it has not received any. The attacker tries to redirect the victim to 
    a malicious server instead of the legitimate server. The attacker does this by manipulating the DNS table 
    entries in the DNS. This results in substitution of a false IP address at the DNS level, where web addresses 
    are converted into numeric IP addresses.</p>
    <p><ol>
        <ul>Intranet DNS Spoofing</ul>
        <ul>Internet DNS Spoofing</ul>
        <ul>Proxy Server DNS Poisoning</ul>
        <ul>DNS Cache Poisoning</ul>
    </ol></p>

    <h2>Intranet DNS Spoofing</h2>
    <p>Intranet DNS spoofing attack on a switched LAN with the help of the ARP poisoning technique. To 
    perform this attack, the attacker must be connected to the LAN and be able to sniff the traffic or packets. 
    An attacker who succeeds in sniffing the ID of the DNS request from the internet can send a malicious reply 
    to the sender before the actual DNS server.</p>

    <h2>Internet DNS Spoofing</h2>
    <p>Also known as remote DNS poisoning. To perform this attack, the attacker sets up a rogue 
    DNS server with a static IP address. Attackers perform Internet DNS spoofing with the help of Trojans 
    when the victim's system connects to the Internet. This is a MITM attack in which the attacker changes 
    the primary DNS entries of the victim's computer.</p>

    <h2>Proxy Server DNS Poisoning</h2>
<p>The attacker sets up a proxy server on his own system. The attacker also configures a fraudulent DNS and 
makes its IP address a primary DNS entry in the proxy server. The attacker changes the proxy server settings 
of the victim with the help of a Trojan. The proxy serves as a primary DNS and redirects the victim's 
traffic to the fake website, where the attacker can sniff the confidential information of the victim and then
redirect the request to the real website.</p>

    <h2>DNS Cache poisoning</h2>
    <p>Adding forged DNS records in the DNS resolver cache so that a DNS query is redirected to a 
    malicious site. The DNS system uses cache memory to hold the recently resolved domain names. The attacker 
    populates it with recently used domain names and their respective IP address entries. When a user 
    request is received, the DNS resolver first checks the DNS cache; if the system finds the domain name 
    that the user requested in the cache, the resolver will quickly send its respective IP address. It 
    reduces time and traffic.</p>
    <p>Attackers target and make changes or add entries to this DNS cache. If the DNS resolver cannot validate 
    that the DNS responses have come from an authoritative source, it will cache the incorrect entries 
    locally and serve them to users who make the same request. The attacker replaces the user-requested 
    IP address with the fake IP address and, when the user requests that domain name, the DNS resolver 
    checks the entry in the DNS cache and picks the matched (poised) entry. Then, it redirects the victim to 
    the attacker's fake server instead of the intended server.</p>

    <h2>SAD DNS Attack</h2>
    <p>SAD DNS is a new variant of DNS cache poisoning, in which an attacker injects harmful DNS records 
    into a DNS cache to divert all traffic toward their own server. Attackers attempt to mislead client browsers 
    to fake websites infected with malicious files, instead of the legitimate website. Attackers exploit 
    side channels; flaws such as dnsmasq, unbound and BIN in the latest OSes; and obsolete DNS software used 
    to resolve DNS queries to perform SAD DNS attacks.</p>

    <h2>DNS Poisoning Tools</h2>
    <p><ol>
        <ul><a target=_blank href=https://github.com/Trackbool/DerpNSpoof>DerpNSpoof</a></ul>
        <ul>DNS Spoof</ul>
        <ul>DNS-poison</ul>
        <ul><a target=_blank href=https://www.ettercap-project.org/>Ettercap</a></ul>
        <ul>Evilgrade</ul>
        <ul>DNS Poisoning Tool</ul>
    </ol></p>

    <h1>Detect sniffing</h1>

    <h2>How to detect sniffing</h2>
    <p>It is not easy to detect a sniffer on the network as it only captures data and runs in 
    promiscuous mode. There are some techniques:</p>
    <p><ol>
        <ul>Ping -> identify the system on the network running in promiscuous mode, send a Ping request with the machine's IP address and incorrect
        MAC address. The Ethernet adapter will reject it because the MAC address does not match, whereas the suspect machine running the 
        sniffer will respond to it as it does not reject packets with a different MAC address. Thus, this response will identify 
        the sniffer in the network</ul>
        <ul>DNS Method -> monitor the organization's DNS server to identify incoming reverse DNS lookups, for local reverse DNS lookups configure the 
        detector in promiscuous mode, send an ICMP request to a non-existing IP address and view the response. If the system receives a response, the 
        user can identify the responding machine as performing reverse DNS lookups on the local machine. A machine generating reverse DNS 
        lookup traffic will most likely be running a sniffer.</ul>
        <ul>ARP Method -> this technique sends a non-broadcast ARP to all the nodes in the network. The node that runs in promiscuous mode on the 
        network will cache the local ARP address. Then, it will broadcast a ping message on the network with the local IP address but a different 
        MAC address. In this case, only the node that has the MAC address (cached earlier) will be able to respond to your 
        broadcast ping request.</ul>
    </ol></p>

    <h2>Promiscuous Detection Tools</h2>
    <p><ol>
        <ul>Nmap -> NSE script</ul>
        <ul><i>nmap --script=sniffer-detect [Target IP / Range]</i></ul>
        <ul><a target=_blank href=https://www.netscantoolspro.com>NetScanTools Pro</a></ul>
    </ol></p>
