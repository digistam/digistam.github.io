    <meta name=”robots” content=”noindex,nofollow”/>
  <a href=index.html>Back to home</a>
<hr/>
<h1>Hacking wireless networks</h1>
<p>Wireless networks are cheaper and easier to maintain than wired networks.</p>
<h1>Wireless Concepts</h1>
<p>A wireless network is an unbounded data communication system that uses radio-frequency technology to communicate with devices and obtain data. This network frees the user from complicated 
and multiple wired connections using electromagnetic (EM) waves to interconnect two individual points without establishing any physical connection.</p>
<h2>Terminology</h2>
<p><ol>
  <ul><b>Global System for Mobile Communication (GSM)</b> -> universal system used for mobile data transmission in wireless networks worldwide</ul>
  <ul><b>Bandwidth</b> -> amount of information that may be broadcast over a connection; transfer rate measured in bits per second (bps)</ul>
  <ul><b>Access point (AP)</b> -> An AP is used to connect wireless devices to a wireless / wired network; allows communication through standards such as Bluetooth and Wi-Fi; serves as a switch or hub between a wired LAN and wireless network</ul>
  <ul><b>Basic service set identifier (BSSID)</b> -> MAC address of AP or base station that has set up a basic service set (BSS)</ul>
  <ul><b>Industrial, scientific and medical (ISM) brand</b> -> set of frequencies used by the international industrial, scientific and medical communities</ul>
  <ul><b>Hotspot</b> -> places where wireless networks ar available for public use</ul>
  <ul><b>Association</b> -> process of connecting a wireless device to an AP</ul>
  <ul><b>Service set identifier (SSID)</b> -> 32-alphanumeric character unique identifier given to a WLAN that acts as a wireless identifier of the network</ul>
  <ul><b>Orthogonal frequency-division multiplexing (OFDM)</b> -> method of digital modulation of data in which a signal, at a chosen frequency, is split into multiple carrier frequencies that are orthogonal (occurring at right 
  angles) to each other; produces transmission scheme that supports higher bit rates than parallel channel operation</ul>
  <ul><b>Multiple input, multiple output-orthogonal frequency-division multiplexing (MIMO-OFDM)</b> -> influences the spectral efficiency of 4G and 5G wireless communication services</ul>
  <ul><b>Direct-sequence spread spectrum (DSSS)</b> -> spread spectrum technique that multiplies the original data signal with a pseudo-random noise-spreading code</ul>
  <ul><b>Frequency-hopping spread spectrum (FHSS)</b> -> also known as FH-CDMA, is a method of transmitting radio signals rapidly switching a carrier among many frequency channels; Increases the efficiency of unauthorized 
  interception or jamming of telecommunications</ul>
  <ul><b>Mesh network</b> -> group of connected devices, like Wi-Fi routers, that act as a single network. So there are multiple Wi-Fi sources in your home instead of just one router; Because mesh networks broadcast 
    from every point in your home instead of a single location, they can provide better coverage over a larger area</ul>
</ol></p>

<h2>Wireless Networks</h2>
<p>Wireless networks use radio-wave transmission, usually at the physical layer of the network structure. Wi-Fi refers to a WLAN based on the IEEE 802.11 standard, and it allows a device to access the network from 
anywhere within the range of an AP</p>
<h2>Types</h2>
<p>Extension to a Wired Network -> placing APs between a wired network and wireless devices</p>
<p><ol>
  <ul>Software APs (SAPs) -> can be connected to a wired network; run on a computer equipped with a wireless network interface car (NIC)</ul>
  <ul>Hardware APs (HAPs) -> support most wireless features; act as switch providing connectivity for computers that use a wireless NIC</ul>
</ol></p>
<p>Multiple Access Points, connects computers wirelessly using multiple APs; if a single AP can't cover an area, multiple APs or extension points can be established; must overlap it neighbor's area</p>
<p>LAN-to-LAN wireless network, provide wireless connectivity to local computers, and local computers on different networks can be interconnected (complex task)</p>
<p>3G / 4G / 5G Hotspot, provides Wi-Fi to Wi-Fi enabled devices, including MP3 players, notebooks, tablets, cameras and more</p>

<h2>Wireless Standards</h2>
<p>Amendments to the standard <b>802.11</b> are indicated by letters of the alphabet</p>
<p><ol>
  <ul>802.11 (Wi-Fi) -> Frequency (GHZ): 2.4; Modulation: DSSS, FHSS; Speed (Mbps): 1, 2; Range (Meters): 20 - 100</ul>
  <ul>802.11a -> 5 Ghz, 3.7 Ghz; OFDM; 6, 9, 12, 18, 24, 36, 48, 54 Mbps; 35 Meters (5 Ghz), 5000 Meters (3.7 Ghz)</ul>
  <ul>802.11b -> 2.4 Ghz; DSSS; 1, 2, 5.5, 11 Mbps; 35 - 140 Meters</ul>
  <ul>802.11d -> enhancement of 802.11a and 802.11b; enables global portability by allowing variations in frequencies, power levels and bandwidth</ul>
  <ul>802.11e -> guidance for prioritization of data, voice and video transmissions enabling QoS</ul>
  <ul>802.11g -> 2.4 Ghz; OFDM; 6, 9, 12, 18, 24, 36, 48, 54 Mbps; 38 - 140 Meters</ul>
  <ul>802.11i -> standard for SLANs that provides improved encryption for networks that use 802.11a, 802.11b and 802.11g standards; defines WPA2-Enterprise/WPA2-Personal for Wi-Fi</ul>
  <ul>802.11n -> 2.4, 5 Ghz; MIMO-OFDM; 54 - 600 Mbps; 70 - 250 Meters</ul>
  <ul>802.15.1 (Bluetooth) -> 2.4 Ghz; GFSK, 4-DPSK, 8DPSK; 25 - 50 Mbsp; 10 - 240 Meters</ul>
  <ul>802.15.4 (ZigBee) -> 0.868, 0.915, 2.4 Ghz; O-QPSK, GFSK, BPSK; 0.02, 0.04, 0.25 Mbps; 1 - 100 Meters</ul>
  <ul>802.16 (WiMax) -> 2 - 11 Ghz; SOFDMA; 34 - 1000 Mbps; 1609.34 - 9656.06 Meters (1 - 6 Miles)</ul>
</ol></p>

<h2>Service Set Identifier (SSID)</h2>
<p>Case-sensitive, human-readable unique identifier of a WLAN; 32 alphanumeric characters in length. SSID is a token used to identify and locate 802.11 networks. By default, it is a part of the frame header of 
packets sent over a WLAN. Acts as a single shared identifier between APs and clients. This helps users locate an AP to which they can attempt a subsequent AUTH and ASSOC. Default values can be easily compromised.</p>
<p>SSID APs respond to probe requests with probe responses that also include the SSID itself, if it is not hidden. Because SSID is the unique identifier of a WLAN, all devices and APs in the WLAN must use the 
same SSID. A non-secure access mode allows clients to connect to the AP using the configured SSID, a blank SSID, or an SSID configured as "any". SSID does not provide security to a WLAN. The SSID can be kept 
confidential only in closed networks with no activity, which is inconvenient to legitimate users.</p>

<h1>Wi-Fi Authentication Modes</h1>
<h2>Open system authentication process</h2>
<p>Any wireless client that attempts to access a Wi-Fi network sends a request to the wireless AP for authentication. The station sends an authentication management frame containing the identity of the 
sending station for authentication and connection with the other wireless station, which is the AP. The AP then returns an authentication frame to confirm access to the requested station, completing the 
authentication process.</p>
<h2>Shared key authentication process</h2>
<p>Each wireless station receives a shared secret key over a secure channel that is distinct from the 802.11 wireless network communication channels.</p>
<p><ol>
  <ul>The station sends an authentication frame to the AP</ul>
  <ul>The AP sends a challenge text to the station</ul>
  <ul>The station encrypts the challenge text using its configured 64-bit or 128-bit key and sends the encrypted text to the AP</ul>
  <ul>The AP uses its configured for example Wired Equivalent Privacy (WEP) key to decrypt the encrypted text; The AP compares the decrypted text with the original challenge text. If they match, the AP authenticates 
  the station</ul>
  <ul>The station connects to the network</ul>
</ol></p>

<h2>Wi-Fi Authentication Process using a centralized Authentication Server</h2>
<p>802.1X standard provides centralized authentication. The AP must be able to securely identify the traffic from a specific wireless client. In this Wi-Fi authentication process, a centralized authentication server 
known as <b>Remote Authentication Dial-in User Service (RADIUS)</b> sends authentication keys to both the AP and the clients that attempt to authenticate with the AP. This key enables the AP to identify a 
particular wireless client.</p>

<h1>Wireless Antennas</h1>
<p>Antennas are an integral part of Wi-Fi networks. They convert electrical impulses into radio signals and vice versa.</p>
<h2>Directional Antenna</h2>
<p>Broadcasts and receives radio waves from a single direction; In order to improve transmission and reception, the directional antenna's design allows it to work effectively in only a few directions. This helps in 
reducing interference.</p>
<h2>Omnidirectional Antenna</h2>
<p>Radiate electromagnetic (EM) energy in all directions; 360 degrees horizontal radiation pattern. They radiate strong waves uniformly in two dimensions, but the waves are usually not as strong in the third dimension. 
These antennas are efficient in areas where wireless stations use time-division multiple access technology. A good example for an omnidirectional antenna is the antenna used by radio stations. </p>
<h2>Parabolic Grid Antenna</h2>
<p>A parabolic grid antenna uses the same principle as a sattelite dish, but it does NOT have a solid dish. It consists of a semi-dish in the form of a grid consisting of aluminium wires. Parabolic grid antennas 
can achieve very-long-distance Wi-Fi transmissions through highly focussed radio beams. This type of antenna is useful for transmitting weak radio signals over very long distances on the order of 10 miles. 
This enables attackers to obtain a better signal quality, resulting in more data to eavesdrop on, more bandwidth to abuse and a higher power output, essential in Layer-1 DoS and MITM attacks. The design of this 
antenna saves weight and space, and it can recieve Wi-Fi signals that are either horizontally or vertically polarized.</p>
<h2>Yagi Antenna</h2>
<p>Also named Yagi-Uda antenna, commonly used in communications at a frequency band of 10Mhz to VHF and UHF. This antenna has a high gain and low signal-to-noise (SNR) ratio for radio signals. It not only has a 
unidirectional radiation and response pattern, but also concentrates the radiation and response. It consists of a reflector, dipole and many directors. This antenna develops an end-fire radiation pattern.</p>
<h2>Dipole Antenna</h2>
<p>Straight electrical conductor measuring half a wavelength from end to end, connected at the center of the radio frequency (RF) feed line; also named doublet, bilaterally symmetrical and inherently a balanced 
antenna. This kind of antenna feeds on a balanced parallel-wire RF transmission line</p>
<h2>Reflector Antennas</h2>
<p>Used to concentrate EM energy that is radiated or received at a focal point; Generally paraboli. A larger antenna reflector in terms of wavelength multiples results in a higher gain. Reflector antennas 
reflect radio signals and have high manufacturing cost.</p>

<h1>Wireless Encryption</h1>
<p>Wireless encryption is a process of protecting a wireless network from attackers who attempt to collect sensitive information by breaching the RF traffic. </p>
<p><ol>
    <ul><b>802.11i</b> -> IEEE amendment that specifies security mechanisms for 802.11 wireless networks</ul>
    <ul><b>WEP</b> -> old and cracked easily</ul>
    <ul><b>EAP</b> -> Extensible Authentication Protocol; supports multiple authentication methods such as token cards, Kerberos and certificates</ul>
    <ul><b>LEAP</b> -> Lightweight EAP, proprietary version of EAP by Cisco</ul>
    <ul><b>WPA</b> -> advanced protocol using TKIP and Message Integrity Check (MIC) to provide strong encryption and authentication; uses a 48-bit initialization vector (IV), 32 bit cyclic redundancy check (CRC) and TKIP encryption for wireless security</ul>
    <ul><b>TKIP</b> -> security protocol in WPA as replacement for WEP</ul>
    <ul><b>WPA2</b> -> upgrade to WPA using AES and the Counter Mode Cipher Block Chaining Message Authentication Code Protocol (CCMP) for wireless data encryption</ul>
    <ul><b>AES</b> -> symmetric-key encryption used in WPA2 as replacement for TKIP</ul>
    <ul><b>CCMP</b> -> encryption protocol used in WPA2 for strong encryption and authentication</ul>
    <ul><b>WPA2 Enterprise</b> -> integrates EAP standards with WPA2 encryption</ul>
    <ul><b>RADIUS</b> -> centralized authentication and authorization management system</ul>
    <ul><b>PEAP</b> -> protocol that encapsulates the EAP within an encrypted and authenticated Transport Layer Security (TLS) tunnel</ul>
    <ul><b>WPA3</b> -> third-generation Wi-Fi security protocol that provides new features for personal en enterprise usage; uses Galois/Counter Mode-256 (GCMP-256) for encryption and the 384-bit hash message 
    authentication code with the Secure Hash Algorithm (HMAC-SHA-384) for authentication</ul>
</ol></p>

<h2>Wired Equivalent Privacy (WEP) Encryption</h2>
<p>WEP is a component of the IEEE 802.11 WLAN standards. Primary purpose is to ensure data confidentiality of wireless networks at a level equivalent to that of wired LANs, which can use physical security to 
prevent unauthorized access to a network. WEP uses the symmetric Rivest Cipher 4 (RC4) encryption algorithm.</p>
<p><ol>
    <ul>WEP protects against eavesdropping on wireless communications</ul>
    <ul>It attempts to prevent unauthorized access</ul>
    <ul>it depends on a secret key shared by a mobile station and an AP</ul>
    <ul>WEP encrypts only the data between network clients</ul>
</ol></p>
<p>WEP was developed without any academic or public review and has significant vulnerabilities and design flaws. As the Pre-shared keys (PSK) are rarely changed, the same key is used repeatedly. An attacker monitors
the traffic and finds different ways to work with the plaintext message. Attackers analyze the traffic from passive data captures and crack WEP keys with the help of tools such as AirSnort and WEPCrack.</p>

<h2>Wi-Fi Protected Access (WPA) Encryption</h2>
<p>WPA is a security protocol defined by the 802.11i standard. WPA has better data encryption security than WEP because messages pass through a Message Integrity Check (MIC) using the Temporal Key Integrity Protocol (TKIP)
which utilizes the RC4 stream cipher encryption with 128-bit keys and 64-bit MIC to provide strong encryption and authentication.  WEP normally uses 40-bit of 104-bit encryption key, whereas TKIP uses 128-bit keys for 
each packet</p>
<p><ol>
    <ul>TKIP is used in a unicast encryption key that changes for every packet, enhancing security; This change in the key for each packet is automatically coordinated between the wireless client and AP. TKIP uses 
    a Michael Integrity Check algorithm with a MIC key to generate the MIC value</ul>
    <ul>TKs -> all newly deployed Wi-Fi equipment uses either TKIP (for WPA) or AES (for WPA2) encryption to ensure WLAN security</ul>
</ol></p>
<p>How WPA works:</p>
<p><ol>
    <ul>A TK, transmit address and TKIP sequence counter (TSC) are used as input to the RC4 algorithm to generate a keystream</ul>
    <ul>The MAC service data unit (MSDU) and message integrity check (MIC) are combined using the Michael algorithm</ul>
    <ul>The combination of MSDU and MIC is fragmented to generate the MAC protocol data unit (MPDU)</ul>
    <ul>A 32-bit ICV is calculated for the MPDU</ul>
    <ul>The combination of MPDU and ICV is bitwise XORed with the keystream to produce the encrypted data</ul>
    <ul>The IV is added to the encrypted data to generate the MAC frame</ul>
</ol></p>

<h2>WPA2 Encryption</h2>
<p>Wi-Fi Protected Access 2 (WPA2) is a security protocol used to safeguard wireless networks. WPA2 replaced WPA in 2006. WPA2 introduces the use of the National Institute of Standards and Technology (NIST) FIPS 
140-2-compliant AES encryption algorithm (strong) and the Counter Mode Cipher Block Chaining Message Authentication Code Protocol (CCMP). It provides stronger data protection and network access control than 
WPA. Furthermore, it gives a high level of security to Wi-Fi connections so that only authorized users can access the network.</p>
