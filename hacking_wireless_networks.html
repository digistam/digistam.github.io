    <meta name=”robots” content=”noindex,nofollow”/>
  <a href=index.html>Back to home</a>
<hr/>
<h1>Hacking wireless networks</h1>
<p>Wireless networks are cheaper and easier to maintain than wired networks.</p>
<h1>Wireless Concepts</h1>
<p>A wireless network is an unbounded data communication system that uses radio-frequency technology to communicate with devices and obtain data. This network frees the user from complicated 
and multiple wired connections using electromagnetic (EM) waves to interconnect two individual points without establishing any physical connection.</p>
<h2>Terminology</h2>
<p><ol>
  <ul><b>Global System for Mobile Communication (GSM)</b> -> universal system used for mobile data transmission in wireless networks worldwide</ul>
  <ul><b>Bandwidth</b> -> amount of information that may be broadcast over a connection; transfer rate measured in bits per second (bps)</ul>
  <ul><b>Access point (AP)</b> -> An AP is used to connect wireless devices to a wireless / wired network; allows communication through standards such as Bluetooth and Wi-Fi; serves as a switch or hub between a wired LAN and wireless network</ul>
  <ul><b>Basic service set identifier (BSSID)</b> -> MAC address of AP or base station that has set up a basic service set (BSS)</ul>
  <ul><b>Industrial, scientific and medical (ISM) brand</b> -> set of frequencies used by the international industrial, scientific and medical communities</ul>
  <ul><b>Hotspot</b> -> places where wireless networks ar available for public use</ul>
  <ul><b>Association</b> -> process of connecting a wireless device to an AP</ul>
  <ul><b>Service set identifier (SSID)</b> -> 32-alphanumeric character unique identifier given to a WLAN that acts as a wireless identifier of the network</ul>
  <ul><b>Orthogonal frequency-division multiplexing (OFDM)</b> -> method of digital modulation of data in which a signal, at a chosen frequency, is split into multiple carrier frequencies that are orthogonal (occurring at right 
  angles) to each other; produces transmission scheme that supports higher bit rates than parallel channel operation</ul>
  <ul><b>Multiple input, multiple output-orthogonal frequency-division multiplexing (MIMO-OFDM)</b> -> influences the spectral efficiency of 4G and 5G wireless communication services</ul>
  <ul><b>Direct-sequence spread spectrum (DSSS)</b> -> spread spectrum technique that multiplies the original data signal with a pseudo-random noise-spreading code</ul>
  <ul><b>Frequency-hopping spread spectrum (FHSS)</b> -> also known as FH-CDMA, is a method of transmitting radio signals rapidly switching a carrier among many frequency channels; Increases the efficiency of unauthorized 
  interception or jamming of telecommunications</ul>
  <ul><b>Mesh network</b> -> group of connected devices, like Wi-Fi routers, that act as a single network. So there are multiple Wi-Fi sources in your home instead of just one router; Because mesh networks broadcast 
    from every point in your home instead of a single location, they can provide better coverage over a larger area</ul>
</ol></p>

<h2>Wireless Networks</h2>
<p>Wireless networks use radio-wave transmission, usually at the physical layer of the network structure. Wi-Fi refers to a WLAN based on the IEEE 802.11 standard, and it allows a device to access the network from 
anywhere within the range of an AP</p>
<h2>Types</h2>
<p>Extension to a Wired Network -> placing APs between a wired network and wireless devices</p>
<p><ol>
  <ul>Software APs (SAPs) -> can be connected to a wired network; run on a computer equipped with a wireless network interface car (NIC)</ul>
  <ul>Hardware APs (HAPs) -> support most wireless features; act as switch providing connectivity for computers that use a wireless NIC</ul>
</ol></p>
<p>Multiple Access Points, connects computers wirelessly using multiple APs; if a single AP can't cover an area, multiple APs or extension points can be established; must overlap it neighbor's area</p>
<p>LAN-to-LAN wireless network, provide wireless connectivity to local computers, and local computers on different networks can be interconnected (complex task)</p>
<p>3G / 4G / 5G Hotspot, provides Wi-Fi to Wi-Fi enabled devices, including MP3 players, notebooks, tablets, cameras and more</p>

<h2>Wireless Standards</h2>
<p>Amendments to the standard <b>802.11</b> are indicated by letters of the alphabet</p>
<p><ol>
  <ul>802.11 (Wi-Fi) -> Frequency (GHZ): 2.4; Modulation: DSSS, FHSS; Speed (Mbps): 1, 2; Range (Meters): 20 - 100</ul>
  <ul>802.11a -> 5 Ghz, 3.7 Ghz; OFDM; 6, 9, 12, 18, 24, 36, 48, 54 Mbps; 35 Meters (5 Ghz), 5000 Meters (3.7 Ghz)</ul>
  <ul>802.11b -> 2.4 Ghz; DSSS; 1, 2, 5.5, 11 Mbps; 35 - 140 Meters</ul>
  <ul>802.11d -> enhancement of 802.11a and 802.11b; enables global portability by allowing variations in frequencies, power levels and bandwidth</ul>
  <ul>802.11e -> guidance for prioritization of data, voice and video transmissions enabling QoS</ul>
  <ul>802.11g -> 2.4 Ghz; OFDM; 6, 9, 12, 18, 24, 36, 48, 54 Mbps; 38 - 140 Meters</ul>
  <ul>802.11i -> standard for SLANs that provides improved encryption for networks that use 802.11a, 802.11b and 802.11g standards; defines WPA2-Enterprise/WPA2-Personal for Wi-Fi</ul>
  <ul>802.11n -> 2.4, 5 Ghz; MIMO-OFDM; 54 - 600 Mbps; 70 - 250 Meters</ul>
  <ul>802.15.1 (Bluetooth) -> 2.4 Ghz; GFSK, 4-DPSK, 8DPSK; 25 - 50 Mbsp; 10 - 240 Meters</ul>
  <ul>802.15.4 (ZigBee) -> 0.868, 0.915, 2.4 Ghz; O-QPSK, GFSK, BPSK; 0.02, 0.04, 0.25 Mbps; 1 - 100 Meters</ul>
  <ul>802.16 (WiMax) -> 2 - 11 Ghz; SOFDMA; 34 - 1000 Mbps; 1609.34 - 9656.06 Meters (1 - 6 Miles)</ul>
</ol></p>

<h2>Service Set Identifier (SSID)</h2>
<p>Case-sensitive, human-readable unique identifier of a WLAN; 32 alphanumeric characters in length. SSID is a token used to identify and locate 802.11 networks. By default, it is a part of the frame header of 
packets sent over a WLAN. Acts as a single shared identifier between APs and clients. This helps users locate an AP to which they can attempt a subsequent AUTH and ASSOC. Default values can be easily compromised.</p>
<p>SSID APs respond to probe requests with probe responses that also include the SSID itself, if it is not hidden. Because SSID is the unique identifier of a WLAN, all devices and APs in the WLAN must use the 
same SSID. A non-secure access mode allows clients to connect to the AP using the configured SSID, a blank SSID, or an SSID configured as "any". SSID does not provide security to a WLAN. The SSID can be kept 
confidential only in closed networks with no activity, which is inconvenient to legitimate users.</p>

<h1>Wi-Fi Authentication Modes</h1>
<h2>Open system authentication process</h2>
<p>Any wireless client that attempts to access a Wi-Fi network sends a request to the wireless AP for authentication. The station sends an authentication management frame containing the identity of the 
sending station for authentication and connection with the other wireless station, which is the AP. The AP then returns an authentication frame to confirm access to the requested station, completing the 
authentication process.</p>
<h2>Shared key authentication process</h2>
<p>Each wireless station receives a shared secret key over a secure channel that is distinct from the 802.11 wireless network communication channels.</p>
<p><ol>
  <ul>The station sends an authentication frame to the AP</ul>
  <ul>The AP sends a challenge text to the station</ul>
  <ul>The station encrypts the challenge text using its configured 64-bit or 128-bit key and sends the encrypted text to the AP</ul>
  <ul>The AP uses its configured for example Wired Equivalent Privacy (WEP) key to decrypt the encrypted text; The AP compares the decrypted text with the original challenge text. If they match, the AP authenticates 
  the station</ul>
  <ul>The station connects to the network</ul>
</ol></p>

<h2>Wi-Fi Authentication Process using a centralized Authentication Server</h2>
<p>802.1X standard provides centralized authentication. The AP must be able to securely identify the traffic from a specific wireless client. In this Wi-Fi authentication process, a centralized authentication server 
known as <b>Remote Authentication Dial-in User Service (RADIUS)</b> sends authentication keys to both the AP and the clients that attempt to authenticate with the AP. This key enables the AP to identify a 
particular wireless client.</p>

<h1>Wireless Antennas</h1>
<p>Antennas are an integral part of Wi-Fi networks. They convert electrical impulses into radio signals and vice versa.</p>
<h2>Directional Antenna</h2>
<p>Broadcasts and receives radio waves from a single direction; In order to improve transmission and reception, the directional antenna's design allows it to work effectively in only a few directions. This helps in 
reducing interference.</p>
<h2>Omnidirectional Antenna</h2>
<p>Radiate electromagnetic (EM) energy in all directions; 360 degrees horizontal radiation pattern. They radiate strong waves uniformly in two dimensions, but the waves are usually not as strong in the third dimension. 
These antennas are efficient in areas where wireless stations use time-division multiple access technology. A good example for an omnidirectional antenna is the antenna used by radio stations. </p>
<h2>Parabolic Grid Antenna</h2>
<p>A parabolic grid antenna uses the same principle as a sattelite dish, but it does NOT have a solid dish. It consists of a semi-dish in the form of a grid consisting of aluminium wires. Parabolic grid antennas 
can achieve very-long-distance Wi-Fi transmissions through highly focussed radio beams. This type of antenna is useful for transmitting weak radio signals over very long distances on the order of 10 miles. 
This enables attackers to obtain a better signal quality, resulting in more data to eavesdrop on, more bandwidth to abuse and a higher power output, essential in Layer-1 DoS and MITM attacks. The design of this 
antenna saves weight and space, and it can recieve Wi-Fi signals that are either horizontally or vertically polarized.</p>
<h2>Yagi Antenna</h2>
<p>Also named Yagi-Uda antenna, commonly used in communications at a frequency band of 10Mhz to VHF and UHF. This antenna has a high gain and low signal-to-noise (SNR) ratio for radio signals. It not only has a 
unidirectional radiation and response pattern, but also concentrates the radiation and response. It consists of a reflector, dipole and many directors. This antenna develops an end-fire radiation pattern.</p>
<h2>Dipole Antenna</h2>
<p>Straight electrical conductor measuring half a wavelength from end to end, connected at the center of the radio frequency (RF) feed line; also named doublet, bilaterally symmetrical and inherently a balanced 
antenna. This kind of antenna feeds on a balanced parallel-wire RF transmission line</p>
<h2>Reflector Antennas</h2>
<p>Used to concentrate EM energy that is radiated or received at a focal point; Generally paraboli. A larger antenna reflector in terms of wavelength multiples results in a higher gain. Reflector antennas 
reflect radio signals and have high manufacturing cost.</p>

<h1>Wireless Encryption</h1>
<p>Wireless encryption is a process of protecting a wireless network from attackers who attempt to collect sensitive information by breaching the RF traffic. </p>
<p><ol>
    <ul><b>802.11i</b> -> IEEE amendment that specifies security mechanisms for 802.11 wireless networks</ul>
    <ul><b>WEP</b> -> old and cracked easily</ul>
    <ul><b>EAP</b> -> Extensible Authentication Protocol; supports multiple authentication methods such as token cards, Kerberos and certificates</ul>
    <ul><b>LEAP</b> -> Lightweight EAP, proprietary version of EAP by Cisco</ul>
    <ul><b>WPA</b> -> advanced protocol using TKIP and Message Integrity Check (MIC) to provide strong encryption and authentication; uses a 48-bit initialization vector (IV), 32 bit cyclic redundancy check (CRC) and TKIP encryption for wireless security</ul>
    <ul><b>TKIP</b> -> security protocol in WPA as replacement for WEP</ul>
    <ul><b>WPA2</b> -> upgrade to WPA using AES and the Counter Mode Cipher Block Chaining Message Authentication Code Protocol (CCMP) for wireless data encryption</ul>
    <ul><b>AES</b> -> symmetric-key encryption used in WPA2 as replacement for TKIP</ul>
    <ul><b>CCMP</b> -> encryption protocol used in WPA2 for strong encryption and authentication</ul>
    <ul><b>WPA2 Enterprise</b> -> integrates EAP standards with WPA2 encryption</ul>
    <ul><b>RADIUS</b> -> centralized authentication and authorization management system</ul>
    <ul><b>PEAP</b> -> protocol that encapsulates the EAP within an encrypted and authenticated Transport Layer Security (TLS) tunnel</ul>
    <ul><b>WPA3</b> -> third-generation Wi-Fi security protocol that provides new features for personal en enterprise usage; uses Galois/Counter Mode-256 (GCMP-256) for encryption and the 384-bit hash message 
    authentication code with the Secure Hash Algorithm (HMAC-SHA-384) for authentication</ul>
</ol></p>

<h2>Wired Equivalent Privacy (WEP) Encryption</h2>
<p>WEP is a component of the IEEE 802.11 WLAN standards. Primary purpose is to ensure data confidentiality of wireless networks at a level equivalent to that of wired LANs, which can use physical security to 
prevent unauthorized access to a network. WEP uses the symmetric Rivest Cipher 4 (RC4) encryption algorithm.</p>
<p><ol>
    <ul>WEP protects against eavesdropping on wireless communications</ul>
    <ul>It attempts to prevent unauthorized access</ul>
    <ul>it depends on a secret key shared by a mobile station and an AP</ul>
    <ul>WEP encrypts only the data between network clients</ul>
</ol></p>
<p>WEP was developed without any academic or public review and has significant vulnerabilities and design flaws. As the Pre-shared keys (PSK) are rarely changed, the same key is used repeatedly. An attacker monitors
the traffic and finds different ways to work with the plaintext message. Attackers analyze the traffic from passive data captures and crack WEP keys with the help of tools such as AirSnort and WEPCrack.</p>

<h2>Wi-Fi Protected Access (WPA) Encryption</h2>
<p>WPA is a security protocol defined by the 802.11i standard. WPA has better data encryption security than WEP because messages pass through a Message Integrity Check (MIC) using the Temporal Key Integrity Protocol (TKIP)
which utilizes the RC4 stream cipher encryption with 128-bit keys and 64-bit MIC to provide strong encryption and authentication.  WEP normally uses 40-bit of 104-bit encryption key, whereas TKIP uses 128-bit keys for 
each packet</p>
<p><ol>
    <ul>TKIP is used in a unicast encryption key that changes for every packet, enhancing security; This change in the key for each packet is automatically coordinated between the wireless client and AP. TKIP uses 
    a Michael Integrity Check algorithm with a MIC key to generate the MIC value</ul>
    <ul>TKs -> all newly deployed Wi-Fi equipment uses either TKIP (for WPA) or AES (for WPA2) encryption to ensure WLAN security</ul>
</ol></p>
<p>How WPA works:</p>
<p><ol>
    <ul>A TK, transmit address and TKIP sequence counter (TSC) are used as input to the RC4 algorithm to generate a keystream</ul>
    <ul>The MAC service data unit (MSDU) and message integrity check (MIC) are combined using the Michael algorithm</ul>
    <ul>The combination of MSDU and MIC is fragmented to generate the MAC protocol data unit (MPDU)</ul>
    <ul>A 32-bit ICV is calculated for the MPDU</ul>
    <ul>The combination of MPDU and ICV is bitwise XORed with the keystream to produce the encrypted data</ul>
    <ul>The IV is added to the encrypted data to generate the MAC frame</ul>
</ol></p>

<h2>WPA2 Encryption</h2>
<p>Wi-Fi Protected Access 2 (WPA2) is a security protocol used to safeguard wireless networks. WPA2 replaced WPA in 2006. WPA2 introduces the use of the National Institute of Standards and Technology (NIST) FIPS 
140-2-compliant AES encryption algorithm (strong) and the Counter Mode Cipher Block Chaining Message Authentication Code Protocol (CCMP). It provides stronger data protection and network access control than 
WPA. Furthermore, it gives a high level of security to Wi-Fi connections so that only authorized users can access the network.</p>
<p><ol>
    <ul><b>WPA2-Personal</b> -> uses a password set in advance, called the pre-shared key (PSK), to protect unauthorized network access. Each wireless device uses the same 256-bit key generated from a password to 
    authenticate with the AP; In the PSK mode, each wireless network device encrypts the network traffic using a 128-bit key derived from a passphrase of 8-63 ASCII characters. The router uses the combination 
    of a passphrase, network SSID and TKIP to generate a unique encryption key for each wireless client. These encryption continually.</ul>
    <ul><b>WPA2-Enterprise</b> -> uses EAP or RADIUS for centralized client authentication using multiple authentication methods, such as token cards, Kerberos and certificates. WPA2-Enterprise assigns a 
    unique ciphered key to every system and hides it from the user in order to provide additional security and to prevent the sharing of keys. Users are allocated login credentials by a centralized server, which 
    they must present when connecting to the network</ul>
</ol></p>

<h2>WPA3 Encryption</h2>
<p>WPA3 was announced by the Wi-Fi alliance on January 2018 as an advanced implementation of WPA2 that provides trailblazing protocols. Like WPA2, WPA3 has two variants: WPA3-Personal and WPA3-Enterprise.</p>
<p><ol>
    <ul><b>WPA3-Personal</b> -> mainly used to deliver password-based authentication. WPA3 is more rigid to attacks than WPA2 because it uses a modern key establishment protocol called the Simultaneous Authentication of Equals
    (SAE), also known as Dragonfly Key Exchange, which replaces the PSK concept used in WPA2-Personal</ul>
    <ul>- Resistance of offline dictionary attacks -> it prevents passive password attacks such as brute-forcing</ul>
    <ul>- Resistance to key recovery -> even when a password is determined, it is impossible to capture and determine session keys while maintaining the forward secrecy of network traffic</ul>
    <ul>- Natural password choice -> it allows users to choose weak or popular phrases as passwords, which are easy to remember</ul>
    <ul>- Easy accessibility </ul>
    <ul><b>WPA3-Enterprise</b> -> offers better security than WPA2 across the network and protects sensitive data using many cryptographic concepts and tools</ul>
    <ul>- Authenticated encryption </ul>
    <ul>- Key derivation and validation</ul>
    <ul>- Key establishment and verification</ul>
    <ul>- Frame protection and robust administration</ul>
</ol></p>

<h2> Enhancements in WPA3 with respect to WPA2</h2>
<p>WPA3 can be used to implement a layered security strategy that can protect all aspects of a Wi-Fi network. WPA3 has a certification program that specifies the prevailing standards the product must support. 
The Dragonfly handshake/SAE protocol is mandatory for WPA3 certification.</p>
<p><ol>
    <ul>Secured handshake -> the Simultaneous Authentication of Equals (SAE) protocol, also known as the Dragonfly handshake, can be used to make a password resistant to dictionary and brute-force attacks, preventing the 
    offline decryption of data</ul>
    <ul>Wi-Fi Easy Connect -> simplifies the security configuration process with one interface using DPP (Wi-Fi Device Provisioning Protocol). This can securely allow a plethora of smart devices in a network to 
    connect to one device using a quick response (QR) code or password. It also helps to set up a connection between different IoT devices</ul>
    <ul>Unauthenticated encryption -> it uses a new feature called Opportunistic Wireless Encryption (OWE) that replaces the 802.11 "open" authentication by providing better protection when using public hotspots 
    and public networks</ul>
    <ul>Bigger session keys -> the cryptographic security process of WPA3-Enterprise supports key sizes of 192 bits or higher, which are difficult to crack, ensuring rigid protection</ul>
</ol></p>

<h2>Comparison of WEP, WPA, WPA2 and WPA3</h2>
<p><ol>
    <ul><b>WEP</b> -> Encryption algorithm: RC4; IV Size: 24 bits; Encryption key length: 40/104 bits; Key management: None; Integrity Check Mechanism: CRC-32</ul>
    <ul><b>WPA</b> -> Encryption algorithm: RC4, TKIP; IV Size: 48-bits; Encryption key length: 128 bits; Key management: 4-way handshake; Integrity Check Mechanism: Michael algorithm and CRC-32</ul>
    <ul><b>WPA2</b> -> Encryption algorithm: AES-CCMP; IV Size: 48-bits; Encryption key length: 128-bits; Key management: 4-way handshake; Integrity Check Mechanism: CBC-MAC</ul>
    <ul><b>WPA3</b> -> Encryption algorithm: AES-GCMP 256; IV Size: Arbitrary length; Encryption key length: 192-bits; Key management: ECDH and ECDSA; Integrity Check Mechanism: BIP-GMAC-256</ul>
</ol></p>

<h1>Issues in WEP, WPA and WPA2</h1>
<h2>Issues in WEP</h2>
<p><ol>
    <ul>CRC32 is insufficient to ensure the complete cryptographic integrity of a packet</ul>
    <ul>IVs are of 24 bits</ul>
    <ul>WEP is vulnerable to known plaintext attacks</ul>
    <ul>WEP is vulnerable to dictionary attacks</ul>
    <ul>WEP is vulnerable to DoS attacks</ul>
    <ul>An attacker can eventually construct a decryption table of reconstructed keystream -> with approx. 24GB of space, an attacker can use this table to decrypt WEP packets in real time</ul>
    <ul>A lack of centralized key management makes it difficult to change WEP keys regularly</ul>
    <ul>IV is a value used to randomize the keystream value, and each packet has an IV value</ul>
    <ul>The standard does not require each packet to have a unique IV</ul>
    <ul>The use of RC4 was designed to be a one-time cipher and not intended for use with multiple messages</ul>
</ol></p>
<h2>Issues in WPA</h2>
<p><ol>
    <ul>Weak passwords -> password-cracking attacks</ul>
    <ul>Lack of forward secrecy -> if an attacker captures a PSK, they can decrypt all the packets encrypted with that key </ul>
    <ul>Vulnerability to packet spoofing and decryption -> clients using WPA-TKIP are vulnerable to packet-injection attacks and decryption attacks, which further allows attackers to hijack Transmission Control Protocol 
    (TCP) connections</ul>
    <ul>Predictability of the group temporal key (GTK)</ul>
    <ul>Guessing of IP addresses -> TKIP vulnerabilities allow attackers to guess the IP address of the subnet and inject small packets into the network to downgrade the network performance</ul>
</ol></p>

<h2>Issues in WPA2</h2>
<p><ol>
    <ul>Weak passwords -> if weak passwords: eavesdropping, dictionary and password cracking attacks</ul>
    <ul>Lack of forward secrecy -> if an attacker captures a PSK, they can decrypt all the packets encrypted with that key </ul>
    <ul>Vulnerability to MITM and DoS attacks -> the Hole96 vulnerability in WPA2 allows attackers to exploit a shared group temporal key (GTK) to perform MITM and DoS attacks</ul>
    <ul>Predictability of GTK -> an insecure random number generator (RNG) in WPA2 allows attackers to discover the GTK generated by the AP; This further allows attackers to inject malicious traffic in the network 
    and decrypt all the transmissions in progress over the internet</ul>
    <ul>KRACK vulnerabilities -> WPA2 has a significant vulnerability to an exploit known as key reinstallation attack (KRACK); This exploit may allow attackers to sniff packets, hijack connections, 
    inject malware and decrypt packets</ul>
    <ul>Vulnerability to wireless DoS attacks -> attackers can exploit the WPA2 replay attack detection feature to send forged group-addressed data frames with a large PN to perform a DoS attack</ul>
    <ul>Insecure WPS PIN recovery -> in some cases, disabling WPA2 and WPS can be a time consuming process, in which the attacker needs to control the WPA2 PSK used by the clients; When WPA2 and WPS are 
    enabled, the attacker can disclose the WPA2 key by determining the WPS personal identification number (PIN) through simple steps</ul>
</ol></p>
