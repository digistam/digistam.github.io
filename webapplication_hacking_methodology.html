 <meta name=”robots” content=”noindex,nofollow”/>
  <a href=index.html>Back to home</a>
<hr/>
<h1>Web Application Hacking Methodology</h1>
<p>Attackers use the web application hacking methodology to gain knowledge of a particular web application to compromise it succesfully. This methodology allows them to plan each step in detail 
to increase their chances of successfully hacking the application. Under this methodology, they do the following to collect detailed information about various resources  needed to run or access the 
web application:</p>
<p><ol>
 <ul>Footprint web infrastructure</ul>
 <ul>Analyze web applications</ul>
 <ul>Bypass client-side controls</ul>
 <ul>Attack authentication mechanisms</ul>
 <ul>Attack authorization schemes</ul>
 <ul>Attack access controls</ul>
 <ul>Attack session management mechanisms</ul>
 <ul>Perform injection attacks</ul>
 <ul>Attack application logic flaws</ul>
 <ul>Attack shared environments</ul>
 <ul>Attack database connectivity</ul>
 <ul>Attack web application clients</ul>
 <ul>Attack web services</ul>
</ol></p>
<p>If hackers do not use this process and try to exploit the web application directly, their chances of failure increases. </p>
<h2>Footprint Web Infrastructure</h2>
<p>Footprinting is the process of gathering complete information about a system and all its related components, as well as how they work. Finding vulnerabilities can help attackers exploit and gain 
unauthorized access to the web application.</p>
<p><ol>
 <ul>Server Discovery -> physical servers using Whois lookup, DNS interrogation, port scanning etc.</ul>
 <ul>Service Discovery -> nmap, netscantools pro etc.</ul>
 <ul>Server Identification -> banner grabbing; local identity (location, origin-host); local addresses; self-names</ul>
 <ul>Hidden Content Discovery -> extract content and functionality that is not directly linked or reachable from main visible content</ul>
 <ul>Load Balancers Detection -> detecting load balancers with real IP addresses</ul>
</ol></p>
<h2>Server Discovery</h2>
<p><ol>
 <ul>Whois Lookup -> whois.domaintools.com, netcraft, smartwhois (tamos.com) etc.</ul>
 <ul>DNS Interrogation -> organizations use DNS interrogation, a distributed database to connect their IP addresses with their respective hostnames and vice versa; find DNS records (network-tools.com), 
 DNSRecon, Domain Dossier (centralops.net), DNSdumpster.com</ul>
 <ul>Port scanning -> nmap, netscantools pro, advanced port scanner, hping3</ul>
</ol></p>
<h2>Service Discovery</h2>
<p><ol>
 <ul>80: World Wide Web standard port</ul>
 <ul>81: Alternate WWW</ul>
 <ul>88: Kerberos</ul>
 <ul>384: Remote Network Server System</ul>
 <ul>443: SSL (HTTPS)</ul>
 <ul>514: Remote Shell</ul>
 <ul>etc.</ul>
</ol></p>

<h2>Server Identification / Banner Grabbing</h2>
<p>Banner grabbing is a footprinting technique used by a hacker to obtain sensitive information about a target; telnet moviescope.com 80</p>
<p>Tools such as Telnet and Netcat are capable of grabbing banners of web servers over only an HTTP connection. Attackers perform the following steps to grab banners over an SSL connection:</p>
<p><ol>
 <ul>Install OpenSSL</ul>
 <ul>Start OpenSSL in terminal</ul>
 <ul>s_client -host <target website> -port 443</ul>
 <ul>GET / HTTP/1.0</ul>
</ol></p>

<h2>Detect Web App Firewalls and Proxies on Target Site</h2>
<p>The <b>trace</b> command sends a request to the web server, asking it to send back the request. If the web server is behind a proxy the proxy modifies this request by adding extra headers. </p>

<h2>Detect Web Application Firewalls</h2>
<p>WAFs can be detected by analyzing the HTTP header request. Most firewalls edit HTTP header requests and responses vary. Tools:</p>
<p><ol>
 <ul>WAFWOOF (github.com) -> identify and fingerprint WAFs protecting a website by looking at cookies, server cloaking, reponse code, drop action, pre-built-in rules</ul>
 <ul>SHIELDFY (shieldfy.io)</ul>
 <ul>nmap</ul>
</ol></p>

<h2>Hidden Content Discovery</h2>
<p>Hidden content and functionality not reachable from the main visible content can be discovered to exploit user privileges within the application:</p>
<p><ol>
 <ul>Web Spidering / Crawling -> OWASP ZAP, Burp suite etc. </ul>
 <ul>Attacker-Directed Spidering -> OWASP ZAP</ul>
</ol></p>

<h2>Detect Load Balancers</h2>
<p>There are two types of load balancers: DNS load balancers (Layer 4 load balancers) and HTTP load balancers (Layer 7 load balancers). Attackers use various tools such as dig, lbd load balancing detector and 
Halberd to detect load balancers. For example, if a single host resolves to multiple IP addresses.</p>
<p><ol>
 <ul>Using host command -> host <target domain></ul>
 <ul>Using dig command -> dig <target domain></ul>
 <ul>Using load balancing detector (lbd) -> lbd <target domain></ul>
</ol></p>
<p>After identifying the real IP addresses behind the load balancers, attackers perform further attacks on the target organization.</p>

<h2>Analyzing Web Applications</h2>
<p>Once attackers have attempted various possible attacks on a vulnerable web server, they may turn their attention to the web application itself. To hack the web application, first they may need to analyze it 
to determine its vulnerable areas. Even if it has only a single vulnerability, attackers try to compromise its security by launching an appropriate attack. Attackers define an <b>attack surface</b>:</p>
<p><ol>
 <ul>Identify Entry Points for User Input -> gateways for attacks; attackers review generated HTTP requests to identify the user input entry points</ul>
 <ul>Identify Server-Side Technologies -> ASP, ASP.NET, ColdFusion, JSP JavaServer Pages, PHP, Python, Ruby etc.</ul>
 <ul>Identify Server-Side Functionality -> referring to ability of executing programs on output web pages</ul>
 <ul>Identify Files and Directories -> web servers host web applications, misconfigurations may lead to exposure of critical files and directories over the internet</ul>
 <ul>Identify Web Application Vulnerabilities -> web applications are developed using various technologies and platforms, not following secure coding practices in the development may leave flaws</ul>
 <ul>Map the Attack Surface</ul>
</ol></p>
<p><a target=_blank href=https://www.net-square.com>httprint</a> is a web server fingerprinting tool that relies on web server characteristics to accurately identify web servers; <a target=_blank href=https://github.com/urbanadventurer/WhatWeb>WhatWeb</a>
scans and identifies web technologies, including CMS, blogging platforms, JavaScript libraries etc.</p>
<p>After determining the server-side technologies, attackers try to identify the server-side functionality to find potential vulnerabilities. <a target=_blank href=https://www.gnu.org>GNU Wget</a> is employed for 
retrieving files using HTTP, HTTPS and FTP which are the most widely used internet protocols; <a target=_blank href=https://curl.se>curl</a></p>
<p>Examine URL: an SSL certified page URL starts with https; if a page contains a .aspx extension, the application is likely written using ASP.NET; if the query string has a parameter named showBy you can assume 
that the application is using a database and will display the data by that value.</p>
<p>Attackers use various techniques and tools to enumerate applications, hidden directories and files of the web application hosted on web servers; they use tools like <a target=_blank href=https://github.com/OJ/gobuster>GoBuster</a>, 
URL Fuzzer and nmap NSE script http-enum to identify files and directories of the target web application:</p>
<p><ol>
 <ul>gobuster -u <target URL> -w common.txt</ul>
 <ul>gobuster -u <target UTL> -w common.txt -s 200 (files and directories with specific status codes)</ul>
 <ul>nmap -sV --script=http-enum <target domain or IP address></ul>
</ol></p>
<p>Attackers use various techniques to gain administrator-level access etc. Attackers use tools like <a target=_blank href=https://www.subgraph.com>Vega</a>, <a target=_blank href=https://wpscan.com>WPScan Vulnerability Database</a>, 
 <a target=_blank href=https://www.arachni-scanner.com>Arachni</a> and <a target=_blank href=https://sourceforge.net/projects/uniscan/>Uniscan</a> to identify vulnerabilities.</p>
<p>Vega is a free and open source web security scanner and web security testing platform for testing the security of web applications. Vega helps to find and validate SQL injection, XSS, inadvertently disclosed 
sensitive information etc.</p>
<p>Once attackers detect the entry points, server-side technologies and functionalities, they map the attack surface area:</p>
<p><ol>
 <ul>Client-Side Validation -> Injection Attack, Authentication Attack</ul>
 <ul>Database Interaction -> SQL Injection, Data Leakage</ul>
 <ul>File Upload and Download -> Directory Traversal</ul>
 <ul>Display of User-Supplied Data -> Cross-Site Scripting</ul>
 <ul>Dynamic Redirects -> Redirection, Header Injection</ul>
 <ul>Login -> Username enumeration, Password brute-force</ul>
 <ul>Session State -> Session Hijacking, Session Fixation</ul>
 <ul>Injection Attack -> Privilege Escalation, Access Controls</ul>
 <ul>Cleartext Communication -> Data Theft, Session Hijacking</ul>
 <ul>Error Message -> Information Leakage</ul>
 <ul>Email Interaction -> Email Injection</ul>
 <ul>Application Code -> Buffer Overflows</ul>
 <ul>Third-Party Application -> Known Vulnerabilities Exploitation</ul>
 <ul>Web Server Software -> Known Vulnerabilities Exploitation</ul>
</ol></p>
<h2>Bypass Client-Side Controls</h2>
<p>A web application requires client-side controls to restrict user inputs when transmitting data via client components and implementing measures to control the user's interaction with his or her own client.
A developer uses techniques such as hidden HTML form fields, and browser extensions to allow the transmission of data to the server via the client. Often, web developers assume that that data transmitted 
from the client to the server is within the user's control, and this assumption can make the application vulnerable to various attacks.</p>
<p><ol>
 <ul>Attack Hidden Form Fields -> identify hidden form fields, manipulate tags and fields before transmitting the data to the server</ul>
 <ul>Attack Browser Extensions -> attempt to intercept the traffic from the browser extensions or decompile the browser extensions to capture user data</ul>
 <ul>Perform Source Code Review -> identify vulnerabilities that cannot be identified by traditional vulnerability scanning tools</ul>
 <ul>Evade XSS Filters -> inject unusual characters into the HTML code</ul>
</ol></p>
<p>Inserting -script- tags into the code is not allowed in a general context. However, some other HTML tags can permit these unusual injections. Event handlers are employed to run specific scripts
corresponding to the authorized user actions. In general, event handlers such as <onfocus>, <onerror> and <onclick> can be exploited to evade XSS filters.</p>
 <p><ol>
  <ul>Encoding Characters -> a few or all of the characters of HTML elements can be written using ASCII codes to evade filters that search for strings such as <javascript>, 
  <a href="&#106;avascript:alert()">Click here!</a>; Hexadecimal encoding; Base64 encoding etc.</ul>
  <ul>Embedding Whitespaces -> attackers can easily evade filters by inserting non-printable characters</ul>
  <ul>Manipulating Tags -> <scr<script>ipt></ul>
 </ol></p>

 <h2>Attack Authentication Mechanism</h2>
 <p>In general, web applications authenticate users through authentication mechanisms such as login functionality. Attackers try to find vulnerabilities such as weak passwords and exploit these 
 to gain access by network eavesdropping, brute-force attacks, dictionary attacks, cookie replay attacks, credential theft etc. Most authentication mechanisms used by web applications have 
 design flaws, such as failure to check password strength, insecure transmission of credentials over the internet etc. </p>
 <p><ol>
  <ul>Username Enumeration -> using verbose failure messages and predicatable usernames</ul>
  <ul>Password Attacks </ul>
  <ul>Session Attacks</ul>
  <ul>Cookie Exploitation</ul>
  <ul>Bypass Authentication</ul>
 </ol></p>
 <h2>Design Flaws in Authentication Mechanism</h2>
 <p><ol>
  <ul>Bad Passwords</ul>
  <ul>Brute-Forcible Login</ul>
  <ul>Verbose Failure Messages</ul>
  <ul>Insecure Transmission of Credentials</ul>
  <ul>Password Reset Mechanism</ul>
  <ul>Forgotten Password Mechanism</ul>
  <ul>Remember Me Functionality</ul>
  <ul>User Impersonation</ul>
  <ul>Improper Validation of Credentials</ul>
  <ul>Predictable Usernames and Passwords</ul>
  <ul>Insecure Distribution of Credentials</ul>
  <h2>Implementation Flaws in Authentication Mechanism</h2>
  <p><ol>
   <ul>Fail-Open Login Mechanism</ul>
   <ul>Flaws in Multistage Login Functionality -> three stages: username and password - challenge for certain input digits or memorable characters and value submissions</ul>
   <ul>Insecure Storage of Credentials</ul>
  </ol>
 </ol></p>
 <h2>Username Enumeration</h2>
 <p>An attacker tries to login as rini.matthews, which results in the login failure message invalid email or username; in the second attempt the attacker tries to login as rinimatthews which results in a message 
 stating that the password is incorrect, thus confirming that the username rinimatthews exists. Username enumeration from verbose error messages will fail if the application has an account lockout policy, where 
 the account is locked after a certain number of failed login attempts. Attackers can use tools such as <a target=_blank href=https://github.com/trimstray/massh-enum>massh-enum</a></p>

 <h2>Password Attacks: Password Functionality Exploits</h2>
 <p><ol>
  <ul>Password Changing</ul>
  <ul>Password Recovery</ul>
  <ul>Remember Me Exploit</ul>
 </ol></p>
 <h2>Password Attacks: Password Guessing</h2>
 <p><ol>
  <ul>Password List -> create a list of possible passwords</ul>
  <ul>Password Dictionary -> compilation of word and number combinations that could be passwords, <a target=_blank href=https://dictionarymaker.sourceforge.net/>DictionaryMaker</a></ul>
  <ul>Tools -> THC Hydra, Burp Suite, L0phtCrack, ophcrack, RainbowCrack</ul>
 </ol></p>
 <h2>Password Attacks: Attack Password Reset Mechanism</h2>
 <p>Resetting the password is a common function used by the user when he forgets his password and needs to reset it. The user receives a forgot password link via email containing a one time 
 token and when the link is clicked, the server responds with a password reset page. The attack:</p>
 <p><ol>
  <ul>the attacker obtains the target's email address used on the website through techniques such as social engineering and OSINT</ul>
  <ul>The attacker sends a password reset request link to the victim using the altered Host header</ul>
  <ul>The attacker waits for the victim to receive the modified email</ul>
  <ul>Once the victim clicks on the malicious link, the attacker extracts the password reset token; using this token the attacker performs various malicious activities such as cloning web applications to 
  steal the user's credentials or acting as a proxy</ul>
 </ol></p>
 <h2>Session Attacks: Session ID Prediction / Brute-forcing</h2>
 <p>Every time a user logs in to a particular website, the server assigns a session ID to the user to keep track of all activities. This session ID is valid until the user logs out; the server 
 provides a new session ID when the user logs in again. Attackers try to exploit this session ID mechanism by guessing the next session ID after collecting some valid ones. </p>
 <h2>Cookie Exploitation: Cookie Poisoning</h2>
 <p>Client browsers use cookies to maintain a session state when they employ stateless HTTP protocol IDs for communication. Cookies can contain session-specific data such as user IDS, passwords etc. 
 They exist as files stored in the client computer's memory or on it's hard disk. </p>
 <p><ol>
  <ul>If the cookie contains passwords or session identifiers, steal the cookie using techniques such as script injection and eavesdropping</ul>
  <ul>Then, replay the cookie with the same or altered passwords or session identifiers to bypass web application authentication</ul>
  <ul>Trap cookies using tools such as OWASP ZAP and Burp Suite</ul>
 </ol></p>
 <h2>Bypass Authentication: Bypass SAML-based SSO</h2>
 <p>The single sign-on (SSO) authentication process permits a user to sign in to an application using a single set of credentials, and the same login session can be used to access multiple applications 
 irrespective of the domain or platform. For instance, loggin in to a Google account give authentication for Google Drive, Youtube, Gmail etc. This authentication mechanism is performed using the SAML protocol.</p>
 <p>Security Assertion Markup Language (SAML) is an XML - based infrastructure that serves as an authorization and authentication medium between two peers, such as identity provider (IdP) and service provider 
 (SP). The service provider entrusts the identity provider with validating users. Then, the identity provider responds with an SAML assertion (confirmation message) after validating any user.</p>
 <p>With the evolution of the SSO infrastructure, the authentication process has been handed over to third-party identity provider applications to access functions from the service provider application. SAML messages 
 are encrypted using Base64 encoding. Attacker can easily decrypt these messages and read the content of the messages. Two major fields in SAML messages, signature and assertion, are susceptible to midway 
 tampering. Signature is used to build a trust relationship between SP and IdP and assertion is used to direct the SP on providing application services to valid users. <a target=_blank href=https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e>SAML Raider</a> 
  is a Burp Suite extension used for SAML infrastructure testing.</p>

 <h1>Attack Authorization Schemes</h1>
 <p>A web application contains an authorization mechanism that restricts access to a specific resource or functionality (for example: Admin page) by authenticated users. The web application always performs user 
 authorization following authentication. An attacker implements the flawed authorization mechanism in the web application and takes advantage of it to access restricted pages by escalating privileges. The attacker 
 tries to gain access to information without proper credentials. Thus, the attacker uses various techniques to attack the authorization schemes of the web application.</p>
 <h2>Authorization Attack</h2>
 <p>In an authorization attack, the attacker first finds a legitimate account with limited provileges, then logs in as that user, and gradually escalates privileges to access protected resources. 
 He then manipulates the HTTP request to subvert the application authorization schemes by modifying input fields related to the user ID, username, access group, cost, file names, file identifiers etc. 
 Attackers use sources such as uniform resource indentifiers, parameter tampering, POST data, HTTP headers, query strings, cookies and hidden tags to perform authorization attacks.</p>

 <h2>Uniform Resource Identifier</h2>
 <p>A uniform resource identifier (URI) provides a means to identify a source. It is a global identifier for internet resources accessed remotely or locally. An attacker may use 
 URIs to access documents / directories that are protected from publishing, inject SQL queries or other unused commands into an application, and/or make a user view a certain site that is connected to another server.</p>
 <h2>Parameter Tampering</h2>
 <p>Manipulation of parameters exchanged between server and client to modify the application data, such as price and quantity of products, permissions and user credentials. This information is usually stored in 
 cookies, URL query strings or hidden form fields, and attackers can use them to increase control and application functionality.</p>
 <h2>POST data</h2>
 <p>Often comprises authorization and session information, as the information provided by the client must be associated with the session that provided it. The attacker can exploit vulnerabilities in the post data and 
 easily manipulate it.</p>
 <h2>HTTP headers</h2>
 <p>Web browsers do not allow header modification. Therefore, to modify the header the attacker has to write his own program and perform the HTTP request. He may also use available tools to modify any data sent 
 from the browser. In general, an authorization HTTP header contains a username and password encoded in Base-64. The attacker can compromise the header by submitting two HTTP requests bound in the same header. 
 The proxy system executes the first HTTP header and the target system executes the other HTTP header, allowing the attacker to bypass the proxy's access control.</p>
 <h2>Query String and Cookies</h2>
 <p>Browsers use cookies to maintain their state in the stateless HTTP protocol as well as to store user preferences, session tokens and other data. Clients can modify the cookies and send them to the 
 server with URL requests, thereby allowing the attacker to modify the cookie content. Cookie modification depends on the cookie usage, which ranges from session tokens to authorized decision-making arrays.</p>
 <h2>Hidden Tags</h2>
 <p>When a user selects anything on an HTML page, the selection is stored as a form field value and sent to the application as an HTTP request (GET or POST). HTML can store field values as hidden fields, which 
 the browser does not extract to the screen; instead it collects and submits these fields as parameters during form submissions, which the user can manipulate. However, he has to make a choice. Code sent to 
 browsers does not have any security value; therefore by manipulating the hidden values, the attacker can easily access the page and run it in the browser.</p>

 <h2>Authorization Attack: HTTP request tampering</h2>
 <p>HTTP headers control information passed from web clients to web servers on HTTP requests and from web servers to web clients on HTTP responses. Each header consists of a single text line with a name and 
 a value. There are two main ways to send data with HTTP: via the URL or the form. Tampering with HTTP data refers to modifying data of the HTTP request (or response) before the recipient reads it. The 
 attacker changes the HTTP request without using another user's ID.</p>
 <p><ol>
  <ul><b>Query String Tampering</b> -> if the query string is visible in the address bar in the browser, then try to change the string parameter to bypass authorization mechanisms; you can use web spidering 
  tools such as Burp Suite to scan the web application for POST parameters</ul>
  <ul><b>HTTP headers</b> -> if the application uses the Referer header for making access control decisions, then try to modify it to access protected application functionalities. In the example ItemID=201 
  is not accessible as the Admin parameter is set to false, you can change it to true and access protected items</ul>
 </ol></p>

   <h2>Authorization Attack: Cookie Parameter Tampering</h2>
  <p>When the user logs into the site, the web application sets the session cookie and stores it in the browser.</p>
 <p><ol>
  <ul>Collect some sessions cookies set by the web application and analyze them to determine the cookie generation mechanism</ul>
  <ul>Trap the session cookie set by the web application, tamper it's parameters using tools such as Burp Suite and replay it to the application to gain unauthorized access to others' profiles</ul>
  <ul>The tool intercepts every request sent from the browser and allows you to edit the cookie to replace it with the tampered cookie parameters; if the cookie is not secure, you may be able to guess 
  the parameters</ul>
 </ol></p>

 <h2>Burp Suite</h2>
 <p><a target=_blank href=https://portswigger.net>Burp Suite</a> is an integrated platform for performing security testing of web applications. It has various tools that work together to support the 
 entire testing process, from initial mapping and analysis of an application's attack surface to finding and exploiting security vulnerabilities. </p>

 <h1>Attack Access Controls</h1>
 <p>Access controls are part of the application's security mechanisms that are logically based on authentication and session management. An attacker walks through a website to identify the following 
 access controls details of the application:</p>
 <p><ol>
  <ul>Individual access to a particular subset of data</ul>
  <ul>Levels of grant access (employees, managers, supervisors, CEOs etc.)</ul>
  <ul>Administrator functionality to configure and monitor</ul>
  <ul>Functionalities that allow escalating privileges</ul>
 </ol></p>
 <h2>Exploiting Insecure Access Controls</h2>
 <p><ol>
  <ul>Parameter-Based Access Control</ul>
  <ul>Referer-Based Access Control</ul>
  <ul>Location-Based Access Control</ul>
 </ol></p>

 <h2>Access Controls Attack Methods</h2>
 <p><ol>
  <ul>Attack with different user accounts</ul>
  <ul>Attack Multistage Processes</ul>
  <ul>Attack Static Resources</ul>
  <ul>Attack Direct Access to Methods</ul>
  <ul>Attack Restrictions on HTTP Methods</ul>
 </ol></p>

 <h1>Attack Session Management Mechanism</h1>
 <p>Web application session management involves exchanging sensitive information between the server and its clients wherever required. If such session management is insecure, the attacker can take advantage 
 of it to attack the web application through the session management mechanism, which is the key security component in most web applications.</p>
 <h2>Session Management Attack</h2>
 <p>Two stages: session token generation and exploitation of session token handling</p>
 <p><ol>
  <ul>Session Token Prediction -> when the server uses a deterministic pattern between session IDs</ul>
  <ul>Session Token Tampering -> once the attacker gain the previous and next session ID, he can tamper with the session data and engage in further malicious activities</ul>
 </ol></p>
 <p>Once attackers generate a valid session token, he tries to exploit session token handling as follows:</p>
 <p><ol>
  <ul>MITM</ul>
  <ul>Session Hijacking</ul>
  <ul>Session Replay</ul>
 </ol></p>
 <h2>Attacking Session Token Generation Mechanism</h2>
 <p>Through session prediction, attackers identify a pattern in the session token exchanged between client and server. This can happen when the web application has weak, predictable session identifiers.</p>
 <p><ol>
  <ul>Weak Encoding</ul>
  <ul>Session Token Prediction</ul>
 </ol></p>
 <h2>Attacking Session Tokens Handling Mechanism: Session Token Sniffing</h2>
 <p><ol>
  <ul>Sniff the application traffic using a sniffing tool such as Wireshark or an intercepting proxy such as Burp Suite</ul>
  <ul>If HTTP cookies are being used as the transmission mechanism for session tokens and the secure flag is not set, then try to replay the cookie to gain unauthorized access to the application</ul>
  <ul>Use session cookies to perform session hijacking, session replay and MITM attacks</ul>
 </ol></p>
 <p>Sniffing the valid session token is important in session management attacks.</p>

 <h1>Perform Injection / Input Validation Attacks</h1>
 <p>Injection attacks are very common in web applications. They exploit the vulnerable input validation mechanism implemented by the web application. There are many types of injection attacks, such as web 
 script injection, OS command injection, SMTP injection, LDAP injection and XPath injection. Another frequently occurring attack is an SQL injection attack.</p>
 <p>Injection frequently takes place when a browser sends user-provided data to the interpreter as part of a command or query. For launching an injection attack, attackers supply crafted data that tricks 
 the interpreter into executing unintended commands or queries. Because of these injection flaws, attackers can easily read, create, update and remove any arbitrary data available to the application. 
 In some cases, attackers can even bypass a deeply nested firewall environment and take complete control of the application and its underlying system.</p>
 <h2>Injection Attacks / Input Validation Attacks</h2>
 <p>To perform injection attacks, supply crafted malicious input that is syntactically correct according to the interpreted language being used to break the application's normal intended operation.</p>
 <p><ol>
  <ul>Web Scripts Injection</ul>
  <ul>OS Commands Injection</ul>
  <ul>SMTP Injection</ul>
  <ul>SQL Injection</ul>
  <ul>LDAP Injection</ul>
  <ul>XPath Injection</ul>
  <ul>Buffer Overflow</ul>
  <ul>File Injection</ul>
  <ul>Canonicalization</ul>
 </ol></p>

 <h2>Perform Local File Inclusion (LFI)</h2>
 <p>LFI enables attackers to add their own files on a server via a web browser. It is often triggered in PHP based websites. Attackers can fetch the /etc/passwd file using:</p>
 <p>http://xyz.com/page=../../../../../../etc/passwd</p>

 <h2>Attack Application Logic Flaws</h2>
 <p>In all web applications, a vast amount of logic is applied at every level. Most attackers focus on high-level attacks such as SQL Injection and XSS scripting. Most application flaws arise from the 
 negligence and false assumptions of developers. </p>

 <h2>Attack Shared Environments</h2>
 <p>Organizations leverage third-party service providers for hosting and maintaining their web applications and relevant web infrastructure. This leads to many threats and attacks against web 
 applications. </p>
 <p><ol>
  <ul>Attacks on the access mechanism -> The application service provider provides an administrative web interface to the organizations for configuring and managing the web application and its database from 
  a remote location. This remote access mechanism is vulnerable to various attacks. Check whether the remote access mechanism has any unpatched vulnerabilities or configuration errors that can be exploited; 
  check whether the access privileges are properly separated between clients</ul>
  <ul>Attacks between applications -> vulnerabilities existing in one web application may allow attackers to execute malicious scripts and compromise the security of other hosted web applications</ul>
 </ol></p>

 <h2>Attack Database Connectivity</h2>
 <p>Database connection strings are used to connect applications to database engines. In these attacks, attackers target a database connection that forms a link between a database server and its client 
 software. A web application establishes a connection with the database by providing a driver with a connection string that holds the address of a specific database or server and offers instance and user 
 authentication credentials:</p>
 <p>Server=sql_box; Database=Common; User ID=uid; Pwd=password</p>
 <p>Attacking data connectivity cna results in unauthorized control over the database. Database connectivity attacks exploit the way in which applications connect to the database instead of abusing 
 database queries. For this purpose, use methods such as connection string injection attack, hash stealing, port scanning and hijacking web credentials. Data connectivity attacks are of the following types:</p>
 <p><ol>
  <ul>Connection String Injection -> attackers inject parameters in a connection string by appending them with a semicolon</ul>
  <ul>Connection String Parameter Pollution (CSPP) Attacks -> overwrite parameter values in the connection string</ul>
  <ul>Connection Pool DoS -> examine connection pooling settings of the target application, construct a large malicious SQL query and run multiple queries simultaneously to consume all the connections in the 
  connection pool, causing database queries to fail for legitimate users</ul>
 </ol></p>

 <h2>Connection String Injection</h2>
 <p>A connection string injection attack occurs when te server uses dynamic string concatenation to build connection strings based on the user input. If the server does not validate the string and does not 
 allow the malicious text or characters to escape, an attacker can potentially access sensitive data or other resources on the server. For example, an attacker could mount an attack by supplying a semicolon 
 and appending an additional value. The attacker parses the connection string using the <b>last one wins</b> algorithm and substitutes a legitimate value with a hostile input. Attackers can easily inject 
 parameters by simply adding a <b>semicolon ;</b> using connection string injection techniques in a delegated authentication environment.</p>
 <p>In the following example, the system asks the user to give a username and a password for creating a connection string. Here, the attacker enters the <b>password</b> as <b>pwd; Encryption=off</b>. 
 This means that the attacker has voided the encryption system. When the connection string is populated, the encryption value will be added to the previously configured set of parameters:</p>
 <p>Before Injection:</p>
 <p><ol>
  <ul>Data Source=Server, Port;Network Library=DBMSSCON; Initial Catalog=DataBase; User ID=Username; Password=pwd;</ul>
 </ol></p>
 <p>After Injection:</p>
 <p><ol>
  <ul>Data Source=Server, Port;Network Library=DBMSSCON; Initial Catalog=DataBase; User ID=Username; Password=pwd; Encryption=off</ul>
 </ol></p>

 <h2>Connection String Parameter Pollution (CSPP) Attacks</h2>
 <p>The server uses connection strings to connect applications to database engines. Connection string parameter pollution (CSPP) techniques allow an attacker to specifically exploit the semicolon-delimited
 database connection strings that are constructed dynamically based on the user inputs from web applications. In CSPP attacks, attackers overwrite parameter values in the connection string to steal 
 user IDs and hijack web credentials.</p>
 <p><ol>
  <ul>Hash Stealing -> replaces the value of the Data Source parameter with that of a <b>Rogue Microsoft SQL Server</b> and sets the values of username, data source and integrated security as follows:<br/>
  User_Value: ; Data Source = Rogue_Server Password_Value: ; Integrated Security = true<br/>
  The parameters DataSource and IntegratedSecurity are overwritten and the built-in drivers will use the last set of values instead of the previous one. When the Microsoft SQL Server tries to connect to the 
  rogue server, the <b>sniffer</b> running in the rogue server sniffs the window's credentials</ul>
  <ul>Port Scanning</ul>
  <ul>Hijacking Web Credentials</ul>
 </ol></p>

 <h2>Connection Pool DoS</h2>
 <p>Examine the connection pooling settings of the application, construct a large malicious SQL query and run multiple queries simultaneously to consume all the connections in the connection pool, causing
 database queries to fail for legitimate users. For example, by default in ASP.NET the maximum number of allowed connections in the pool is 100 and the timeout is 30 seconds. Run 100 queries with an 
 execution time of 30+ seconds withing 30 seconds to cause a connection pool DoS such that no one else would be able to use the database-related parts of the application.</p>

 <h1>Attack Web Application Client</h1>
 <p>Attacks on the client side occur when the client establishes a connection with the server:</p>
 <p><ol>
  <ul>Cross Site Scripting</ul>
  <ul>HTTP Header Injection</ul>
  <ul>Request Forgery Attack -> exploit the trust of a website or web application on a user's browser by including a link on a page which takes the user to an authenticated website</ul>
  <ul>Privacy Attacks -> employing a leaked persistent browser state</ul>
  <ul>Redirection Attacks -> code and links that resemble a legitimate site that a user wants to visit; however the url redirects to a malicious website</ul>
  <ul>Frame Injection -> when scripts do not validate their input, attackers inject code through frames; occur in HTML pages with frames</ul>
  <ul>Session Fixation -> attackers authenticate using a known session ID and use the session ID to hijack a user-validated session</ul>
  <ul>ActiveX Attacks -> via email or via a link constructed such that the loopholes or remote execution code becomes accessible, allowing the attackers to obtain access privileges equal to those of 
  authorized users</ul>
 </ol></p>

<h1>Attack Web Services</h1>
<p>Web applications often use web services to implement a particular functionality. If web services integrated within the web applications are vulnerable, the applications themselves become 
vulnerable. Web services work on top of legacy web applications, and any attack on web service will immediately expose an underlying application's business and logic vulnerabilities for various attacks.</p>

 <h1>Web Services Probing Attacks</h1>
 <p>WSDL files are automated documents consisting of sensitive information about service ports, connections formed between two electronic machines etc. Attackers can use WSDL probing attacks to 
 obtain information about the vulnerabilities in public and private web services, as well as to perform an SQL attack.</p>
 <p><ol>
  <ul>Trap the WSDL document from web service traffic and analyze it to determine the purpose of the application, functional breakdown, entry points and message types</ul>
  <ul>Create a set of valid requests by selecting a set of operations and formulating the request messages according to the rules of the XML schema that can be submitted to the web service</ul>
  <ul>Use these requests to include malicious contents in SOAP requests and analyze errors to gain a deeper understanding of potential security weaknesses</ul>
 </ol></p>

 <h2>Web Service Attacks: SOAP Injection</h2>
 <p>SOAP is a lightweight and simple XML based protocol designed to exchange structured and type information on the web. The XML envelope element is always the root element of a SOAP message in the 
 XML schema. SOAP injection includes special characters such as single quotes, double quotes, semicolons etc. The attacker injects malicious query strings in the user input field to bypass web service 
 authentication mechanisms and access backend databased, works similar to SQL injection attacks.</p>
 <h2>Web Service Attacks: SOAPAction Spoofing</h2>
 <p>Every SOAP request message contains an operation that is executed by the application and is included as the first child element in the SOAP body. When SOAP messages are transmitted using HTTP, 
 an additional HTTP header known as SOAPAction is used. The operation to be executed is included in the SOAPAction header. The header element informs the receiving web service about the operation 
  present in the SOAP body without the need to perform XML parsing. The attacker can exploit this optimization to manipulate the operations included in the SOAPAction headers. Attackers use tools 
 such as <a target=_blank href=https://github.com/RUB-NDS/WS-Attacker>WS-Attacker</a> to perform SOAPAction spoofing.</p>

 <h2>Web Service Attacks: WS-Address Spoofing</h2>
 <p>WS-Address provides additional routing information in the SOAP header to support asynchronous communication. This technique allows the transmission of web service requests and response messages 
 using different TCP connections. It is essential for long-running service requests where the calculation time of the server-side application exceeds the lifetime of a single TCP connection. WS-Address 
 includes an optional FaultTo address element for stating an alternative endpoint that is to be used in case of any complications. As the requester selects the endpoint address using in the ReplyTo and 
 FaultTo headers, it is not secured properly against tampering by intermediaries. Although the specification asks to perform digital signatures on these header fields, the values mostly depend on the 
 default setting without any proper security. This causes a vulnerability that can be exploited by the attacker to perform the WS-Address spoofing attack.</p>
 <p>In the WS-Address spoofing attack, an attacker sends a SOAP message containing fake WS-Address information to the server. The ReplyTo header consists of the address of the endpoint selected by the 
 attacker instead of the web service client. The endpoint selected by the attacker receives unnecessary traffic via SOAP messages. Furthermore, the attacker may generate a massive amount of traffic, 
 thus resulting in a DoS attack. Attackers use tools 
 such as <a target=_blank href=https://github.com/RUB-NDS/WS-Attacker>WS-Attacker</a> to perform WS-Addressing spoofing attacks.</p>

 <h2>Web Service Attacks: XML Injection</h2>
 <p>Web applications sometimes use XML to store data such as user credentials in XML documents; attackers can parse and view such data using XPath. Attackers identify the XPath and insert an XML 
 injection or XML schema to bypass the authentication process and gain unrestricted access to the data stored in XML. Attackers inject XML data and tags into user input fields to manipulate XML 
 schema or populate XML databases with bogus entries. XML injection can be used to bypass authorization, escalate privileges and generate web services DoS attacks.</p>

 <h2>Web Services Parsing Attacks</h2>
 <p>Parsing attacks exploit vulnerabilities and weaknesses in the processing capabilities of the XML parser to create a DoS attack or generate logical errors in web service request processing.
 A parsing attack is performed when an attacker succeeds in modifying a file request or string. The attacker changes the values by superimposing one or more operating system commands via the request. 
 Parsing is possible when the attacker executes .bat or .cmd files.</p>
 <p><ol>
  <ul>Recursive Payloads -> the attacker queries for web services with a grammatically correct SOAP document that contains infinite processing loops, resulting in exhaustion of XML parser and CPU resources</ul>
  <ul>Oversize Payloads -> excessively large payloads to consume all the resources, rendering web services inaccessible to other legitimate users</ul>
 </ol></p>

 <h1>Web Service Attack Tools</h1>
 <p><ol>
  <ul><a target=_blank href=https://www.soapui.org>SoapUI</a> -> probing, SOAP injection, XML injection, web service parsing</ul>
  <ul><a target=_blank href=https://www.altova.com>XMLSpy</a> -> XML editor en development environment</ul>
  <ul><a target=_blank href=https://www.metasploit.com>Metasploit</a></ul>
  <ul>w3af</ul>
  <ul>Nikto</ul>
  <ul>Sn1per</ul>
  <ul>WSSiP</ul>
  <ul>X Attacker</ul>
  <ul>timing_attack</ul>
  <ul>HTTrack</ul>
  <ul>SQL Injection Scanner</ul>
  <ul>XSS Scanner</ul>
  <ul>SQLi Explorer</ul>
  <ul>HTTP Request Logger</ul>
  <ul>WebCopier</ul>
  <ul>WPScan</ul>
  <ul>TIDoS-Framework</ul>
 </ol></p>
