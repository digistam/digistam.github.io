 <meta name=”robots” content=”noindex,nofollow”/>
  <a href=index.html>Back to home</a>
<hr/>
<h1>Web Application Hacking Methodology</h1>
<p>Attackers use the web application hacking methodology to gain knowledge of a particular web application to compromise it succesfully. This methodology allows them to plan each step in detail 
to increase their chances of successfully hacking the application. Under this methodology, they do the following to collect detailed information about various resources  needed to run or access the 
web application:</p>
<p><ol>
 <ul>Footprint web infrastructure</ul>
 <ul>Analyze web applications</ul>
 <ul>Bypass client-side controls</ul>
 <ul>Attack authentication mechanisms</ul>
 <ul>Attack authorization schemes</ul>
 <ul>Attack access controls</ul>
 <ul>Attack session management mechanisms</ul>
 <ul>Perform injection attacks</ul>
 <ul>Attack application logic flaws</ul>
 <ul>Attack shared environments</ul>
 <ul>Attack database connectivity</ul>
 <ul>Attack web application clients</ul>
 <ul>Attack web services</ul>
</ol></p>
<p>If hackers do not use this process and try to exploit the web application directly, their chances of failure increases. </p>
<h2>Footprint Web Infrastructure</h2>
<p>Footprinting is the process of gathering complete information about a system and all its related components, as well as how they work. Finding vulnerabilities can help attackers exploit and gain 
unauthorized access to the web application.</p>
<p><ol>
 <ul>Server Discovery -> physical servers using Whois lookup, DNS interrogation, port scanning etc.</ul>
 <ul>Service Discovery -> nmap, netscantools pro etc.</ul>
 <ul>Server Identification -> banner grabbing; local identity (location, origin-host); local addresses; self-names</ul>
 <ul>Hidden Content Discovery -> extract content and functionality that is not directly linked or reachable from main visible content</ul>
 <ul>Load Balancers Detection -> detecting load balancers with real IP addresses</ul>
</ol></p>
<h2>Server Discovery</h2>
<p><ol>
 <ul>Whois Lookup -> whois.domaintools.com, netcraft, smartwhois (tamos.com) etc.</ul>
 <ul>DNS Interrogation -> organizations use DNS interrogation, a distributed database to connect their IP addresses with their respective hostnames and vice versa; find DNS records (network-tools.com), 
 DNSRecon, Domain Dossier (centralops.net), DNSdumpster.com</ul>
 <ul>Port scanning -> nmap, netscantools pro, advanced port scanner, hping3</ul>
</ol></p>
<h2>Service Discovery</h2>
<p><ol>
 <ul>80: World Wide Web standard port</ul>
 <ul>81: Alternate WWW</ul>
 <ul>88: Kerberos</ul>
 <ul>384: Remote Network Server System</ul>
 <ul>443: SSL (HTTPS)</ul>
 <ul>514: Remote Shell</ul>
 <ul>etc.</ul>
</ol></p>

<h2>Server Identification / Banner Grabbing</h2>
<p>Banner grabbing is a footprinting technique used by a hacker to obtain sensitive information about a target; telnet moviescope.com 80</p>
<p>Tools such as Telnet and Netcat are capable of grabbing banners of web servers over only an HTTP connection. Attackers perform the following steps to grab banners over an SSL connection:</p>
<p><ol>
 <ul>Install OpenSSL</ul>
 <ul>Start OpenSSL in terminal</ul>
 <ul>s_client -host <target website> -port 443</ul>
 <ul>GET / HTTP/1.0</ul>
</ol></p>

<h2>Detect Web App Firewalls and Proxies on Target Site</h2>
<p>The <b>trace</b> command sends a request to the web server, asking it to send back the request. If the web server is behind a proxy the proxy modifies this request by adding extra headers. </p>

<h2>Detect Web Application Firewalls</h2>
<p>WAFs can be detected by analyzing the HTTP header request. Most firewalls edit HTTP header requests and responses vary. Tools:</p>
<p><ol>
 <ul>WAFWOOF (github.com) -> identify and fingerprint WAFs protecting a website by looking at cookies, server cloaking, reponse code, drop action, pre-built-in rules</ul>
 <ul>SHIELDFY (shieldfy.io)</ul>
 <ul>nmap</ul>
</ol></p>

<h2>Hidden Content Discovery</h2>
<p>Hidden content and functionality not reachable from the main visible content can be discovered to exploit user privileges within the application:</p>
<p><ol>
 <ul>Web Spidering / Crawling -> OWASP ZAP, Burp suite etc. </ul>
 <ul>Attacker-Directed Spidering -> OWASP ZAP</ul>
</ol></p>

<h2>Detect Load Balancers</h2>
<p>There are two types of load balancers: DNS load balancers (Layer 4 load balancers) and HTTP load balancers (Layer 7 load balancers). Attackers use various tools such as dig, lbd load balancing detector and 
Halberd to detect load balancers. For example, if a single host resolves to multiple IP addresses.</p>
<p><ol>
 <ul>Using host command -> host <target domain></ul>
 <ul>Using dig command -> dig <target domain></ul>
 <ul>Using load balancing detector (lbd) -> lbd <target domain></ul>
</ol></p>
<p>After identifying the real IP addresses behind the load balancers, attackers perform further attacks on the target organization.</p>

<h2>Analyzing Web Applications</h2>
<p>Once attackers have attempted various possible attacks on a vulnerable web server, they may turn their attention to the web application itself. To hack the web application, first they may need to analyze it 
to determine its vulnerable areas. Even if it has only a single vulnerability, attackers try to compromise its security by launching an appropriate attack. Attackers define an <b>attack surface</b>:</p>
<p><ol>
 <ul>Identify Entry Points for User Input -> gateways for attacks; attackers review generated HTTP requests to identify the user input entry points</ul>
 <ul>Identify Server-Side Technologies -> ASP, ASP.NET, ColdFusion, JSP JavaServer Pages, PHP, Python, Ruby etc.</ul>
 <ul>Identify Server-Side Functionality -> referring to ability of executing programs on output web pages</ul>
 <ul>Identify Files and Directories -> web servers host web applications, misconfigurations may lead to exposure of critical files and directories over the internet</ul>
 <ul>Identify Web Application Vulnerabilities -> web applications are developed using various technologies and platforms, not following secure coding practices in the development may leave flaws</ul>
 <ul>Map the Attack Surface</ul>
</ol></p>
<p><a target=_blank href=https://www.net-square.com>httprint</a> is a web server fingerprinting tool that relies on web server characteristics to accurately identify web servers; <a target=_blank href=https://github.com/urbanadventurer/WhatWeb>WhatWeb</a>
scans and identifies web technologies, including CMS, blogging platforms, JavaScript libraries etc.</p>
<p>After determining the server-side technologies, attackers try to identify the server-side functionality to find potential vulnerabilities. <a target=_blank href=https://www.gnu.org>GNU Wget</a> is employed for 
retrieving files using HTTP, HTTPS and FTP which are the most widely used internet protocols; <a target=_blank href=https://curl.se>curl</a></p>
<p>Examine URL: an SSL certified page URL starts with https; if a page contains a .aspx extension, the application is likely written using ASP.NET; if the query string has a parameter named showBy you can assume 
that the application is using a database and will display the data by that value.</p>
<p>Attackers use various techniques and tools to enumerate applications, hidden directories and files of the web application hosted on web servers; they use tools like <a target=_blank href=https://github.com/OJ/gobuster>GoBuster</a>, 
URL Fuzzer and nmap NSE script http-enum to identify files and directories of the target web application:</p>
<p><ol>
 <ul>gobuster -u <target URL> -w common.txt</ul>
 <ul>gobuster -u <target UTL> -w common.txt -s 200 (files and directories with specific status codes)</ul>
 <ul>nmap -sV --script=http-enum <target domain or IP address></ul>
</ol></p>
<p>Attackers use various techniques to gain administrator-level access etc. Attackers use tools like <a target=_blank href=https://www.subgraph.com>Vega</a>, <a target=_blank href=https://wpscan.com>WPScan Vulnerability Database</a>, 
 <a target=_blank href=https://www.arachni-scanner.com>Arachni</a> and <a target=_blank href=https://sourceforge.net/projects/uniscan/>Uniscan</a> to identify vulnerabilities.</p>
<p>Vega is a free and open source web security scanner and web security testing platform for testing the security of web applications. Vega helps to find and validate SQL injection, XSS, inadvertently disclosed 
sensitive information etc.</p>
<p>Once attackers detect the entry points, server-side technologies and functionalities, they map the attack surface area:</p>
<p><ol>
 <ul>Client-Side Validation -> Injection Attack, Authentication Attack</ul>
 <ul>Database Interaction -> SQL Injection, Data Leakage</ul>
 <ul>File Upload and Download -> Directory Traversal</ul>
 <ul>Display of User-Supplied Data -> Cross-Site Scripting</ul>
 <ul>Dynamic Redirects -> Redirection, Header Injection</ul>
 <ul>Login -> Username enumeration, Password brute-force</ul>
 <ul>Session State -> Session Hijacking, Session Fixation</ul>
 <ul>Injection Attack -> Privilege Escalation, Access Controls</ul>
 <ul>Cleartext Communication -> Data Theft, Session Hijacking</ul>
 <ul>Error Message -> Information Leakage</ul>
 <ul>Email Interaction -> Email Injection</ul>
 <ul>Application Code -> Buffer Overflows</ul>
 <ul>Third-Party Application -> Known Vulnerabilities Exploitation</ul>
 <ul>Web Server Software -> Known Vulnerabilities Exploitation</ul>
</ol></p>
<h2>Bypass Client-Side Controls</h2>
<p>A web application requires client-side controls to restrict user inputs when transmitting data via client components and implementing measures to control the user's interaction with his or her own client.
A developer uses techniques such as hidden HTML form fields, and browser extensions to allow the transmission of data to the server via the client. Often, web developers assume that that data transmitted 
from the client to the server is within the user's control, and this assumption can make the application vulnerable to various attacks.</p>
<p><ol>
 <ul>Attack Hidden Form Fields -> identify hidden form fields, manipulate tags and fields before transmitting the data to the server</ul>
 <ul>Attack Browser Extensions -> attempt to intercept the traffic from the browser extensions or decompile the browser extensions to capture user data</ul>
 <ul>Perform Source Code Review -> identify vulnerabilities that cannot be identified by traditional vulnerability scanning tools</ul>
 <ul>Evade XSS Filters -> inject unusual characters into the HTML code</ul>
</ol></p>
<p>Inserting -script- tags into the code is not allowed in a general context. However, some other HTML tags can permit these unusual injections. Event handlers are employed to run specific scripts
corresponding to the authorized user actions. In general, event handlers such as <onfocus>, <onerror> and <onclick> can be exploited to evade XSS filters.</p>
 <p><ol>
  <ul>Encoding Characters -> a few or all of the characters of HTML elements can be written using ASCII codes to evade filters that search for strings such as <javascript>, 
  <a href="&#106;avascript:alert()">Click here!</a>; Hexadecimal encoding; Base64 encoding etc.</ul>
  <ul>Embedding Whitespaces -> attackers can easily evade filters by inserting non-printable characters</ul>
  <ul>Manipulating Tags -> <scr<script>ipt></ul>
 </ol></p>

 <h2>Attack Authentication Mechanism</h2>
 <p>In general, web applications authenticate users through authentication mechanisms such as login functionality. Attackers try to find vulnerabilities such as weak passwords and exploit these 
 to gain access by network eavesdropping, brute-force attacks, dictionary attacks, cookie replay attacks, credential theft etc. Most authentication mechanisms used by web applications have 
 design flaws, such as failure to check password strength, insecure transmission of credentials over the internet etc. </p>
 <p><ol>
  <ul>Username Enumeration -> using verbose failure messages and predicatable usernames</ul>
  <ul>Password Attacks </ul>
  <ul>Session Attacks</ul>
  <ul>Cookie Exploitation</ul>
  <ul>Bypass Authentication</ul>
 </ol></p>
 <h2>Design Flaws in Authentication Mechanism</h2>
 <p><ol>
  <ul>Bad Passwords</ul>
  <ul>Brute-Forcible Login</ul>
  <ul>Verbose Failure Messages</ul>
  <ul>Insecure Transmission of Credentials</ul>
  <ul>Password Reset Mechanism</ul>
  <ul>Forgotten Password Mechanism</ul>
  <ul>Remember Me Functionality</ul>
  <ul>User Impersonation</ul>
  <ul>Improper Validation of Credentials</ul>
  <ul>Predictable Usernames and Passwords</ul>
  <ul>Insecure Distribution of Credentials</ul>
  <h2>Implementation Flaws in Authentication Mechanism</h2>
  <p><ol>
   <ul>Fail-Open Login Mechanism</ul>
   <ul>Flaws in Multistage Login Functionality -> three stages: username and password - challenge for certain input digits or memorable characters and value submissions</ul>
   <ul>Insecure Storage of Credentials</ul>
  </ol>
 </ol></p>
 <h2>Username Enumeration</h2>
 <p>An attacker tries to login as rini.matthews, which results in the login failure message invalid email or username; in the second attempt the attacker tries to login as rinimatthews which results in a message 
 stating that the password is incorrect, thus confirming that the username rinimatthews exists. Username enumeration from verbose error messages will fail if the application has an account lockout policy, where 
 the account is locked after a certain number of failed login attempts. Attackers can use tools such as <a target=_blank href=https://github.com/trimstray/massh-enum>massh-enum</a></p>

 <h2>Password Attacks: Password Functionality Exploits</h2>
 <p><ol>
  <ul>Password Changing</ul>
  <ul>Password Recovery</ul>
  <ul>Remember Me Exploit</ul>
 </ol></p>
 <h2>Password Attacks: Password Guessing</h2>
 <p><ol>
  <ul>Password List -> create a list of possible passwords</ul>
  <ul>Password Dictionary -> compilation of word and number combinations that could be passwords, <a target=_blank href=https://dictionarymaker.sourceforge.net/>DictionaryMaker</a></ul>
  <ul>Tools -> THC Hydra, Burp Suite, L0phtCrack, ophcrack, RainbowCrack</ul>
 </ol></p>
 <h2>Password Attacks: Attack Password Reset Mechanism</h2>
 <p>Resetting the password is a common function used by the user when he forgets his password and needs to reset it. The user receives a forgot password link via email containing a one time 
 token and when the link is clicked, the server responds with a password reset page. The attack:</p>
 <p><ol>
  <ul>the attacker obtains the target's email address used on the website through techniques such as social engineering and OSINT</ul>
  <ul>The attacker sends a password reset request link to the victim using the altered Host header</ul>
  <ul>The attacker waits for the victim to receive the modified email</ul>
  <ul>Once the victim clicks on the malicious link, the attacker extracts the password reset token; using this token the attacker performs various malicious activities such as cloning web applications to 
  steal the user's credentials or acting as a proxy</ul>
 </ol></p>
 <h2>Session Attacks: Session ID Prediction / Brute-forcing</h2>
 <p>Every time a user logs in to a particular website, the server assigns a session ID to the user to keep track of all activities. This session ID is valid until the user logs out; the server 
 provides a new session ID when the user logs in again. Attackers try to exploit this session ID mechanism by guessing the next session ID after collecting some valid ones. </p>
 <h2>Cookie Exploitation: Cookie Poisoning</h2>
 <p>Client browsers use cookies to maintain a session state when they employ stateless HTTP protocol IDs for communication. Cookies can contain session-specific data such as user IDS, passwords etc. 
 They exist as files stored in the client computer's memory or on it's hard disk. </p>
 <p><ol>
  <ul>If the cookie contains passwords or session identifiers, steal the cookie using techniques such as script injection and eavesdropping</ul>
  <ul>Then, replay the cookie with the same or altered passwords or session identifiers to bypass web application authentication</ul>
  <ul>Trap cookies using tools such as OWASP ZAP and Burp Suite</ul>
 </ol></p>
