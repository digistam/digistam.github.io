<html>
    <meta name=”robots” content=”noindex,nofollow”/>
  <a href=../index.html>Back to home</a>
<hr/>
<h1>Wi-Fi Encryption Cracking</h1>
<p>Wi-Fi networks use WEP or WPA/WPA2 encryption, which the attacker must crack.</p>
<h1>WEP Encryption Cracking</h1>
<p>Gathering a large number of IVs is necessary to break the WEP encryption key. An attacker can gather sufficient IVs by simply listening to the network traffic. WEP packet injection expedites the IV - gathering 
process and allows capturing a large number of IVs in a short period. An attacker can break WEP encryption through the following steps:</p>
<p><ol>
  <ul>Start the interface in monitoring mode on the specific AP channel</ul>
  <ul>Test the capability of injection from the wireless device to the AP</ul>
  <ul>Use a tool such as aireplay-ng for fake authentication with the AP</ul>
  <ul>Start the Wi-Fi sniffing tool -> for example airodump-ng with a BSSID filter to collect unique IVs</ul>
  <ul>Start a Wi-Fi packet encryption tool such as aireplay-ng in the ARP request replay mode to inject packets</ul>
</ol></p>
  <p>Using tools such as aircrack-ng, the attacker can extract WEP encryption keys from the captures IVs.</p>
  <h2>Cracking WEP using aircrack-ng</h2>
  <p><ol>
    <ul>Run airmon-ng in monitoring mode</ul>
    <ul>Start airodump-ng to discover SSIDs on the interface and keep it running -> collect more than 50.000 IVs !</ul>
    <ul>Associate the Wi-Fi interface with the target AP</ul>
    <ul>Inject packets using aireplay-ng to generate traffic on the target AP</ul>
    <ul>Wait for airodump-ng to capture more than 50.000 IVs</ul>
    <ul>Crack the WEP key using aircrack-ng</ul>
  </ol></p>
<h1>WPA/WPA2 Encryption Cracking</h1>
<p>WPA Encryption is less exploitable than WEP encryption. However, an attacker can still crack WPA/WPA2 encryption by capturing the necessary type of packets. The attacker can perform this offline but needs to 
be near the AP for a few moments.</p>
<p><ol>
    <ul>WPA PSK -> WPA PSK uses a user-defined password to initialize the four-way handshake. An attacker can not crack this password because it is a per-packet key, but the keys can be brute-forced using 
    dictionary attacks; a dictionary attack can compromise most consumer passwords</ul>
    <ul>Offline attack -> to perform an offline attack, the attacker needs to be near the AP for a few seconds to capture the WPA/WPA2 handshake. By capturing the necessary type of packets, WPA encryption keys can be 
    cracked offline. In WPA handshakes, the protocol does not send the password across the network, because the WPA handshake typically occurs over insecure channels and in plaintext. Capturing a full authentication 
    handshake from a client and the AP helps in breaking the WPA/WPA2 encryption without packet injection</ul>
    <ul>De-authentication attack -> an attacker needs to find an actively connected client; The attacker forces the client to disconnect from the AP, following which they use tools such as aireplay-ng to capture the 
    authentication packet when the client attempts to reconnect. The client should be able to re-authenticate itself with the AP in a few seconds. The authentication packet includes the pairwise master key (PMK) which the 
    attacker can crack by dictionary or brute-force attacks to recover the WPA key</ul>
    <ul>Brute forcing of WPA keys -> an attacker can perform a brute-force attack on WPA encryption keys using a dictionary or using tools such as aircrack, aireplay or KisMAC; Breaking WPA keys through brute-force 
    may take hours, days, weeks or longer</ul>
</ol></p>
<h1>WPA3 Encryption Cracking</h1>
<p>The WPA3 Wi-Fi security standard replaces WPA2's four-way (PSK) handshake method with the Dragonfly (also known as SAE) handshake function to supply the strongest password-based authentication to date. 
It is still vulnerable to password-cracking attacks. <b>Dragonblood</b> is a set of vulnerabilities in the WPA3 security standard that allows attackers to recover keys, downgrade security mechanisms and launch 
various information-theft attacks. Attackers can use various tools such as Dragonslayer, Dragonforce, Dragondrain and Dragontime to exploit these vulnerabilities and launch attacks on WPA3-enabled networks.</p>
<p><ol>
    <ul>Downgrade Security Attacks -> the client and AP should support both WPA3 and WPA2 encryption mechanisms; the attacker forces the user to follow the older encryption method, WPA2</ul>
    <ul>Side-Channel Attacks (Information-Leaking Attack) -> attackers target protocols or encryption mechanisms used by devices that attempt to connect to a network; during the key-exchange process, the 
    attacker launches this attack to capture leaked information. This information is further used by the attcker to launch brute-force or dictionary attacks to obtain all the data of the target user</ul>
</ol></p>
