<html>
    <meta name=”robots” content=”noindex,nofollow”/>
  <a href=../index.html>Back to home</a>
<hr/>
<h1>Malware Analysis</h1>
<h2>Sheep Dip Computer</h2>
<p>Sheep dipping is a process used in sheep farming, whereby sheep are dipped in chemical solutions to make them parasite-free. Sheep dipping refers to the analysis of suspicious files, 
incoming messages etc. for malware. The sheep dipped computer is isolated from the other computers on the network. Before performing this, it is important to save all downloaded programs on external media 
such as DVDs or CD-ROMs.</p>
<p>Malware analysis is a process of reverse engineering a specific piece of malware to determine its origin, functionality and potential impact. By performing malware analysis, one can extract detailed information
about the malware. Malware analysis is an integral part of any penetration testing process.</p>
<h2>Why Malware Analysis</h2>
<p><ol>
    <ul>Determine what exactly happened</ul>
    <ul>Determine the malicious intent of the malware</ul>
    <ul>Identify indicators of compromise</ul>
    <ul>Determine the complexity level of an intruder</ul>
    <ul>Identify the exploited vulnerability</ul>
    <ul>Identify the extent of damage caused by the intrusion</ul>
    <ul>Catch the perpetrator responsible for installing the malware</ul>
    <ul>Find signatures for host and network-based intrusion detection systems</ul>
    <ul>Evaluate the harm from an intrusion</ul>
    <ul>List the indicators of compromise for different machines and different malware programs</ul>
    <ul>Find the system vulnerability that the malware has exploited</ul>
    <ul>Distinguish the gatecrasher or insider responsible for the malware entry</ul>
    <ul>What is the intention of the malware</ul>
    <ul>How did it get through </ul>
    <ul>What is the impact on the business</ul>
    <ul>Who are the perpetrators and how good are they</ul>
    <ul>How to abolish the malware</ul>
    <ul>What are the losses</ul>
    <ul>How long has the system been infected</ul>
    <ul>What is the medium of the malware</ul>
    <ul>What are the preventive measures</ul>
</ol></p>
    <h2>Guidelines for malware analysis</h2>
    <p><ol>
        <ul>During malware analysis, pay attention to the essential features instead of understanding every detail</ul>
        <ul>Try different tools and approaches to analyze the malware, as a single approach may not be useful</ul>
        <ul>Identify, understand and defeat new malware analysis prevention techniques</ul>
    </ol></p>

    <h1>Type of malware analysis</h1>
    <h2>Static Malware Analysis</h2>
    <p>also known as code analysis, involves going through the executable binary code without executing it to gain a better understanding of the malware and its purpose. Pointers include filename, MD5 checksums / hash, file type and file size.</p>
    <h2>Dynamic Malware Analysis</h2>
    <p>also known as behavioral analyses, involving executing the malware code to known how it interacts with the host system. It reveals information such as domain names, file path locations, created registry keys, 
    IP addresses, additional files, installation files, DLL and linked files located on the system or network.</p>

    <h1>Malware Analysis Procedure</h1>
    <p>It is extremely dangerous to analyze malware on production devices connected to production networks. Analysis of malware must be done in a testing environment on an isolated network.</p>
    <p><ol>
        <ul>Preparing Testbed</ul>
        <ul>Static Analysis</ul>
        <ul>Dynamic Analysis</ul>
    </ol></p>

    <h2>Preparing Testbed</h2>
    <p><ol>
        <ul>An isolated test network to host the testbed and isolated network services such as DNS</ul>
        <ul>Target machines installed with a variety of OS and configuration states (non-patched, patched etc.)</ul>
        <ul>Virtualization snapshots and re-imaging tools to wipe and rebuild the target machine quickly</ul>
        <ul>Some tools are required for testing:</ul>
        <li>Imaging tool</li>
        <li>File / data analysis</li>
        <li>Registry / configuration tools</li>
        <li>Sandbox</li>
        <li>Log analyzers</li>
        <li>Network capture</li>
    </ol></p>
