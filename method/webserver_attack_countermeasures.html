    <meta name=”robots” content=”noindex,nofollow”/>
  <a href=../index.html>Back to home</a>
<hr/>
<h1>Web Server Attack Countermeasures</h1>
<h2>Place Web Servers in separate secure server security segment on network</h2>
<p>An ideal web hosting network should be designed with three segments:</p>
<p><ol>
  <ul>Internet segment</ul>
  <ul>Secure server security segment (<b>DMZ</b>b)</ul>
  <ul>Internal network</ul>
</ol></p>
<p>The first step in securing web servers is to place them separately in the DMZ, which is isolated from the public network and from the internal webhosting network.
Placing web servers in a separate segment adds security barriers between the web servers and the internal network as well as between the web servers and the outside public network. This separation allows the 
administrator to place firewalls and apply access control based on security rules for the internal network as well as for internet traffic toward the DMZ. Such a webhosting network can prevent attacks 
on the web server by outside attackers or malicious insiders.</p>
<p>Network segmentation divides a network into different segments, each having its own hub or switch. It allows protection by enforcing firewalls and security rules depending on the level of security desired.
An attacker who compromises one segment of the network will not be able to compromise the security of other segments of the network.</p>

<h2>Protocols and accounts</h2>
<p><ol>
  <ul>Block all unnecessary ports, ICMP traffic and unnecessary protocols such as NetBIOS and SMB</ul>
  <ul>Harden the TCP/IP stack and consistently apply the latest software patches and updates to system software</ul>
    <ul>If insecure protocols such as Telnet, POP3, SMTP and FTP are used, then take appropriate measures to provide secure authentication and communication, for example, by using IPsec policies</ul>
    <ul>If remote access is needed, ensure that remote connections are secured properly by using tunneling and encryption protocols</ul>
    <ul>Disable Web Distributed Authoring and Versioning (WebDAV) if it is not used by the application, or keep it secure if it is required</ul>
    <ul>Use secure protocols such as Transport Layer Security (TLS)/SSL for communicating with the web server</ul>
    <ul>Ensure that unidentified FTP servers operate in an innocuous part of the directory tree that is different from the web server's tree</ul>
    <ul>Ensure that the HTTP service banner is properly configured to cover the details of the host device like OS version and type</ul>
    <ul>Isolate the supporting servers such as LDAP servers from the local subnet to filter out the traffic through a firewall before entering the local network</ul>
    <ul>Ensure that all the file transfer applications through the web server are done through FTPS for better data encryption and protection</ul>
</ol></p>
<p><ol>
    <ul>Remove all unused modules and application extensions</ul>
    <ul>Disable unused default user accounts created during the installation of an OS</ul>
    <ul>When creating a new web root directory, grant the appropriate (least possible) NTFS permissions to anonymous users of the IIS web server to access the web content</ul>
    <ul>Eliminate unnecessary database users and stored procedures and follow the principle of least privilege for the database application to defend against SQL query poisoning</ul>
    <ul>Use secure web permissions, NTFS permissions and .NET Framework access control mechanisms, including URL authorization</ul>
    <ul>Slow down brute-force and dictionary attacks with strong password policies and implement audits and alerts for login failures</ul>
    <ul>Run processes using least privileged accounts as well as least privileged services and user accounts</ul>
    <ul>Limit the administrator or root-level access to the minimum number of users and maintain a record of the same</ul>
    <ul>Maintain logs of all user activity in an encrypted form on the web server or in a separate machine on the intranet</ul>
    <ul>Disable all noninteractive accounts that should exist but do not require an interactive login</ul>
    <ul>Use secure VPN networks such as OpenVPN while accessing multi-server platforms or accessing data from cross-server network models, which helps use one account for multiple server access</ul>
    <ul>Enable the Separation of Duties (SoD) feature on the server config settings</ul>
    <ul>Force users to periodically change passwords for their accounts by creating a password expiry policy</ul>
    <ul>Enable the user account locking feature by setting a limit on the number of failed login attempts</ul>
    <ul>Implement 2FA or MFA as an additional layer of security for user accounts</ul>
</ol></p>
<h2>Files and Directories</h2>
<p><ol>
    <ul>Eliminate unnecessary files within .jar files</ul>
    <ul>Eliminate sensitive configuration information within the byte code</ul>
    <ul>Avoid mapping virtual directories between two different servers or over a network</ul>
    <ul>Monitor and check all network services logs, website access logs, database server logs (e.g., Microsoft SQL Server, MySQL, and Oracle), and OS logs frequently</ul>
    <ul>Disable the serving of directory listings</ul>
    <ul>Eliminate non-web files such as archive files, backup files, text files, and header/include files</ul>
    <ul>Disable the serving of certain file types by creating a resource map</ul>
    <ul>Ensure that web applications or website files and scripts are stored in a partition or drive separate from that of the OS, logs, and any other system files</ul>
    <ul>Run the web server within a sandbox directory for preventing access to system files</ul>
    <ul>Avoid all non-web file types from being referenced in a URL</ul>
    <ul>Run the web server processes with the least required privileges and give access only to the necessary directories</ul>
    <ul>Exclude meta characters while processing user inputs to ensure proper filtering of inputs</ul>
    <ul>Employ file integrity checkers to verify web content and intrusion detection</ul>
</ol></p>

<h1>Detecting Web Server Hacking Attempts</h1>

<p>An attacker who gains access to a web server by compromising security through known vulnerabilities present in the web server may attempt to plant backdoors (scripts). These backdoors allow the 
attacker to gain access, launch phishing attacks or send spam emails. The victim remains unaware of the web server attack until the server is blacklisted on spam mails or until the attacker 
redirects the visitor of a target site hosted on the web server to some other site. Thus, a web server attack is difficult to detect unless such malicious events occur. By the time these events occur, 
it may be too late to react because the attacker would have already succeeded. A mechanism to detect a web server hacking attempt in its early stages is required to prevent harm to the web server.</p>
