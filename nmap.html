<html>
    <meta name=”robots” content=”noindex,nofollow”/>
  <a href=index.html>Back to home</a>
<hr/>
<h1><b>NMap commands</b></h1>
    <h2>Least intrusive: List Scan</h2>
    <p>The list scan -sL is a degenerate form of host discovery that simply lists each host of the network(s) specified, without sending any packets to the 
        target hosts. All it does is running through all the IP addresses in the block (/24). It doesn't do a lot but by default, 
        Nmap still does reverse-<b>DNS resolution</b> on the hosts to learn their names. It is often surprising how much useful information 
        simple hostnames give out. The list scan is a good sanity check to ensure that you have proper IP addresses for your targets. 
        If the hosts sport domain names you do not 
        recognize, it is worth investigating further to prevent scanning the wrong company's network. Since the idea is to simply <b>print a list of target hosts</b>, 
        options for higher level functionality such as port scanning, OS detection, or host discovery cannot be combined with this. 
        If you wish to disable host discovery while still performing such higher level functionality, read up on the -Pn (skip host discovery) option.</p>
    <p><b>sudo nmap -sL 192.168.2.243/24</b></p>
    <h2>No Port Scan [Ping Sweep]</h2>
<p>This option tells Nmap not to do a port scan after host discovery, and only print out the available hosts that responded to the host discovery probes. 
    This is often known as a <b>ping scan</b>, but you can also request that traceroute and NSE host scripts be run. This is by default one step more 
    intrusive than the list scan, and can often be used for the same purposes. It allows light reconnaissance of a target network without attracting much 
    attention. Knowing how many hosts are up is more valuable to attackers than the list provided by list scan of every single IP and host name.
    This is often called a <b>ping sweep</b>, and is more reliable than pinging the broadcast address because many hosts do not reply to broadcast queries.
    The default host discovery done with -sn consists of an ICMP echo request, TCP SYN to port 443, TCP ACK to port 80, and an ICMP timestamp request by default. 
    When executed by an unprivileged user, only SYN packets are sent (using a connect call) to ports 80 and 443 on the target. In previous releases of Nmap, 
    -sn was known as -sP</p>
    <p>The difference between de List scan (-sL) and the Ping sweep (-sn) is that with the Ping sweep nmap shows which hosts are UP!</p>
    <p><b>sudo nmap -sn 192.168.2.254/24</b></p>
    <p>ZenMap will create a nice list of detected IP addresses with their MAC addresses</p>
    <h2>TCP scans (Port scans)</h2>
    <p>We can do TCP scans as well as UDP scans with nmap</p>
<h2>[TCP] SYN scan (half-open scan)</h2>
<p>This is called the half-open scan because connections are left half open (handshake will not be completed). Nmap will send a SYN message to the target. If the port is open, it will respond with SYN/ACK messagen. 
Nmap will respond to that with a RST message, indicating it doesn't want to continue with the connection. If the port is closed, the target will respond with RST. A SYN scan has the parameter -sS.</p>
<p><b>sudo nmap -sS 192.168.86.32</b></p>
<h2>Full connect scan</h2>
<p>In a full connect scan, nmap completes the 3-way handshake. It can be used to demonstrate the use of a network block as a target. 
    A full connect scan has the parameter -sT. Scanning with this parameter can take a while. It's best to limit scanning to some interesting ports.</p>
<p><b>sudo nmap -sT -p 80, 443 192.168.86.0/24</b></p>
    <h2>[TCP] Other scans</h2>
    <p>There are additional TCP scans that nmap run. The other scans make use of <b>unexpected</b> input as a way of potentially getting different responses. </p>
<p>The NULL, FIN and Xmas scan types (even more are possible with the --scanflags option described in the next section) exploit a 
    subtle loophole in the TCP RFC to differentiate between open and closed ports. Page 65 of RFC 793 says that 
    <i>“if the [destination] port state is CLOSED .... an incoming segment not containing a RST causes a RST to be sent in response.”</i> 
    Then the next page discusses packets sent to open ports without the SYN, RST, or ACK bits set, stating that: 
    <i>“you are unlikely to get here, but if you do, drop the segment, and return.”</i>
When scanning systems compliant with this RFC text, any packet not containing SYN, RST, or ACK bits will result in a <b>returned RST</b> if the port is 
    closed and <b>no response</b> at all if the port is open. As long as none of those three bits are included, any combination of the other three 
    (FIN, PSH, and URG) are OK.</p>

  
    
    <h2>[TCP] Xmas scan</h2>
<p>It is named Xmas scan because the packages being sent have the FIN, PSH and URG flags set, which makes the packet look lit up like a Christmas tree. What we will see is that we don't get an indication 
about open ports here. Instead, nmap is telling us that the port is either <b>open</b> or <b>filtered</b>. The reason for this is that with ports that are closed, the system responds with a RST. Ports that are open 
don't respond at all because it is not a legal packet from the perspective of the protocol. If nmap doesn't get any response, it's not clear whether it's because a network device dropped the message or if they 
system just didn't respond to an illegal message.</p>
<p><b>sudo nmap -sX 192.168.86.32</b></p>
    <h2>[TCP] Null scan</h2>
<p>Does not set any bits (TCP flag header is 0)</p>
<h2>[TCP] FIN scan</h2>
    <p>Sets just the TCP FIN bit</p>
    <p>These three scan types are exactly the same in behavior except for the TCP flags set in probe packets</p>

    <h2>Sneak through Firewalls and IDSs</h2>
    <p>The key advantage to the FIN, NULL and Xmas scan types is that they can sneak through certain non-stateful firewalls and packet filtering routers. 
        Such firewalls try to prevent incoming TCP connections (while allowing outbound ones) by blocking any TCP packets with the SYN bit set and ACK cleared. 
        The NULL, FIN, and Xmas scans <b>clear the SYN bit</b> and thus fly right through those rules.</p>
<p>Another advantage is that these scan types are a <b>little more stealthy</b> than even a SYN scan. 
    Don't count on this though—most modern IDS products can be configured to detect them. </p>

<h2>UDP scans</h2>
<p>UDP scanning is much more straigthforward than TCP scanning. There are NO options for UDP scanning. Nmap sends out UDP messages and then watches whatever responses may come back. The expectation is that if a 
port is closed, the system will respond with an ICMP portunreachable message. If the port is open, the service may respond with something or <b>it may not respond at all</b>.</p>
<p><b>sudo nmap -sU 192.168.86.32</b></p>
<p>Notice that UDP scans may take much longer time than TCP scans. It's possible to use the -T parameter, which sets the throttle rate. By default, the throttle rate is set at 3, which is a common rate of 
message transmission. If you want it faster, you can go up to 5.</p>
