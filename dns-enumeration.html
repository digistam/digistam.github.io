<a href=index.html>Back to home</a>
<hr/>
<h1><b>DNS enumeration</b></h1>
<p>The amount of tools do perform DNS enumeration confuses me. I created an overview with standard tools to use:</p>
<h2>DIG</h2>
<p>command: dig ns <i>tld</i></p>
<p>Output</p>
<code>
; <<>> DiG 9.19.19-1-Debian <<>> ns mydomain.nl
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 58997
;; flags: qr rd ra; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 512
;; QUESTION SECTION:
;mydomain.nl.                 IN      NS

;; ANSWER SECTION:
mydomain.nl.          86400   IN      NS      ns4.bdm.microsoftonline.com.
mydomain.nl.          86400   IN      NS      ns2.bdm.microsoftonline.com.
mydomain.nl.          86400   IN      NS      ns3.bdm.microsoftonline.com.
mydomain.nl.          86400   IN      NS      ns1.bdm.microsoftonline.com.

;; Query time: 31 msec
;; SERVER: 192.168.2.254#53(192.168.2.254) (UDP)
;; WHEN: Fri Jun 07 11:55:27 UTC 2024
;; MSG SIZE  rcvd: 137
</code>
<p>DIG can be used to check for zonewalking possibiliies:</p>
<p>command: dig ns1.bdm.microsoftonline.com mydomain.nl</p>
<p>Output:</p>
<code>
; <<>> DiG 9.19.19-1-Debian <<>> ns1.bdm.microsoftonline.com mydomain.nl axfr
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 4997
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 512
;; QUESTION SECTION:
;ns1.bdm.microsoftonline.com.   IN      A

;; ANSWER SECTION:
ns1.bdm.microsoftonline.com. 216 IN     A       13.107.236.208

;; Query time: 23 msec
;; SERVER: 192.168.2.254#53(192.168.2.254) (UDP)
;; WHEN: Fri Jun 07 11:57:06 UTC 2024
;; MSG SIZE  rcvd: 72

; Transfer failed.
</code>
<h2>DNSRecon</h2>
  <p>command: dnsrecon -d <i>tld</i> -z</p>
  <p>Output:</p>
  <code>
std: Performing General Enumeration against: mydomain.nl...<br>
DNSSEC is not configured for mydomain.nl<br>
SOA ns1.bdm.microsoftonline.com 13.107.236.208
SOA ns1.bdm.microsoftonline.com 2603:1061:0:700::d0
NS ns2.bdm.microsoftonline.com 150.171.21.208
NS ns2.bdm.microsoftonline.com 2620:1ec:8ec:700::d0
NS ns3.bdm.microsoftonline.com 204.14.183.208
NS ns3.bdm.microsoftonline.com 2a01:111:4000:700::d0
NS ns4.bdm.microsoftonline.com 208.84.5.208
NS ns4.bdm.microsoftonline.com 2620:1ec:bda:700::d0
NS ns1.bdm.microsoftonline.com 13.107.236.208
NS ns1.bdm.microsoftonline.com 2603:1061:0:700::d0
MX mydomain-nl.mail.protection.outlook.com 52.101.68.0
MX mydomain-nl.mail.protection.outlook.com 52.101.73.4
MX mydomain-nl.mail.protection.outlook.com 52.101.68.3
MX mydomain-nl.mail.protection.outlook.com 52.101.68.32
MX mydomain-nl.mail.protection.outlook.com 52.101.73.1
MX mydomain-nl.mail.protection.outlook.com 52.101.73.15
MX mydomain-nl.mail.protection.outlook.com 52.101.68.15
A mydomain.nl 141.138.169.243
AAAA mydomain.nl 2a03:3c00:a002:240::100a
TXT mydomain.nl v=spf1 include:spf.protection.outlook.com -all
TXT mydomain.nl MS=ms35460186
TXT mydomain.nl mscid=1urmnVblomZTl7cNNd2rfOWXoLjDT7ZdU5HvghSN6j4X3DR8e2bwyNB7VNG92klgIjStqLvM3M9H1kZAo7ZEYQ==
Enumerating SRV Records
No SRV Records Found for mydomain.nl
Performing NSEC Zone Walk for mydomain.nl
Getting SOA record for mydomain.nl
Name Server 13.107.236.208 will be used
A mydomain.nl 141.138.169.243
AAAA domain.nl 2a03:3c00:a002:240::100a
2 records found
</code>
