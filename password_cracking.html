
<h1>Password Attacks</h1>
<p>Classification</p>
<p>  <ol>
    <ul><b>Non-Electronic Attacks</b></ul>
  <ul><li>Shoulder surfing</li>
    <li>Social engineering</li>
    <li>Dumpster diving</li>
  </ul>
  <ul><b>Active Online Attacks</b></ul>
  <ul><li>Password guessing</li>
    <li>Dictionary and brute force attacks</li>
    <li>Password spraying</li>
    <li>Mask attack</li>
    <li>Hash injection</li>
    <li>LLMNR/NBT-NS poisoning</li>
    <li>Trojans / spyware / keyloggers</li>
    <li>Internal monologue attacks</li>
    <li>Markov-chain attacks</li>
    <li>Kerberos password cracking</li>
  </ul>
  <ul><b>Passive Online Attacks</b></ul>
  <ul><li>Wire sniffing</li>
  <li>Man-in-the-middle</li>
  <li>Replay attacks</li></ul>
  <ul><b>Offline Attacks</b></ul>
  <ul><li>Recover passwords from hash dump</li>
  <li>Using rainbow tables</li></ul>
  </ol>
</p>
<h2>Dictionary Attack</h2>
<p>A dictionary file is loaded into a cracking application that runs against user accounts. Example: <a target=_blank href=https://raw.githubusercontent.com/a3vilc0de/PentesterSpecialDict/main/password-attacks/all-pass.txt>https://raw.githubusercontent.com/a3vilc0de/PentesterSpecialDict/main/password-attacks/all-pass.txt</a>. 
  The text file contains words commonly used as passwords. The program uses every word present in the dictionary to find the password. Dictionary attacks are more useful than brute-force attacks but can't be used in systems using passphrases.</p>
  <h2>Brute-Force Attacks</h2>
  <p>Every combination of characters until the password is broken. Exhaustive key-search or brute-force search is the basic technique for trying every possible key in turn until the correct key is identified. If the user chooses keys randomly or searches randomly, the plaintext will 
  become available on average after the system has tried half of all the possible keys. It's very time consuming but all passwords will eventually be found.</p>
  <h2>Rule-based Attack</h2>
  <p>Attackers use this type of attack when they obtain some information about the password. This is more powerful than dictionary and brute-force because the attacker knows the password type. By obtaining useful information, such as the method in which numbers and/or special characters have been used, password length etc. 
  attackers can minimize the time required to crack the password and enhance the cracking tool. This technique involves brute force, dictionary and syllable attacks. A combination of both brute force and a dictionary falls into the
  categories of hybrid and syllable password-cracking attacks.</p>
  <h2>Hybrid Attack</h2>
  <p>Depends on the Dictionary attack. Often, people change their passwords merely by adding some numbers to their old passwords. In this case, the program would add some numbers and symbols to the words from the dictionary to try to crack the password. 
  For example, if the old password is "System" then there is a chance that the person will change it to "System1" or "System2".</p>
  <h2>Syllable Attack</h2>
  <p>When passwords are not known words. Attackers use dictionary and other methods to crack them. </p>
  <h2>Password Spraying Attack</h2>
  <p>Password spraying -> targetting user accounts simultaneously using one or a small set of commonly used passwords. Targetting every user in a specific workgroup. Attackers focus on the lockout policy and avoid to get the accounts of the users locked. Password spraying can be performed 
  at different stages through common ports like MSSQL, SSH, FTP, SMB, Kerberos etc.</p>
  <p>Password spraying is performed with <a target=_blank href=https://github.com/byt3bl33d3r/CrackMapExec>CrackMapExec</a>: crackmapexec smb <IP> -u users.txt -p passwords.txt</p>
<p>The following <a target=_blank href=https://github.com/Greenwolf/Spray/blob/master/spray.sh>Spray.sh</a> command is used to cross-check whether lockout occurred during the spraying process: spray.sh -smb <targetIP> <usernameList> <passwordList> <AttemptsPerLockoutPeriod> <LockoutPeriodInMinutes> <DOMAIN></p>
<h2>Mask Attack</h2>
    <p>A Mask Attack is similar to brute force attacks but recover passwords from hashes with a more specific set of characters based on information known to the attacker. The attacker uses a pattern of the password to narrow down the list of possible passwords and reduce the cracking time.</p>
    <p>Attacker use the <a target=_blank href=https://hashcat.net/hashcat/>Hashcat</a> tool to perform attacks such as brute force, dictionary and mask attacks. For a mask attack, the attacker must know the flags used for the built-in charset, custom charset and attack mode to create an appropriate pattern.</p>
<h2>Password Guessing</h2>  
<p>The attacker creates a list of all possible passwords and tries them manually on the target computer.
<ol><ul>Find a valid user</ul>
<ul>Create a list of possible passwords</ul>
<ul>Rank passwords from high to low probability</ul>
<ul>Key in each password until the correct password is discovered</ul>
</ol></p>
    <h2>Password guessing algorithm</h2>
<p>File credentials.txt</p>
    <code>
        administrator ""<br/>
        administrator password<br/>
        administrator administrator<br/>
        administrator password123<br/>
        etc.</code>
        <p>Command line example</p>
        <code>FOR /F "tokens=1,2*" %i in (credentials.txt)^<br/>
        More? do net use \\victim.com\IPC$ %j /u:victim.com\%i^<br/>
        More? 2>>nul^<br/>
        More? && echo %time% %date% >> outfile.txt^<br/>
        More? && echo \\victim.com acct: %i pass: %j >> outfile.txt<br/>
        c:\type outfile.txt</code>
        <p>The outfile.txt file contains the correct username and password, if the username and password in credentials.txt are correct. An attacker can establish an open session with the victim server using his/her system.</p>
<h2>Default passwords</h2>
<p>Default passwords are supplied by manufacturers and allow the user to access the device during initial setup. People often forget to set a new password after installation and continue using the original password. </p>
<p>Default passwords get a spot in the list of words or dictionary that the attacker uses to perform password-guessing attacks. Some on-line tools:
<ol>
<ul><a target=_blank href=https://open-sez.me>Open Sez Me!</a></ul>
    <ul><a target=_blank href=https://www.defaultpassword.us>Defaultpassword.us</a></ul>
    <ul><a target=_blank href=https://www.routerpasswords.com>Routerpasswords.com</a></ul>
    <ul><a target=_blank href=https://default-password.info>Default-password.info</ul>
</ol></p>
</p>
